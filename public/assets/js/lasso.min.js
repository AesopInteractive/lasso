function EditusFormatAJAXErrorMessage(a,b){return 0===a.status?"AJAX Error: Not connected.\nPlease verify your network connection.":404==a.status?"AJAX Error: The requested page not found. [404]":500==a.status?"AJAX Error: Internal Server Error [500].":"parsererror"===b?"AJAX Error: Requested JSON parse failed.":"timeout"===b?"AJAX Error: Time out error.":"abort"===b?"AJAX Error: Ajax request aborted.":"AJAX Error: Uncaught Error.\n"+a.responseText}(function(){function a(a,b){var c,d;for(c in b)d=b[c],void 0!==d&&(a[c]=d);return a}var b,c=function(){},d=function(b,d){var e;return e=d&&d.hasOwnProperty("constructor")?d.constructor:function(){return b.apply(this,arguments)},c.prototype=b.prototype,e.prototype=new c,d&&a(e.prototype,d),e.prototype.constructor=e,e.__super__=b.prototype,e};b="undefined"!=typeof exports?exports:this.Undo={},b.Stack=function(){this.commands=[],this.stackPosition=-1,this.savePosition=-1},a(b.Stack.prototype,{execute:function(a){this._clearRedo(),a.execute(),this.commands.push(a),this.commands.length>15?this.commands.shift():this.stackPosition++,this.changed()},undo:function(){this.commands[this.stackPosition].undo(),this.stackPosition--,this.changed()},canUndo:function(){return this.stackPosition>=0},redo:function(){this.stackPosition++,this.commands[this.stackPosition].redo(),this.changed()},canRedo:function(){return this.stackPosition<this.commands.length-1},save:function(){this.savePosition=this.stackPosition,this.changed()},dirty:function(){return this.stackPosition!=this.savePosition||lasso_editor.dirtyByComponent},_clearRedo:function(){this.commands=this.commands.slice(0,this.stackPosition+1)},changed:function(){}}),b.Command=function(a){this.name=a};var e=new Error("override me!");a(b.Command.prototype,{execute:function(){throw e},undo:function(){throw e},redo:function(){this.execute()}}),b.Command.extend=function(a){var c=d(this,a);return c.extend=b.Command.extend,c}}).call(this),function(a,b){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a():b.rangy=a()}(function(){function a(a,b){var c=typeof a[b];return c==s||!(c!=r||!a[b])||"unknown"==c}function b(a,b){return!(typeof a[b]!=r||!a[b])}function c(a,b){return typeof a[b]!=t}function d(a){return function(b,c){for(var d=c.length;d--;)if(!a(b,c[d]))return!1;return!0}}function e(a){return a&&y(a,x)&&A(a,w)}function f(a){return b(a,"body")?a.body:a.getElementsByTagName("body")[0]}function g(b){typeof console!=t&&a(console,"log")&&console.log(b)}function h(a,b){C&&b?alert(a):g(a)}function i(a){E.initialized=!0,E.supported=!1,h("Rangy is not supported in this environment. Reason: "+a,E.config.alertOnFail)}function j(a){h("Rangy warning: "+a,E.config.alertOnWarn)}function k(a){return a.message||a.description||String(a)}function l(){if(C&&!E.initialized){var b,c=!1,d=!1;a(document,"createRange")&&(b=document.createRange(),y(b,v)&&A(b,u)&&(c=!0));var h=f(document);if(!h||"body"!=h.nodeName.toLowerCase())return void i("No body element found");if(h&&a(h,"createTextRange")&&(b=h.createTextRange(),e(b)&&(d=!0)),!c&&!d)return void i("Neither Range nor TextRange are available");E.initialized=!0,E.features={implementsDomRange:c,implementsTextRange:d};var j,l;for(var m in B)(j=B[m])instanceof n&&j.init(j,E);for(var o=0,p=H.length;p>o;++o)try{H[o](E)}catch(q){l="Rangy init listener threw an exception. Continuing. Detail: "+k(q),g(l)}}}function m(a){a=a||window,l();for(var b=0,c=I.length;c>b;++b)I[b](a)}function n(a,b,c){this.name=a,this.dependencies=b,this.initialized=!1,this.supported=!1,this.initializer=c}function o(a,b,c){var d=new n(a,b,function(b){if(!b.initialized){b.initialized=!0;try{c(E,b),b.supported=!0}catch(d){var e="Module '"+a+"' failed to load: "+k(d);g(e)}}});return B[a]=d,d}function p(){}function q(){}var r="object",s="function",t="undefined",u=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],v=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],w=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],x=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],y=d(a),z=d(b),A=d(c),B={},C=typeof window!=t&&typeof document!=t,D={isHostMethod:a,isHostObject:b,isHostProperty:c,areHostMethods:y,areHostObjects:z,areHostProperties:A,isTextRange:e,getBody:f},E={version:"1.3.0-alpha.20140827",initialized:!1,isBrowser:C,supported:!0,util:D,features:{},modules:B,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==t?!0:rangyAutoInitialize}};E.fail=i,E.warn=j;var F;({}).hasOwnProperty?(D.extend=F=function(a,b,c){var d,e;for(var f in b)b.hasOwnProperty(f)&&(d=a[f],e=b[f],c&&null!==d&&"object"==typeof d&&null!==e&&"object"==typeof e&&F(d,e,!0),a[f]=e);return b.hasOwnProperty("toString")&&(a.toString=b.toString),a},D.createOptions=function(a,b){var c={};return F(c,b),a&&F(c,a,!0),c}):i("hasOwnProperty not supported"),C||i("Rangy can only run in a browser"),function(){var a;if(C){var b=document.createElement("div");b.appendChild(document.createElement("span"));var c=[].slice;try{1==c.call(b.childNodes,0)[0].nodeType&&(a=function(a){return c.call(a,0)})}catch(d){}}a||(a=function(a){for(var b=[],c=0,d=a.length;d>c;++c)b[c]=a[c];return b}),D.toArray=a}();var G;C&&(a(document,"addEventListener")?G=function(a,b,c){a.addEventListener(b,c,!1)}:a(document,"attachEvent")?G=function(a,b,c){a.attachEvent("on"+b,c)}:i("Document does not have required addEventListener or attachEvent method"),D.addListener=G);var H=[];E.init=l,E.addInitListener=function(a){E.initialized?a(E):H.push(a)};var I=[];E.addShimListener=function(a){I.push(a)},C&&(E.shim=E.createMissingNativeApi=m),n.prototype={init:function(){for(var a,b,c=this.dependencies||[],d=0,e=c.length;e>d;++d){if(b=c[d],a=B[b],!(a&&a instanceof n))throw new Error("required module '"+b+"' not found");if(a.init(),!a.supported)throw new Error("required module '"+b+"' not supported")}this.initializer(this)},fail:function(a){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+a)},warn:function(a){E.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,b){E.warn("DEPRECATED: "+a+" in module "+this.name+"is deprecated. Please use "+b+" instead")},createError:function(a){return new Error("Error in Rangy "+this.name+" module: "+a)}},E.createModule=function(a){var b,c;2==arguments.length?(b=arguments[1],c=[]):(b=arguments[2],c=arguments[1]);var d=o(a,c,b);E.initialized&&E.supported&&d.init()},E.createCoreModule=function(a,b,c){o(a,b,c)},E.RangePrototype=p,E.rangePrototype=new p,E.selectionPrototype=new q,E.createCoreModule("DomUtil",[],function(a,b){function c(a){var b;return typeof a.namespaceURI==D||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b}function d(a){var b=a.parentNode;return 1==b.nodeType?b:null}function e(a){for(var b=0;a=a.previousSibling;)++b;return b}function f(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}}function g(a,b){var c,d=[];for(c=a;c;c=c.parentNode)d.push(c);for(c=b;c;c=c.parentNode)if(H(d,c))return c;return null}function h(a,b,c){for(var d=c?b:b.parentNode;d;){if(d===a)return!0;d=d.parentNode}return!1}function i(a,b){return h(a,b,!0)}function j(a,b,c){for(var d,e=c?a:a.parentNode;e;){if(d=e.parentNode,d===b)return e;e=d}return null}function k(a){var b=a.nodeType;return 3==b||4==b||8==b}function l(a){if(!a)return!1;var b=a.nodeType;return 3==b||8==b}function m(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function n(a,b,c){var d=a.cloneNode(!1);if(d.deleteData(0,b),a.deleteData(b,a.length-b),m(d,a),c)for(var f,g=0;f=c[g++];)f.node==a&&f.offset>b?(f.node=d,f.offset-=b):f.node==a.parentNode&&f.offset>e(a)&&++f.offset;return d}function o(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=D)return a.ownerDocument;if(typeof a.document!=D)return a.document;if(a.parentNode)return o(a.parentNode);throw b.createError("getDocument: no document found for node")}function p(a){var c=o(a);if(typeof c.defaultView!=D)return c.defaultView;if(typeof c.parentWindow!=D)return c.parentWindow;throw b.createError("Cannot get a window object for node")}function q(a){if(typeof a.contentDocument!=D)return a.contentDocument;if(typeof a.contentWindow!=D)return a.contentWindow.document;throw b.createError("getIframeDocument: No Document object found for iframe element")}function r(a){if(typeof a.contentWindow!=D)return a.contentWindow;if(typeof a.contentDocument!=D)return a.contentDocument.defaultView;throw b.createError("getIframeWindow: No Window object found for iframe element")}function s(a){return a&&E.isHostMethod(a,"setTimeout")&&E.isHostObject(a,"document")}function t(a,b,c){var d;if(a?E.isHostProperty(a,"nodeType")?d=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?q(a):o(a):s(a)&&(d=a.document):d=document,!d)throw b.createError(c+"(): Parameter must be a Window object or DOM node");return d}function u(a){for(var b;b=a.parentNode;)a=b;return a}function v(a,c,d,f){var h,i,k,l,m;if(a==d)return c===f?0:f>c?-1:1;if(h=j(d,a,!0))return c<=e(h)?-1:1;if(h=j(a,d,!0))return e(h)<f?-1:1;if(i=g(a,d),!i)throw new Error("comparePoints error: nodes have no common ancestor");if(k=a===i?i:j(a,i,!0),l=d===i?i:j(d,i,!0),k===l)throw b.createError("comparePoints got to case 4 and childA and childB are the same!");for(m=i.firstChild;m;){if(m===k)return-1;if(m===l)return 1;m=m.nextSibling}}function w(a){var b;try{return b=a.parentNode,!1}catch(c){return!0}}function x(a){if(!a)return"[No node]";if(I&&w(a))return"[Broken node]";if(k(a))return'"'+a.data+'"';if(1==a.nodeType){var b=a.id?' id="'+a.id+'"':"";return"<"+a.nodeName+b+">[index:"+e(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return a.nodeName}function y(a){for(var b,c=o(a).createDocumentFragment();b=a.firstChild;)c.appendChild(b);return c}function z(a){this.root=a,this._next=a}function A(a){return new z(a)}function B(a,b){this.node=a,this.offset=b}function C(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var D="undefined",E=a.util;E.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),E.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var F=document.createElement("div");E.areHostMethods(F,["insertBefore","appendChild","cloneNode"]||!E.areHostObjects(F,["previousSibling","nextSibling","childNodes","parentNode"]))||b.fail("Incomplete Element implementation"),E.isHostProperty(F,"innerHTML")||b.fail("Element is missing innerHTML property");var G=document.createTextNode("test");E.areHostMethods(G,["splitText","deleteData","insertData","appendData","cloneNode"]||!E.areHostObjects(F,["previousSibling","nextSibling","childNodes","parentNode"])||!E.areHostProperties(G,["data"]))||b.fail("Incomplete Text Node implementation");var H=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},I=!1;!function(){var b=document.createElement("b");b.innerHTML="1";var c=b.firstChild;b.innerHTML="<br>",I=w(c),a.features.crashyTextNodes=I}();var J;typeof window.getComputedStyle!=D?J=function(a,b){return p(a).getComputedStyle(a,null)[b]}:typeof document.documentElement.currentStyle!=D?J=function(a,b){return a.currentStyle[b]}:b.fail("No means of obtaining computed style properties found"),z.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a,b,c=this._current=this._next;if(this._current)if(a=c.firstChild)this._next=a;else{for(b=null;c!==this.root&&!(b=c.nextSibling);)c=c.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}},B.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+x(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},C.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},C.prototype.toString=function(){return this.message},a.dom={arrayContains:H,isHtmlNamespace:c,parentElement:d,getNodeIndex:e,getNodeLength:f,getCommonAncestor:g,isAncestorOf:h,isOrIsAncestorOf:i,getClosestAncestorIn:j,isCharacterDataNode:k,isTextOrCommentNode:l,insertAfter:m,splitDataNode:n,getDocument:o,getWindow:p,getIframeWindow:r,getIframeDocument:q,getBody:E.getBody,isWindow:s,getContentDocument:t,getRootContainer:u,comparePoints:v,isBrokenNode:w,inspectNode:x,getComputedStyleProperty:J,fragmentFromNodeChildren:y,createIterator:A,DomPosition:B},a.DOMException=C}),E.createCoreModule("DomRange",["DomUtil"],function(a,b){function c(a,b){return 3!=a.nodeType&&(P(a,b.startContainer)||P(a,b.endContainer))}function d(a){return a.document||Q(a.startContainer)}function e(a){return new L(a.parentNode,O(a))}function f(a){return new L(a.parentNode,O(a)+1)}function g(a,b,c){var d=11==a.nodeType?a.firstChild:a;return N(b)?c==b.length?J.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:S(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function h(a,b,c){if(z(a),z(b),d(b)!=d(a))throw new M("WRONG_DOCUMENT_ERR");var e=R(a.startContainer,a.startOffset,b.endContainer,b.endOffset),f=R(a.endContainer,a.endOffset,b.startContainer,b.startOffset);return c?0>=e&&f>=0:0>e&&f>0}function i(a){for(var b,c,e,f=d(a.range).createDocumentFragment();c=a.next();){if(b=a.isPartiallySelectedSubtree(),c=c.cloneNode(!b),b&&(e=a.getSubtreeIterator(),c.appendChild(i(e)),e.detach()),10==c.nodeType)throw new M("HIERARCHY_REQUEST_ERR");f.appendChild(c)}return f}function j(a,b,c){var d,e;c=c||{stop:!1};for(var f,g;f=a.next();)if(a.isPartiallySelectedSubtree()){if(b(f)===!1)return void(c.stop=!0);if(g=a.getSubtreeIterator(),j(g,b,c),g.detach(),c.stop)return}else for(d=J.createIterator(f);e=d.next();)if(b(e)===!1)return void(c.stop=!0)}function k(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),k(b),b.detach()):a.remove()}function l(a){for(var b,c,e=d(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),c=a.getSubtreeIterator(),b.appendChild(l(c)),c.detach()):a.remove(),10==b.nodeType)throw new M("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function m(a,b,c){var d,e=!(!b||!b.length),f=!!c;e&&(d=new RegExp("^("+b.join("|")+")$"));var g=[];return j(new o(a,!1),function(b){if((!e||d.test(b.nodeType))&&(!f||c(b))){var h=a.startContainer;if(b!=h||!N(h)||a.startOffset!=h.length){var i=a.endContainer;b==i&&N(i)&&0==a.endOffset||g.push(b)}}}),g}function n(a){var b="undefined"==typeof a.getName?"Range":a.getName();return"["+b+"("+J.inspectNode(a.startContainer)+":"+a.startOffset+", "+J.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function o(a,b){if(this.range=a,this.clonePartiallySelectedTextNodes=b,!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&N(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||N(this.sc)?T(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||N(this.ec)?T(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function p(a){return function(b,c){for(var d,e=c?b:b.parentNode;e;){if(d=e.nodeType,V(a,d))return e;e=e.parentNode}return null}}function q(a,b){if(da(a,b))throw new M("INVALID_NODE_TYPE_ERR")}function r(a,b){if(!V(b,a.nodeType))throw new M("INVALID_NODE_TYPE_ERR")}function s(a,b){if(0>b||b>(N(a)?a.length:a.childNodes.length))throw new M("INDEX_SIZE_ERR")}function t(a,b){if(ba(a,!0)!==ba(b,!0))throw new M("WRONG_DOCUMENT_ERR")}function u(a){if(ca(a,!0))throw new M("NO_MODIFICATION_ALLOWED_ERR")}function v(a,b){if(!a)throw new M(b)}function w(a){return X&&J.isBrokenNode(a)||!V(Z,a.nodeType)&&!ba(a,!0)}function x(a,b){return b<=(N(a)?a.length:a.childNodes.length)}function y(a){return!!a.startContainer&&!!a.endContainer&&!w(a.startContainer)&&!w(a.endContainer)&&x(a.startContainer,a.startOffset)&&x(a.endContainer,a.endOffset)}function z(a){if(!y(a))throw new Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")")}function A(a,b){z(a);var c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset,g=c===e;N(e)&&f>0&&f<e.length&&S(e,f,b),N(c)&&d>0&&d<c.length&&(c=S(c,d,b),g?(f-=d,e=c):e==c.parentNode&&f>=O(c)&&f++,d=0),a.setStartAndEnd(c,d,e,f)}function B(a){z(a);var b=a.commonAncestorContainer.parentNode.cloneNode(!1);return b.appendChild(a.cloneContents()),b.innerHTML}function C(a){a.START_TO_START=ja,a.START_TO_END=ka,a.END_TO_END=la,a.END_TO_START=ma,a.NODE_BEFORE=na,a.NODE_AFTER=oa,a.NODE_BEFORE_AND_AFTER=pa,a.NODE_INSIDE=qa}function D(a){C(a),C(a.prototype)}function E(a,b){return function(){z(this);var c,d,e=this.startContainer,g=this.startOffset,h=this.commonAncestorContainer,i=new o(this,!0);e!==h&&(c=T(e,h,!0),d=f(c),e=d.node,g=d.offset),j(i,u),i.reset();var k=a(i);return i.detach(),b(this,e,g,e,g),k}}function F(b,d){function g(a,b){return function(c){r(c,Y),r(W(c),Z);var d=(a?e:f)(c);(b?h:i)(this,d.node,d.offset)}}function h(a,b,c){var e=a.endContainer,f=a.endOffset;(b!==a.startContainer||c!==a.startOffset)&&((W(b)!=W(e)||1==R(b,c,e,f))&&(e=b,f=c),d(a,b,c,e,f))}function i(a,b,c){var e=a.startContainer,f=a.startOffset;(b!==a.endContainer||c!==a.endOffset)&&((W(b)!=W(e)||-1==R(b,c,e,f))&&(e=b,f=c),d(a,e,f,b,c))}var j=function(){};j.prototype=a.rangePrototype,b.prototype=new j,K.extend(b.prototype,{setStart:function(a,b){q(a,!0),s(a,b),h(this,a,b)},setEnd:function(a,b){q(a,!0),s(a,b),i(this,a,b)},setStartAndEnd:function(){var a=arguments,b=a[0],c=a[1],e=b,f=c;switch(a.length){case 3:f=a[2];break;case 4:e=a[2],f=a[3]}d(this,b,c,e,f)},setBoundary:function(a,b,c){this["set"+(c?"Start":"End")](a,b)},setStartBefore:g(!0,!0),setStartAfter:g(!1,!0),setEndBefore:g(!0,!1),setEndAfter:g(!1,!1),collapse:function(a){z(this),a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){q(a,!0),d(this,a,0,a,U(a))},selectNode:function(a){q(a,!1),r(a,Y);var b=e(a),c=f(a);d(this,b.node,b.offset,c.node,c.offset)},extractContents:E(l,d),deleteContents:E(k,d),canSurroundContents:function(){z(this),u(this.startContainer),u(this.endContainer);var a=new o(this,!0),b=a._first&&c(a._first,this)||a._last&&c(a._last,this);return a.detach(),!b},splitBoundaries:function(){A(this)},splitBoundariesPreservingPositions:function(a){A(this,a)},normalizeBoundaries:function(){z(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(c=a,e=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},g=function(d){var f=d.previousSibling;if(f&&f.nodeType==d.nodeType){a=d;var g=d.length;if(b=f.length,d.insertData(0,f.data),f.parentNode.removeChild(f),a==c)e+=b,c=a;else if(c==d.parentNode){var h=O(d);e==h?(c=d,e=g):e>h&&e--}}},h=!0;if(N(c))c.length==e&&f(c);else{if(e>0){var i=c.childNodes[e-1];i&&N(i)&&f(i)}h=!this.collapsed}if(h){if(N(a))0==b&&g(a);else if(b<a.childNodes.length){var j=a.childNodes[b];j&&N(j)&&g(j)}}else a=c,b=e;d(this,a,b,c,e)},collapseToPoint:function(a,b){q(a,!0),s(a,b),this.setStartAndEnd(a,b)}}),D(b)}function G(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:J.getCommonAncestor(a.startContainer,a.endContainer)}function H(a,b,c,d,e){a.startContainer=b,a.startOffset=c,a.endContainer=d,a.endOffset=e,a.document=J.getDocument(b),G(a)}function I(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this.document=a,G(this)}var J=a.dom,K=a.util,L=J.DomPosition,M=a.DOMException,N=J.isCharacterDataNode,O=J.getNodeIndex,P=J.isOrIsAncestorOf,Q=J.getDocument,R=J.comparePoints,S=J.splitDataNode,T=J.getClosestAncestorIn,U=J.getNodeLength,V=J.arrayContains,W=J.getRootContainer,X=a.features.crashyTextNodes;o.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,N(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a,b,c=this._current;!N(c)||c!==this.sc&&c!==this.ec?c.parentNode&&c.parentNode.removeChild(c):(a=c===this.sc?this.so:0,b=c===this.ec?this.eo:c.length,a!=b&&c.deleteData(a,b-a))},isPartiallySelectedSubtree:function(){var a=this._current;return c(a,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new I(d(this.range));var b=this._current,c=b,e=0,f=b,g=U(b);P(b,this.sc)&&(c=this.sc,e=this.so),P(b,this.ec)&&(f=this.ec,g=this.eo),H(a,c,e,f,g)}return new o(a,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var Y=[1,3,4,5,7,8,10],Z=[2,9,11],$=[5,6,10,12],_=[1,3,4,5,7,8,10,11],aa=[1,3,4,5,7,8],ba=p([9,11]),ca=p($),da=p([6,10,12]),ea=document.createElement("style"),fa=!1;try{ea.innerHTML="<b>x</b>",fa=3==ea.firstChild.nodeType}catch(ga){}a.features.htmlParsingConforms=fa;var ha=fa?function(a){var b=this.startContainer,c=Q(b);if(!b)throw new M("INVALID_STATE_ERR");var d=null;return 1==b.nodeType?d=b:N(b)&&(d=J.parentElement(b)),d=null===d||"HTML"==d.nodeName&&J.isHtmlNamespace(Q(d).documentElement)&&J.isHtmlNamespace(d)?c.createElement("body"):d.cloneNode(!1),d.innerHTML=a,J.fragmentFromNodeChildren(d)}:function(a){var b=d(this),c=b.createElement("body");return c.innerHTML=a,J.fragmentFromNodeChildren(c)},ia=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ja=0,ka=1,la=2,ma=3,na=0,oa=1,pa=2,qa=3;K.extend(a.rangePrototype,{compareBoundaryPoints:function(a,b){z(this),t(this.startContainer,b.startContainer);var c,d,e,f,g=a==ma||a==ja?"start":"end",h=a==ka||a==ja?"start":"end";return c=this[g+"Container"],d=this[g+"Offset"],e=b[h+"Container"],f=b[h+"Offset"],R(c,d,e,f)},insertNode:function(a){if(z(this),r(a,_),u(this.startContainer),P(a,this.startContainer))throw new M("HIERARCHY_REQUEST_ERR");var b=g(a,this.startContainer,this.startOffset);this.setStartBefore(b)},cloneContents:function(){z(this);var a,b;if(this.collapsed)return d(this).createDocumentFragment();if(this.startContainer===this.endContainer&&N(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=d(this).createDocumentFragment(),b.appendChild(a),b;var c=new o(this,!0);return a=i(c),c.detach(),a},canSurroundContents:function(){z(this),u(this.startContainer),u(this.endContainer);var a=new o(this,!0),b=a._first&&c(a._first,this)||a._last&&c(a._last,this);return a.detach(),!b},surroundContents:function(a){if(r(a,aa),!this.canSurroundContents())throw new M("INVALID_STATE_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){z(this);for(var a,b=new I(d(this)),c=ia.length;c--;)a=ia[c],b[a]=this[a];return b},toString:function(){z(this);var a=this.startContainer;if(a===this.endContainer&&N(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],c=new o(this,!0);return j(c,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)}),c.detach(),b.join("")},compareNode:function(a){z(this);var b=a.parentNode,c=O(a);if(!b)throw new M("NOT_FOUND_ERR");var d=this.comparePoint(b,c),e=this.comparePoint(b,c+1);return 0>d?e>0?pa:na:e>0?oa:qa},comparePoint:function(a,b){return z(this),v(a,"HIERARCHY_REQUEST_ERR"),t(a,this.startContainer),R(a,b,this.startContainer,this.startOffset)<0?-1:R(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:ha,toHtml:function(){return B(this)},intersectsNode:function(a,b){if(z(this),v(a,"NOT_FOUND_ERR"),Q(a)!==d(this))return!1;var c=a.parentNode,e=O(a);v(c,"NOT_FOUND_ERR");var f=R(c,e,this.endContainer,this.endOffset),g=R(c,e+1,this.startContainer,this.startOffset);return b?0>=f&&g>=0:0>f&&g>0},isPointInRange:function(a,b){return z(this),v(a,"HIERARCHY_REQUEST_ERR"),t(a,this.startContainer),R(a,b,this.startContainer,this.startOffset)>=0&&R(a,b,this.endContainer,this.endOffset)<=0},intersectsRange:function(a){return h(this,a,!1)},intersectsOrTouchesRange:function(a){return h(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var b=R(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=R(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return-1==b&&d.setStart(a.startContainer,a.startOffset),1==c&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var b=this.cloneRange();return-1==R(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==R(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),b}throw new M("Ranges do not intersect")},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==qa},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&this.comparePoint(a,U(a))<=0},containsRange:function(a){var b=this.intersection(a);return null!==b&&a.equals(b)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);if(c.length>0){b.setStart(c[0],0);var d=c.pop();return b.setEnd(d,d.length),this.containsRange(b)}return this.containsNodeContents(a)},getNodes:function(a,b){return z(this),m(this,a,b)},getDocument:function(){return d(this)},collapseBefore:function(a){this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){this.setStartAfter(a),this.collapse(!0)},getBookmark:function(b){var c=d(this),e=a.createRange(c);b=b||J.getBody(c),e.selectNodeContents(b);var f=this.intersection(e),g=0,h=0;return f&&(e.setEnd(f.startContainer,f.startOffset),g=e.toString().length,h=g+f.toString().length),{start:g,end:h,containerNode:b}},moveToBookmark:function(a){var b=a.containerNode,c=0;this.setStart(b,0),this.collapse(!0);for(var d,e,f,g,h=[b],i=!1,j=!1;!j&&(d=h.pop());)if(3==d.nodeType)e=c+d.length,!i&&a.start>=c&&a.start<=e&&(this.setStart(d,a.start-c),i=!0),i&&a.end>=c&&a.end<=e&&(this.setEnd(d,a.end-c),j=!0),c=e;else for(g=d.childNodes,f=g.length;f--;)h.push(g[f])},getName:function(){return"DomRange"},equals:function(a){return I.rangesEqual(this,a)},isValid:function(){return y(this)},inspect:function(){return n(this)},detach:function(){}}),F(I,H),K.extend(I,{rangeProperties:ia,RangeIterator:o,copyComparisonConstants:D,createPrototypeRange:F,inspect:n,toHtml:B,getRangeDocument:d,rangesEqual:function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset}}),a.DomRange=I}),E.createCoreModule("WrappedRange",["DomRange"],function(a,b){var c,d,e=a.dom,f=a.util,g=e.DomPosition,h=a.DomRange,i=e.getBody,j=e.getContentDocument,k=e.isCharacterDataNode;if(a.features.implementsDomRange&&!function(){function d(a){for(var b,c=m.length;c--;)b=m[c],a[b]=a.nativeRange[b];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}function g(a,b,c,d,e){var f=a.startContainer!==b||a.startOffset!=c,g=a.endContainer!==d||a.endOffset!=e,h=!a.equals(a.nativeRange);(f||g||h)&&(a.setEnd(d,e),a.setStart(b,c))}var k,l,m=h.rangeProperties;c=function(a){if(!a)throw b.createError("WrappedRange: Range must be specified");this.nativeRange=a,d(this)},h.createPrototypeRange(c,g),k=c.prototype,k.selectNode=function(a){this.nativeRange.selectNode(a),d(this)},k.cloneContents=function(){return this.nativeRange.cloneContents()},k.surroundContents=function(a){this.nativeRange.surroundContents(a),d(this)},k.collapse=function(a){this.nativeRange.collapse(a),d(this)},k.cloneRange=function(){return new c(this.nativeRange.cloneRange())},k.refresh=function(){d(this)},k.toString=function(){return this.nativeRange.toString()};var n=document.createTextNode("test");i(document).appendChild(n);var o=document.createRange();o.setStart(n,0),o.setEnd(n,0);try{o.setStart(n,1),k.setStart=function(a,b){this.nativeRange.setStart(a,b),d(this)},k.setEnd=function(a,b){this.nativeRange.setEnd(a,b),d(this)},l=function(a){return function(b){this.nativeRange[a](b),d(this)}}}catch(p){k.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(c){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}d(this)},k.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(c){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,b)}d(this)},l=function(a,b){return function(c){try{this.nativeRange[a](c)}catch(e){this.nativeRange[b](c),this.nativeRange[a](c)}d(this)}}}k.setStartBefore=l("setStartBefore","setEndBefore"),k.setStartAfter=l("setStartAfter","setEndAfter"),k.setEndBefore=l("setEndBefore","setStartBefore"),k.setEndAfter=l("setEndAfter","setStartAfter"),k.selectNodeContents=function(a){this.setStartAndEnd(a,0,e.getNodeLength(a))},o.selectNodeContents(n),o.setEnd(n,3);var q=document.createRange();q.selectNodeContents(n),q.setEnd(n,4),q.setStart(n,2),-1==o.compareBoundaryPoints(o.START_TO_END,q)&&1==o.compareBoundaryPoints(o.END_TO_START,q)?k.compareBoundaryPoints=function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:k.compareBoundaryPoints=function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};var r=document.createElement("div");r.innerHTML="123";var s=r.firstChild,t=i(document);t.appendChild(r),o.setStart(s,1),o.setEnd(s,2),o.deleteContents(),"13"==s.data&&(k.deleteContents=function(){this.nativeRange.deleteContents(),d(this)},k.extractContents=function(){var a=this.nativeRange.extractContents();return d(this),a}),t.removeChild(r),t=null,f.isHostMethod(o,"createContextualFragment")&&(k.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)}),i(document).removeChild(n),k.getName=function(){return"WrappedRange"},a.WrappedRange=c,a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),a.createRange()}}(),a.features.implementsTextRange){var l=function(a){var b=a.parentElement(),c=a.duplicate();c.collapse(!0);var d=c.parentElement();c=a.duplicate(),c.collapse(!1);var f=c.parentElement(),g=d==f?d:e.getCommonAncestor(d,f);return g==b?g:e.getCommonAncestor(b,g)},m=function(a){return 0==a.compareEndPoints("StartToEnd",a)},n=function(a,b,c,d,f){var h=a.duplicate();h.collapse(c);var i=h.parentElement();if(e.isOrIsAncestorOf(b,i)||(i=b),!i.canHaveHTML){var j=new g(i.parentNode,e.getNodeIndex(i));return{boundaryPosition:j,nodeInfo:{nodeIndex:j.offset,containerElement:j.node}}}var l=e.getDocument(i).createElement("span");l.parentNode&&l.parentNode.removeChild(l);for(var m,n,o,p,q,r=c?"StartToStart":"StartToEnd",s=f&&f.containerElement==i?f.nodeIndex:0,t=i.childNodes.length,u=t,v=u;;){if(v==t?i.appendChild(l):i.insertBefore(l,i.childNodes[v]),h.moveToElementText(l),
m=h.compareEndPoints(r,a),0==m||s==u)break;if(-1==m){if(u==s+1)break;s=v}else u=u==s+1?s:v;v=Math.floor((s+u)/2),i.removeChild(l)}if(q=l.nextSibling,-1==m&&q&&k(q)){h.setEndPoint(c?"EndToStart":"EndToEnd",a);var w;if(/[\r\n]/.test(q.data)){var x=h.duplicate(),y=x.text.replace(/\r\n/g,"\r").length;for(w=x.moveStart("character",y);-1==(m=x.compareEndPoints("StartToEnd",x));)w++,x.moveStart("character",1)}else w=h.text.length;p=new g(q,w)}else n=(d||!c)&&l.previousSibling,o=(d||c)&&l.nextSibling,p=o&&k(o)?new g(o,0):n&&k(n)?new g(n,n.data.length):new g(i,e.getNodeIndex(l));return l.parentNode.removeChild(l),{boundaryPosition:p,nodeInfo:{nodeIndex:v,containerElement:i}}},o=function(a,b){var c,d,f,g,h=a.offset,j=e.getDocument(a.node),l=i(j).createTextRange(),m=k(a.node);return m?(c=a.node,d=c.parentNode):(g=a.node.childNodes,c=h<g.length?g[h]:null,d=a.node),f=j.createElement("span"),f.innerHTML="&#feff;",c?d.insertBefore(f,c):d.appendChild(f),l.moveToElementText(f),l.collapse(!b),d.removeChild(f),m&&l[b?"moveStart":"moveEnd"]("character",h),l};d=function(a){this.textRange=a,this.refresh()},d.prototype=new h(document),d.prototype.refresh=function(){var a,b,c,d=l(this.textRange);m(this.textRange)?b=a=n(this.textRange,d,!0,!0).boundaryPosition:(c=n(this.textRange,d,!0,!1),a=c.boundaryPosition,b=n(this.textRange,d,!1,!1,c.nodeInfo).boundaryPosition),this.setStart(a.node,a.offset),this.setEnd(b.node,b.offset)},d.prototype.getName=function(){return"WrappedTextRange"},h.copyComparisonConstants(d);var p=function(a){if(a.collapsed)return o(new g(a.startContainer,a.startOffset),!0);var b=o(new g(a.startContainer,a.startOffset),!0),c=o(new g(a.endContainer,a.endOffset),!1),d=i(h.getRangeDocument(a)).createTextRange();return d.setEndPoint("StartToStart",b),d.setEndPoint("EndToEnd",c),d};if(d.rangeToTextRange=p,d.prototype.toTextRange=function(){return p(this)},a.WrappedTextRange=d,!a.features.implementsDomRange||a.config.preferTextRange){var q=function(a){return a("return this;")()}(Function);"undefined"==typeof q.Range&&(q.Range=d),a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),i(a).createTextRange()},a.WrappedRange=d}}a.createRange=function(c){return c=j(c,b,"createRange"),new a.WrappedRange(a.createNativeRange(c))},a.createRangyRange=function(a){return a=j(a,b,"createRangyRange"),new h(a)},a.createIframeRange=function(c){return b.deprecationNotice("createIframeRange()","createRange(iframeEl)"),a.createRange(c)},a.createIframeRangyRange=function(c){return b.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),a.createRangyRange(c)},a.addShimListener(function(b){var c=b.document;"undefined"==typeof c.createRange&&(c.createRange=function(){return a.createRange(c)}),c=b=null})}),E.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(a,b){function c(a){return"string"==typeof a?/^backward(s)?$/i.test(a):!!a}function d(a,c){if(a){if(C.isWindow(a))return a;if(a instanceof r)return a.win;var d=C.getContentDocument(a,b,c);return C.getWindow(d)}return window}function e(a){return d(a,"getWinSelection").getSelection()}function f(a){return d(a,"getDocSelection").document.selection}function g(a){var b=!1;return a.anchorNode&&(b=1==C.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b}function h(a,b,c){var d=c?"end":"start",e=c?"start":"end";a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[e+"Container"],a.focusOffset=b[e+"Offset"]}function i(a){var b=a.nativeSelection;a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset}function j(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function k(b){var c;return b instanceof F?(c=a.createNativeRange(b.getDocument()),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset)):b instanceof G?c=b.nativeRange:J.implementsDomRange&&b instanceof C.getWindow(b.startContainer).Range&&(c=b),c}function l(a){if(!a.length||1!=a[0].nodeType)return!1;for(var b=1,c=a.length;c>b;++b)if(!C.isAncestorOf(a[0],a[b]))return!1;return!0}function m(a){var c=a.getNodes();if(!l(c))throw b.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return c[0]}function n(a){return!!a&&"undefined"!=typeof a.text}function o(a,b){var c=new G(b);a._ranges=[c],h(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function p(b){if(b._ranges.length=0,"None"==b.docSelection.type)j(b);else{var c=b.docSelection.createRange();if(n(c))o(b,c);else{b.rangeCount=c.length;for(var d,e=L(c.item(0)),f=0;f<b.rangeCount;++f)d=a.createRange(e),d.selectNode(c.item(f)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed,h(b,b._ranges[b.rangeCount-1],!1)}}}function q(a,c){for(var d=a.docSelection.createRange(),e=m(c),f=L(d.item(0)),g=M(f).createControlRange(),h=0,i=d.length;i>h;++h)g.add(d.item(h));try{g.add(e)}catch(j){throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}g.select(),p(a)}function r(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()}function s(a){a.win=a.anchorNode=a.focusNode=a._ranges=null,a.rangeCount=a.anchorOffset=a.focusOffset=0,a.detached=!0}function t(a,b){for(var c,d,e=ba.length;e--;)if(c=ba[e],d=c.selection,"deleteAll"==b)s(d);else if(c.win==a)return"delete"==b?(ba.splice(e,1),!0):d;return"deleteAll"==b&&(ba.length=0),null}function u(a,c){for(var d,e=L(c[0].startContainer),f=M(e).createControlRange(),g=0,h=c.length;h>g;++g){d=m(c[g]);try{f.add(d)}catch(i){throw b.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}f.select(),p(a)}function v(a,b){if(a.win.document!=L(b))throw new H("WRONG_DOCUMENT_ERR")}function w(b){return function(c,d){var e;this.rangeCount?(e=this.getRangeAt(0),e["set"+(b?"Start":"End")](c,d)):(e=a.createRange(this.win.document),e.setStartAndEnd(c,d)),this.setSingleRange(e,this.isBackward())}}function x(a){var b=[],c=new I(a.anchorNode,a.anchorOffset),d=new I(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=0,g=a.rangeCount;g>f;++f)b[f]=F.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.config.checkSelectionRanges=!0;var y,z,A="boolean",B="number",C=a.dom,D=a.util,E=D.isHostMethod,F=a.DomRange,G=a.WrappedRange,H=a.DOMException,I=C.DomPosition,J=a.features,K="Control",L=C.getDocument,M=C.getBody,N=F.rangesEqual,O=E(window,"getSelection"),P=D.isHostObject(document,"selection");J.implementsWinGetSelection=O,J.implementsDocSelection=P;var Q=P&&(!O||a.config.preferTextRange);Q?(y=f,a.isSelectionValid=function(a){var b=d(a,"isSelectionValid").document,c=b.selection;return"None"!=c.type||L(c.createRange().parentElement())==b}):O?(y=e,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected."),a.getNativeSelection=y;var R=y(),S=a.createNativeRange(document),T=M(document),U=D.areHostProperties(R,["anchorNode","focusNode","anchorOffset","focusOffset"]);J.selectionHasAnchorAndFocus=U;var V=E(R,"extend");J.selectionHasExtend=V;var W=typeof R.rangeCount==B;J.selectionHasRangeCount=W;var X=!1,Y=!0,Z=V?function(b,c){var d=F.getRangeDocument(c),e=a.createRange(d);e.collapseToPoint(c.endContainer,c.endOffset),b.addRange(k(e)),b.extend(c.startContainer,c.startOffset)}:null;D.areHostMethods(R,["addRange","getRangeAt","removeAllRanges"])&&typeof R.rangeCount==B&&J.implementsDomRange&&!function(){var b=window.getSelection();if(b){for(var c=b.rangeCount,d=c>1,e=[],f=g(b),h=0;c>h;++h)e[h]=b.getRangeAt(h);var i=M(document),j=i.appendChild(document.createElement("div"));j.contentEditable="false";var k=j.appendChild(document.createTextNode("   ")),l=document.createRange();if(l.setStart(k,1),l.collapse(!0),b.addRange(l),Y=1==b.rangeCount,b.removeAllRanges(),!d){var m=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(m&&parseInt(m[1])>=36)X=!1;else{var n=l.cloneRange();l.setStart(k,0),n.setEnd(k,3),n.setStart(k,2),b.addRange(l),b.addRange(n),X=2==b.rangeCount}}for(i.removeChild(j),b.removeAllRanges(),h=0;c>h;++h)0==h&&f?Z?Z(b,e[h]):(a.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),b.addRange(e[h])):b.addRange(e[h])}}(),J.selectionSupportsMultipleRanges=X,J.collapsedNonEditableSelectionsSupported=Y;var $,_=!1;T&&E(T,"createControlRange")&&($=T.createControlRange(),D.areHostProperties($,["item","add"])&&(_=!0)),J.implementsControlRange=_,z=U?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var aa;E(R,"getRangeAt")?aa=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:U&&(aa=function(b){var c=L(b.anchorNode),d=a.createRange(c);return d.setStartAndEnd(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),d.collapsed!==this.isCollapsed&&d.setStartAndEnd(b.focusNode,b.focusOffset,b.anchorNode,b.anchorOffset),d}),r.prototype=a.selectionPrototype;var ba=[],ca=function(a){if(a&&a instanceof r)return a.refresh(),a;a=d(a,"getNativeSelection");var b=t(a),c=y(a),e=P?f(a):null;return b?(b.nativeSelection=c,b.docSelection=e,b.refresh()):(b=new r(c,e,a),ba.push({win:a,selection:b})),b};a.getSelection=ca,a.getIframeSelection=function(c){return b.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),a.getSelection(C.getIframeWindow(c))};var da=r.prototype;if(!Q&&U&&D.areHostMethods(R,["removeAllRanges","addRange"])){da.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),j(this)};var ea=function(a,b){Z(a.nativeSelection,b),a.refresh()};W?da.addRange=function(b,d){if(_&&P&&this.docSelection.type==K)q(this,b);else if(c(d)&&V)ea(this,b);else{var e;X?e=this.rangeCount:(this.removeAllRanges(),e=0);var f=k(b).cloneRange();try{this.nativeSelection.addRange(f)}catch(g){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==e+1){if(a.config.checkSelectionRanges){var i=aa(this.nativeSelection,this.rangeCount-1);i&&!N(i,b)&&(b=new G(i))}this._ranges[this.rangeCount-1]=b,h(this,b,ha(this.nativeSelection)),this.isCollapsed=z(this)}else this.refresh()}}:da.addRange=function(a,b){c(b)&&V?ea(this,a):(this.nativeSelection.addRange(k(a)),this.refresh())},da.setRanges=function(a){if(_&&P&&a.length>1)u(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;c>b;++b)this.addRange(a[b])}}}else{if(!(E(R,"empty")&&E(S,"select")&&_&&Q))return b.fail("No means of selecting a Range or TextRange was found"),!1;da.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=L(this.anchorNode);else if(this.docSelection.type==K){var b=this.docSelection.createRange();b.length&&(a=L(b.item(0)))}if(a){var c=M(a).createTextRange();c.select(),this.docSelection.empty()}}}catch(d){}j(this)},da.addRange=function(b){this.docSelection.type==K?q(this,b):(a.WrappedTextRange.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,h(this,b,!1))},da.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?u(this,a):b&&this.addRange(a[0])}}da.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new H("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};var fa;if(Q)fa=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=M(b.win.document).createTextRange(),c.collapse(!0)),b.docSelection.type==K?p(b):n(c)?o(b,c):j(b)};else if(E(R,"getRangeAt")&&typeof R.rangeCount==B)fa=function(b){if(_&&P&&b.docSelection.type==K)p(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;d>c;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));h(b,b._ranges[b.rangeCount-1],ha(b.nativeSelection)),b.isCollapsed=z(b)}else j(b)};else{if(!U||typeof R.isCollapsed!=A||typeof S.collapsed!=A||!J.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;fa=function(a){var b,c=a.nativeSelection;c.anchorNode?(b=aa(c,0),a._ranges=[b],a.rangeCount=1,i(a),a.isCollapsed=z(a)):j(a)}}da.refresh=function(a){var b=a?this._ranges.slice(0):null,c=this.anchorNode,d=this.anchorOffset;if(fa(this),a){var e=b.length;if(e!=this._ranges.length)return!0;if(this.anchorNode!=c||this.anchorOffset!=d)return!0;for(;e--;)if(!N(b[e],this._ranges[e]))return!0;return!1}};var ga=function(a,b){var c=a.getAllRanges();a.removeAllRanges();for(var d=0,e=c.length;e>d;++d)N(b,c[d])||a.addRange(c[d]);a.rangeCount||j(a)};_&&P?da.removeRange=function(a){if(this.docSelection.type==K){for(var b,c=this.docSelection.createRange(),d=m(a),e=L(c.item(0)),f=M(e).createControlRange(),g=!1,h=0,i=c.length;i>h;++h)b=c.item(h),b!==d||g?f.add(c.item(h)):g=!0;f.select(),p(this)}else ga(this,a)}:da.removeRange=function(a){ga(this,a)};var ha;!Q&&U&&J.implementsDomRange?(ha=g,da.isBackward=function(){return ha(this)}):ha=da.isBackward=function(){return!1},da.isBackwards=da.isBackward,da.toString=function(){for(var a=[],b=0,c=this.rangeCount;c>b;++b)a[b]=""+this._ranges[b];return a.join("")},da.collapse=function(b,c){v(this,b);var d=a.createRange(b);d.collapseToPoint(b,c),this.setSingleRange(d),this.isCollapsed=!0},da.collapseToStart=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},da.collapseToEnd=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},da.selectAllChildren=function(b){v(this,b);var c=a.createRange(b);c.selectNodeContents(b),this.setSingleRange(c)},da.deleteFromDocument=function(){if(_&&P&&this.docSelection.type==K){for(var a,b=this.docSelection.createRange();b.length;)a=b.item(0),b.remove(a),a.parentNode.removeChild(a);this.refresh()}else if(this.rangeCount){var c=this.getAllRanges();if(c.length){this.removeAllRanges();for(var d=0,e=c.length;e>d;++d)c[d].deleteContents();this.addRange(c[e-1])}}},da.eachRange=function(a,b){for(var c=0,d=this._ranges.length;d>c;++c)if(a(this.getRangeAt(c)))return b},da.getAllRanges=function(){var a=[];return this.eachRange(function(b){a.push(b)}),a},da.setSingleRange=function(a,b){this.removeAllRanges(),this.addRange(a,b)},da.callMethodOnEachRange=function(a,b){var c=[];return this.eachRange(function(d){c.push(d[a].apply(d,b))}),c},da.setStart=w(!0),da.setEnd=w(!1),a.rangePrototype.select=function(a){ca(this.getDocument()).setSingleRange(this,a)},da.changeEachRange=function(a){var b=[],c=this.isBackward();this.eachRange(function(c){a(c),b.push(c)}),this.removeAllRanges(),c&&1==b.length?this.addRange(b[0],"backward"):this.setRanges(b)},da.containsNode=function(a,b){return this.eachRange(function(c){return c.containsNode(a,b)},!0)||!1},da.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}},da.moveToBookmark=function(b){for(var c,d,e=[],f=0;c=b.rangeBookmarks[f++];)d=a.createRange(this.win),d.moveToBookmark(c),e.push(d);b.backward?this.setSingleRange(e[0],"backward"):this.setRanges(e)},da.toHtml=function(){var a=[];return this.eachRange(function(b){a.push(F.toHtml(b))}),a.join("")},J.implementsTextRange&&(da.getNativeTextRange=function(){var c;if(c=this.docSelection){var d=c.createRange();if(n(d))return d;throw b.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw b.createError("getNativeTextRange: selection contains no range")}),da.getName=function(){return"WrappedSelection"},da.inspect=function(){return x(this)},da.detach=function(){t(this.win,"delete"),s(this)},r.detachAll=function(){t(null,"deleteAll")},r.inspect=x,r.isDirectionBackward=c,a.Selection=r,a.selectionPrototype=da,a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return ca(a)}),a=null})});var J=!1,K=function(a){J||(J=!0,!E.initialized&&E.config.autoInitialize&&l())};return C&&(/^(?:complete|interactive)$/.test(document.readyState)?K():(a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",K,!1),G(window,"load",K))),E},this),function(a,b){"function"==typeof define&&define.amd?define(["./rangy-core"],a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a(require("rangy")):a(b.rangy)}(function(a){a.createModule("ClassApplier",["WrappedSelection"],function(a,b){function c(a,b){for(var c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)return!1;return!0}function d(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function e(a,b){return a.className&&new RegExp("(?:^|\\s)"+b+"(?:\\s|$)").test(a.className)}function f(a,b){a.className?e(a,b)||(a.className+=" "+b):a.className=b}function g(a){return a&&a.split(/\s+/).sort().join(" ")}function h(a){return g(a.className)}function i(a,b){return h(a)==h(b)}function j(a,b,c,d,e){var f=a.node,g=a.offset,h=f,i=g;f==d&&g>e&&++i,f!=b||g!=c&&g!=c+1||(h=d,i+=e-c),f==b&&g>c+1&&--i,a.node=h,a.offset=i}function k(a,b,c){a.node==b&&a.offset>c&&--a.offset}function l(a,b,c,d){-1==c&&(c=b.childNodes.length);for(var e,f=a.parentNode,g=H.getNodeIndex(a),h=0;e=d[h++];)j(e,f,g,b,c);b.childNodes.length==c?b.appendChild(a):b.insertBefore(a,b.childNodes[c])}function m(a,b){for(var c,d=a.parentNode,e=H.getNodeIndex(a),f=0;c=b[f++];)k(c,d,e);a.parentNode.removeChild(a)}function n(a,b,c,d,e){for(var f,g=[];f=a.firstChild;)l(f,b,c++,e),g.push(f);return d&&m(a,e),g}function o(a,b){return n(a,a.parentNode,H.getNodeIndex(a),!0,b)}function p(a,b){var c=a.cloneRange();c.selectNodeContents(b);var d=c.intersection(a),e=d?d.toString():"";return""!=e}function q(a){for(var b,c=a.getNodes([3]),d=0;(b=c[d])&&!p(a,b);)++d;for(var e=c.length-1;(b=c[e])&&!p(a,b);)--e;return c.slice(d,e+1)}function r(a,b){if(a.attributes.length!=b.attributes.length)return!1;for(var c,d,e,f=0,g=a.attributes.length;g>f;++f)if(c=a.attributes[f],e=c.name,"class"!=e){if(d=b.attributes.getNamedItem(e),null===c!=(null===d))return!1;if(c.specified!=d.specified)return!1;if(c.specified&&c.nodeValue!==d.nodeValue)return!1}return!0}function s(a,b){for(var c,d=0,e=a.attributes.length;e>d;++d)if(c=a.attributes[d].name,(!b||!J(b,c))&&a.attributes[d].specified&&"class"!=c)return!0;return!1}function t(a,b){return c(b,function(b,c){if("object"==typeof c){if(!t(a[b],c))return!1}else if(a[b]!==c)return!1})}function u(a){var b;return a&&1==a.nodeType&&((b=a.parentNode)&&9==b.nodeType&&"on"==b.designMode||O(a)&&!O(a.parentNode))}function v(a){return(O(a)||1!=a.nodeType&&O(a.parentNode))&&!u(a)}function w(a){return a&&1==a.nodeType&&!P.test(N(a,"display"))}function x(a){if(0==a.data.length)return!0;if(Q.test(a.data))return!1;var b=N(a.parentNode,"whiteSpace");switch(b){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(a.data))return!1}return w(a.previousSibling)||w(a.nextSibling)}function y(a){var b,c,d=[];for(b=0;c=a[b++];)d.push(new I(c.startContainer,c.startOffset),new I(c.endContainer,c.endOffset));return d}function z(a,b){for(var c,d,e,f=0,g=a.length;g>f;++f)c=a[f],d=b[2*f],e=b[2*f+1],c.setStartAndEnd(d.node,d.offset,e.node,e.offset)}function A(a,b){return H.isCharacterDataNode(a)?0==b?!!a.previousSibling:b==a.length?!!a.nextSibling:!0:b>0&&b<a.childNodes.length}function B(a,c,d,e){var f,g,h=0==d;if(H.isAncestorOf(c,a))return a;if(H.isCharacterDataNode(c)){var i=H.getNodeIndex(c);if(0==d)d=i;else{if(d!=c.length)throw b.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+d+" in "+c.data);d=i+1}c=c.parentNode}if(A(c,d)){f=c.cloneNode(!1),g=c.parentNode,f.id&&f.removeAttribute("id");for(var j,k=0;j=c.childNodes[d];)l(j,f,k++,e);return l(f,g,H.getNodeIndex(c)+1,e),c==a?f:B(a,g,H.getNodeIndex(f),e)}if(a!=c){f=c.parentNode;var m=H.getNodeIndex(c);return h||m++,B(a,f,m,e)}return a}function C(a,b){return a.namespaceURI==b.namespaceURI&&a.tagName.toLowerCase()==b.tagName.toLowerCase()&&i(a,b)&&r(a,b)&&"inline"==N(a,"display")&&"inline"==N(b,"display")}function D(a){var b=a?"nextSibling":"previousSibling";return function(c,d){var e=c.parentNode,f=c[b];if(f){if(f&&3==f.nodeType)return f}else if(d&&(f=e[b],f&&1==f.nodeType&&C(e,f))){var g=f[a?"firstChild":"lastChild"];if(g&&3==g.nodeType)return g}return null}}function E(a){this.isElementMerge=1==a.nodeType,this.textNodes=[];var b=this.isElementMerge?a.lastChild:a;b&&(this.textNodes[0]=b)}function F(a,b,e){var f,g,h,i,j=this;j.cssClass=j.className=a;var k=null,l={};if("object"==typeof b&&null!==b){for(e=b.tagNames,k=b.elementProperties,l=b.elementAttributes,g=0;i=T[g++];)b.hasOwnProperty(i)&&(j[i]=b[i]);f=b.normalize}else f=b;j.normalize="undefined"==typeof f?!0:f,j.attrExceptions=[];var m=document.createElement(j.elementTagName);j.elementProperties=j.copyPropertiesToElement(k,m,!0),c(l,function(a){j.attrExceptions.push(a)}),j.elementAttributes=l,j.elementSortedClassName=j.elementProperties.hasOwnProperty("className")?j.elementProperties.className:a,j.applyToAnyTagName=!1;var n=typeof e;if("string"==n)"*"==e?j.applyToAnyTagName=!0:j.tagNames=d(e.toLowerCase()).split(/\s*,\s*/);else if("object"==n&&"number"==typeof e.length)for(j.tagNames=[],g=0,h=e.length;h>g;++g)"*"==e[g]?j.applyToAnyTagName=!0:j.tagNames.push(e[g].toLowerCase());else j.tagNames=[j.elementTagName]}function G(a,b,c){return new F(a,b,c)}var H=a.dom,I=H.DomPosition,J=H.arrayContains,K=H.isHtmlNamespace,L="span",M=function(){function a(a,b,c){return b&&c?" ":""}return function(b,c){b.className&&(b.className=b.className.replace(new RegExp("(^|\\s)"+c+"(\\s|$)"),a))}}(),N=H.getComputedStyleProperty,O=function(){var a=document.createElement("div");return"boolean"==typeof a.isContentEditable?function(a){return a&&1==a.nodeType&&a.isContentEditable}:function(a){return a&&1==a.nodeType&&"false"!=a.contentEditable?"true"==a.contentEditable||O(a.parentNode):!1}}(),P=/^inline(-block|-table)?$/i,Q=/[^\r\n\t\f \u200B]/,R=D(!1),S=D(!0);E.prototype={doMerge:function(a){var b=this.textNodes,c=b[0];if(b.length>1){for(var d,e,f,g,h=H.getNodeIndex(c),i=[],j=0,k=0,l=b.length;l>k;++k){if(d=b[k],e=d.parentNode,k>0&&(e.removeChild(d),e.hasChildNodes()||e.parentNode.removeChild(e),a))for(f=0;g=a[f++];)g.node==d&&(g.node=c,g.offset+=j),g.node==e&&g.offset>h&&(--g.offset,g.offset==h+1&&l-1>k&&(g.node=c,g.offset=j));i[k]=d.data,j+=d.data.length}c.data=i.join("")}return c.data},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=0,c=this.textNodes.length;c>b;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}};var T=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],U={};F.prototype={elementTagName:L,elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(a,b,c){var d,e,h,i,j,k,l={};for(var m in a)if(a.hasOwnProperty(m))if(i=a[m],j=b[m],"className"==m)f(b,i),f(b,this.className),b[m]=g(b[m]),c&&(l[m]=b[m]);else if("style"==m){e=j,c&&(l[m]=h={});for(d in a[m])e[d]=i[d],c&&(h[d]=e[d]);this.attrExceptions.push(m)}else b[m]=i,c&&(l[m]=b[m],k=U.hasOwnProperty(m)?U[m]:m,this.attrExceptions.push(k));return c?l:""},copyAttributesToElement:function(a,b){for(var c in a)a.hasOwnProperty(c)&&b.setAttribute(c,a[c])},hasClass:function(a){return 1==a.nodeType&&J(this.tagNames,a.tagName.toLowerCase())&&e(a,this.className)},getSelfOrAncestorWithClass:function(a){for(;a;){if(this.hasClass(a))return a;a=a.parentNode}return null},isModifiable:function(a){return!this.applyToEditableOnly||v(a)},isIgnorableWhiteSpaceNode:function(a){return this.ignoreWhiteSpace&&a&&3==a.nodeType&&x(a)},postApply:function(a,b,c,d){for(var e,f,g,h=a[0],i=a[a.length-1],j=[],k=h,l=i,m=0,n=i.length,o=0,p=a.length;p>o;++o)f=a[o],g=R(f,!d),g?(e||(e=new E(g),j.push(e)),e.textNodes.push(f),f===h&&(k=e.textNodes[0],m=k.length),f===i&&(l=e.textNodes[0],n=e.getLength())):e=null;var q=S(i,!d);if(q&&(e||(e=new E(i),j.push(e)),e.textNodes.push(q)),j.length){for(o=0,p=j.length;p>o;++o)j[o].doMerge(c);b.setStartAndEnd(k,m,l,n)}},createContainer:function(a){var b=a.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,b,!1),this.copyAttributesToElement(this.elementAttributes,b),f(b,this.className),this.onElementCreate&&this.onElementCreate(b,this),b},applyToTextNode:function(a,b){var c=a.parentNode;if(1==c.childNodes.length&&this.useExistingElements&&K(c)&&J(this.tagNames,c.tagName.toLowerCase())&&t(c,this.elementProperties))f(c,this.className);else{var d=this.createContainer(H.getDocument(a));a.parentNode.insertBefore(d,a),d.appendChild(a)}},isRemovable:function(a){return K(a)&&a.tagName.toLowerCase()==this.elementTagName&&h(a)==this.elementSortedClassName&&t(a,this.elementProperties)&&!s(a,this.attrExceptions)&&this.isModifiable(a)},isEmptyContainer:function(a){var b=a.childNodes.length;return 1==a.nodeType&&this.isRemovable(a)&&(0==b||1==b&&this.isEmptyContainer(a.firstChild))},removeEmptyContainers:function(a){for(var b,c=this,d=a.getNodes([1],function(a){return c.isEmptyContainer(a)}),e=[a],f=y(e),g=0;b=d[g++];)m(b,f);z(e,f)},undoToTextNode:function(a,b,c,d){if(!b.containsNode(c)){var e=b.cloneRange();e.selectNode(c),e.isPointInRange(b.endContainer,b.endOffset)&&(B(c,b.endContainer,b.endOffset,d),b.setEndAfter(c)),e.isPointInRange(b.startContainer,b.startOffset)&&(c=B(c,b.startContainer,b.startOffset,d))}this.isRemovable(c)?o(c,d):M(c,this.className)},applyToRange:function(a,b){b=b||[];var c=y(b||[]);a.splitBoundariesPreservingPositions(c),this.removeEmptyElements&&this.removeEmptyContainers(a);var d=q(a);if(d.length){for(var e,f=0;e=d[f++];)this.isIgnorableWhiteSpaceNode(e)||this.getSelfOrAncestorWithClass(e)||!this.isModifiable(e)||this.applyToTextNode(e,c);e=d[d.length-1],a.setStartAndEnd(d[0],0,e,e.length),this.normalize&&this.postApply(d,a,c,!1),z(b,c)}},applyToRanges:function(a){for(var b=a.length;b--;)this.applyToRange(a[b],a);return a},applyToSelection:function(b){var c=a.getSelection(b);c.setRanges(this.applyToRanges(c.getAllRanges()))},undoToRange:function(a,b){b=b||[];var c=y(b);a.splitBoundariesPreservingPositions(c),this.removeEmptyElements&&this.removeEmptyContainers(a,c);var d,e,f=q(a),g=f[f.length-1];if(f.length){for(var h=0,i=f.length;i>h;++h)d=f[h],e=this.getSelfOrAncestorWithClass(d),e&&this.isModifiable(d)&&this.undoToTextNode(d,a,e,c),a.setStartAndEnd(f[0],0,g,g.length);this.normalize&&this.postApply(f,a,c,!0),z(b,c)}},undoToRanges:function(a){for(var b=a.length;b--;)this.undoToRange(a[b],a);return a},undoToSelection:function(b){var c=a.getSelection(b),d=a.getSelection(b).getAllRanges();this.undoToRanges(d),c.setRanges(d)},isAppliedToRange:function(a){if(a.collapsed||""==a.toString())return!!this.getSelfOrAncestorWithClass(a.commonAncestorContainer);var b=a.getNodes([3]);if(b.length)for(var c,d=0;c=b[d++];)if(!this.isIgnorableWhiteSpaceNode(c)&&p(a,c)&&this.isModifiable(c)&&!this.getSelfOrAncestorWithClass(c))return!1;return!0},isAppliedToRanges:function(a){var b=a.length;if(0==b)return!1;for(;b--;)if(!this.isAppliedToRange(a[b]))return!1;return!0},isAppliedToSelection:function(b){var c=a.getSelection(b);return this.isAppliedToRanges(c.getAllRanges())},toggleRange:function(a){this.isAppliedToRange(a)?this.undoToRange(a):this.applyToRange(a)},toggleSelection:function(a){this.isAppliedToSelection(a)?this.undoToSelection(a):this.applyToSelection(a)},getElementsWithClassIntersectingRange:function(a){var b=[],c=this;return a.getNodes([3],function(a){var d=c.getSelfOrAncestorWithClass(a);d&&!J(b,d)&&b.push(d)}),b},detach:function(){}},F.util={hasClass:e,addClass:f,removeClass:M,hasSameClasses:i,replaceWithOwnChildren:o,elementsHaveSameNonClassAttributes:r,elementHasNonClassAttributes:s,splitNodeAt:B,isEditableElement:O,isEditingHost:u,isEditable:v},a.CssClassApplier=a.ClassApplier=F,a.createCssClassApplier=a.createClassApplier=G})},this),function(a,b){"use strict";function c(a,b){var c=0,d=b.cloneContents().querySelectorAll("[contenteditable='false']");for(c=0;c<d.length;c++)if("A"!=d[c].tagName)return a.preventDefault(),!0;return!1}var d=function(){var d=function(a){return a.replace(/^\s+|\s+$/g,"")},e=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},f=a.rangy||null,g=a.Undo||null,h=!f||!g,i=a.Key={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capsLock:20,escape:27,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindow:91,rightWindowKey:92,select:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numLock:144,scrollLock:145,semiColon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,singleQuote:222},j=function(b){var d,e,f,g=this,k=new j.Action,l=new j.Cache,m=new j.Cursor,n=new j.HtmlAssistant,o=new j.Utilities,p=new j.Selection,q={focus:function(b){b=b||a.event,j.activeElement=d},blur:function(b){b=b||a.event,j.activeElement===d&&(j.activeElement=null),n.placeholders()},down:function(b){b=b||a.event;var d=!0;if(229!==b.keyCode){if(o.isCommand(b,function(){l.cmd=!0},function(){l.cmd=!1}),o.isShift(b,function(){l.shift=!0},function(){l.shift=!1}),o.isModifier(b,function(a){if(l.cmd){if((s.mode===j.inlineMode||s.mode===j.partialMode)&&"paste"!==a)return void o.preventDefaultEvent(b);var c=typeof a,e=null;e="function"===c?a:q.command[a],d=e.call(g,b),d===!1&&(o.preventDefaultEvent(b),o.stopPropagation(b))}}),-1!==s.maxLength){var e=n.text().length,f=!1,h=a.getSelection();if(h&&(f=!h.isCollapsed),e>=s.maxLength&&!o.isSpecial(b)&&!o.isNavigational(b)&&!f)return o.preventDefaultEvent(b)}switch(b.keyCode){case i.enter:q.enterKey(b);break;case i.backspace:case i["delete"]:if(lasso_editor.readOnlyExists){var k=a.getSelection();if(k.rangeCount){var m=k.getRangeAt(0);if(window.getSelection().isCollapsed){for(var p=m.endContainer,r=p;p&&p.parentNode!==articleMedium.element;){var t=p.parentNode.querySelectorAll("[contenteditable='false']");if(t.length>0)break;p=p.parentNode}"false"==p.contentEditable&&b.preventDefault(),b.keyCode==i.backspace&&p.previousElementSibling&&("false"==p.previousElementSibling.contentEditable||p.previousElementSibling.classList.contains("lasso-undeletable"))&&"A"!=p.previousElementSibling.tagName?0==k.focusOffset?b.preventDefault():r.length==k.focusOffset&&1==r.length&&(b.preventDefault(),r.data=""):b.keyCode==i["delete"]&&p.nextElementSibling&&("false"==p.nextElementSibling.contentEditable||p.nextElementSibling.classList.contains("lasso-undeletable"))&&"A"!=p.nextElementSibling.tagName&&(k.focusOffset==k.focusNode.length||void 0===k.focusNode.length?b.preventDefault():1==r.length&&0==k.focusOffset&&(b.preventDefault(),r.data=""))}else if(c(b,m))break}}if(lasso_editor.undeletableExists){var k=a.getSelection();if(k.rangeCount){var m=k.getRangeAt(0);if(window.getSelection().isCollapsed)for(var r=m.endContainer,p=r.parentNode;p!==articleMedium.element;){if(p.classList.contains("lasso-undeletable")){b.keyCode==i.backspace?0==k.focusOffset?b.preventDefault():r.length==k.focusOffset&&1==r.length&&(b.preventDefault(),
r.data=""):b.keyCode==i["delete"]&&(k.focusOffset==k.focusNode.length||void 0===k.focusNode.length?b.preventDefault():1==r.length&&0==k.focusOffset&&(b.preventDefault(),r.data=""));break}p=p.parentNode}else{var t=m.cloneContents().querySelectorAll(".lasso-undeletable");t.length&&b.preventDefault()}}}q.backspaceOrDeleteKey(b);break;default:if(lasso_editor.readOnlyExists||lasso_editor.undeletableExists){var k=a.getSelection();if(k.rangeCount){var m=k.getRangeAt(0);if(!window.getSelection().isCollapsed){if(c(b,m))break;var t=m.cloneContents().querySelectorAll(".lasso-undeletable");t.length&&b.preventDefault()}}}}return d}},up:function(b){b=b||a.event,o.isCommand(b,function(){l.cmd=!1},function(){l.cmd=!0}),n.clean(),n.placeholders();var c;if(null!==s.keyContext&&(c=s.keyContext[b.keyCode])){var d=m.parent();d&&c.call(g,b,d)}k.preserveElementFocus()},command:{bold:function(a){o.preventDefaultEvent(a),new j.Element(g,"bold").setClean(!1).invoke(s.beforeInvokeElement)},underline:function(a){o.preventDefaultEvent(a),new j.Element(g,"underline").setClean(!1).invoke(s.beforeInvokeElement)},italicize:function(a){o.preventDefaultEvent(a),new j.Element(g,"italic").setClean(!1).invoke(s.beforeInvokeElement)},quote:function(a){},paste:function(a){if(g.makeUndoable(),s.pasteAsText){var b=o.selection.saveSelection();o.pasteHook(function(a){o.selection.restoreSelection(b),a=a.replace(/\n/g,"<br>"),new j.Html(g,a).setClean(!1).insert(s.beforeInsertHtml,!0),n.clean(),n.placeholders()})}else n.clean(),n.placeholders()}},enterKey:function(a){if(s.mode===j.inlineMode)return o.preventDefaultEvent(a);if(!l.shift){var b,c,e,f=n.atCaret()||{},g=d.children,h=f===d.lastChild?d.lastChild:null;h&&h!==d.firstChild&&s.autoHR&&"partial"!==s.mode&&s.tags.horizontalRule&&(o.preventDefaultEvent(a),b=""===n.text(h)&&h.nodeName.toLowerCase()===s.tags.paragraph,b&&g.length>=2&&(c=g[g.length-2],c.nodeName.toLowerCase()===s.tags.horizontalRule&&(b=!1)),b&&(n.addTag(s.tags.horizontalRule,!1,!0,f),f=f.nextSibling),null!==(e=n.addTag(s.tags.paragraph,!0,null,f))&&(e.innerHTML="",m.set(0,e)))}return!0},backspaceOrDeleteKey:function(a){if(null!==d.lastChild){var b=d.lastChild,c=b.previousSibling;b&&s.tags.horizontalRule&&b.nodeName.toLocaleLowerCase()===s.tags.horizontalRule?d.removeChild(b):b&&c&&o.html.text(b).length<1&&c.nodeName.toLowerCase()===s.tags.horizontalRule&&b.nodeName.toLowerCase()===s.tags.paragraph&&(d.removeChild(b),d.removeChild(c))}}},r={element:null,modifier:"auto",placeholder:"",autofocus:!1,autoHR:!0,mode:j.richMode,maxLength:-1,modifiers:{b:"bold",i:"italicize",u:"underline",v:"paste"},tags:{"break":"br",horizontalRule:"hr",paragraph:"p",outerLevel:["pre","blockquote","figure"],innerLevel:["a","b","u","i","img","strong"]},cssClasses:{editor:"Medium",pasteHook:"Medium-paste-hook",placeholder:"Medium-placeholder",clear:"Medium-clear"},attributes:{remove:["style","class"]},pasteAsText:!0,beforeInvokeElement:function(){},beforeInsertHtml:function(){},beforeAddTag:function(a,b,c,d){},keyContext:null,pasteEventHandler:function(a){}},s=o.deepExtend(r,b),t={};for(f in r)"object"!=typeof r[f]&&r.hasOwnProperty(f)&&s.element.getAttribute("data-medium-"+i)&&(e=s.element.getAttribute("data-medium-"+i),("false"===e.toLowerCase()||"true"===e.toLowerCase())&&(e="true"===e.toLowerCase()),s[f]=e);if(s.modifiers)for(f in s.modifiers)"undefined"!=typeof i[f]&&(s.modifiers[i[f]]=s.modifiers[f]);if(s.keyContext)for(f in s.keyContext)"undefined"!=typeof i[f]&&(s.keyContext[i[f]]=s.keyContext[f]);d=s.element;var f,u=d.children;for(f=0;f<u.length;f++)0!=u[f].contentEditable&&(u[f].contentEditable=!0);d.contentEditable=!0,d.className+=" "+s.cssClasses.editor+(" "+s.cssClasses.editor+"-"+s.mode),s.tags=s.tags||{},s.tags.outerLevel&&(s.tags.outerLevel=s.tags.outerLevel.concat([s.tags.paragraph,s.tags.horizontalRule])),this.settings=s,this.element=d,this.intercept=q,this.action=k,this.cache=l,this.cursor=m,this.html=n,this.utils=o,this.selection=p,t.element=d,t.medium=this,t.settings=s,t.action=k,t.cache=l,t.cursor=m,t.html=n,t.intercept=q,t.utils=o,t.selection=p,k.setBridge(t),l.setBridge(t),m.setBridge(t),n.setBridge(t),o.setBridge(t),p.setBridge(t),n.clean(),n.placeholders(),k.preserveElementFocus(),k.listen(),h?this.makeUndoable=function(){}:(this.dirty=!1,this.undoable=new j.Undoable(this),this.undo=this.undoable.undo,this.redo=this.undoable.redo,this.makeUndoable=this.undoable.makeUndoable),d.medium=this,l.initialized=!0};return j.prototype={insertHtml:function(a,b){var c=new j.Html(this,a).insert(this.settings.beforeInsertHtml);return this.utils.triggerEvent(this.element,"change"),b&&b.apply(c),this},invokeElement:function(a,b){var c=this.settings,b=b||{},d=b.remove||[];switch(c.mode){case j.inlineMode:case j.partialMode:return this}return d.length>0&&(e(c,"class")||d.push("class")),new j.Element(this,a,b).invoke(this.settings.beforeInvokeElement),this.utils.triggerEvent(this.element,"change"),this},behavior:function(){return h?"wild":"domesticated"},value:function(a){return"undefined"==typeof a?this.element.innerHTML:(this.element.innerHTML=a,this.html.clean(),this.html.placeholders(),this)},focus:function(){var a=this.element;return a.focus(),this},select:function(){var c,d,e=this.element;return e.focus(),b.body.createTextRange?(c=b.body.createTextRange(),c.moveToElementText(e),c.select()):a.getSelection&&(d=a.getSelection(),c=b.createRange(),c.selectNodeContents(e),d.removeAllRanges(),d.addRange(c)),this},isActive:function(){return j.activeElement===this.element},destroy:function(){var a=this.element,b=this.intercept,c=this.settings,e=this.placeholder||null;null!==e&&e.setup&&(e.parentNode.removeChild(e),delete a.placeHolderActive),a.removeAttribute("contenteditable"),a.className=d(a.className.replace(c.cssClasses.editor,"").replace(c.cssClasses.clear,"").replace(c.cssClasses.editor+"-"+c.mode,"")),this.utils.removeEvent(a,"keyup",b.up).removeEvent(a,"keydown",b.down).removeEvent(a,"focus",b.focus).removeEvent(a,"blur",b.focus).removeEvent(a,"paste",c.pasteEventHandler)},clear:function(){this.element.innerHTML="",this.html.placeholders()}},j.Element=function(a,b,c){if(this.medium=a,this.element=a.settings.element,h)this.tagName=b;else switch(b.toLowerCase()){case"bold":this.tagName="b";break;case"italic":this.tagName="i";break;case"underline":this.tagName="u";break;default:this.tagName=b}this.attributes=c||{},this.clean=!0},j.Html=function(a,b){this.medium=a,this.element=a.settings.element,this.html=b,this.clean=!0},j.Injector=function(){},h?(j.Element.prototype={invoke:function(a){j.activeElement===this.element&&(a&&a.apply(this),b.execCommand(this.tagName,!1))},setClean:function(){return this}},j.Injector.prototype={inject:function(a,b){return this.insertHTML(a,b),null}},j.Undoable=function(){}):(f.rangePrototype.insertNodeAtEnd=function(a){var b=this.cloneRange();b.collapse(!1),b.insertNode(a),b.detach(),this.setEndAfter(a)},j.Element.prototype={invoke:function(b){if(j.activeElement===this.element){b&&b.apply(this);var c,d,e=this.attributes,g=this.tagName.toLowerCase();void 0!==e.className?(d=(e.className.split[" "]||[e.className]).shift(),delete e.className):d="lasso-noclass",c=f.createClassApplier(d,{elementTagName:g,elementAttributes:this.attributes}),c.toggleSelection(a),this.clean&&(this.medium.html.clean(),this.medium.html.placeholders())}},setClean:function(a){return this.clean=a,this}},j.Injector.prototype={inject:function(a){var c,d=!1;if("string"==typeof a){var e=b.createElement("div");e.innerHTML=a,c=e.childNodes,d=!0}else c=a;this.insertHTML('<span id="wedge"></span>');var f=b.getElementById("wedge"),g=f.parentNode,h=0;if(f.removeAttribute("id"),d)for(;h<c.length;)g.insertBefore(c[h],f);else g.insertBefore(c,f);return g.removeChild(f),f=null,c}},j.Undoable=function(a){var b,c=this,d=a.settings.element,e=a.utils,f=e.addEvent,g=d.innerHTML,h=new Undo.Stack,j=Undo.Command.extend({constructor:function(a,b){this.oldValue=a,this.newValue=b},execute:function(){},undo:function(){d.innerHTML=this.oldValue,g=this.oldValue,a.canUndo=h.canUndo(),a.canRedo=h.canRedo(),a.dirty=h.dirty()},redo:function(){d.innerHTML=this.newValue,a.canUndo=h.canUndo(),a.canRedo=h.canRedo(),a.dirty=h.dirty()}}),k=function(){var b=d.innerHTML;b!=g&&(c.movingThroughStack||(h.execute(new j(g,b)),g=b,a.dirty=h.dirty()),e.triggerEvent(a.settings.element,"change"))};this.medium=a,this.timer=b,this.stack=h,this.makeUndoable=k,this.EditCommand=j,this.movingThroughStack=!1,f(d,"keyup",function(a){return a.ctrlKey||a.keyCode===i.z?void e.preventDefaultEvent(a):(clearTimeout(b),void(b=setTimeout(function(){k()},250)))}),f(d,"keydown",function(a){return a.ctrlKey&&a.keyCode===i.z?(e.preventDefaultEvent(a),a.shiftKey?(c.movingThroughStack=!0,h.canRedo()&&h.redo()):(c.movingThroughStack=!0,h.canUndo()&&h.undo()),void(c.movingThroughStack=!1)):(c.movingThroughStack=!1,!0)})}),j.Injector.prototype.insertHTML=function(c,d){var e,f;if(a.getSelection){if(e=a.getSelection(),e.getRangeAt&&e.rangeCount){f=e.getRangeAt(0),f.deleteContents();var g=b.createElement("div");g.innerHTML=c;for(var h,i,j=b.createDocumentFragment();h=g.firstChild;)i=j.appendChild(h);var k=j.firstChild;f.insertNode(j),i&&(f=f.cloneRange(),f.setStartAfter(i),d?f.setStartBefore(k):f.collapse(!0),e.removeAllRanges(),e.addRange(f))}}else if((e=b.selection)&&"Control"!=e.type){var l=e.createRange();l.collapse(!0),e.createRange().pasteHTML(c),d&&(f=e.createRange(),f.setEndPoint("StartToStart",l),f.select())}},j.Html.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},insert:function(a,b){if(j.activeElement===this.element){a&&a.apply(this);var c=this.injector.inject(this.html,b);return this.clean&&(this.medium.html.clean(),this.medium.html.placeholders()),this.medium.makeUndoable(),c}return null},injector:new j.Injector,setClean:function(a){return this.clean=a,this}},j.Utilities=function(){},j.Utilities.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},isCommand:function(a,b,c){var d=this.settings;return"ctrl"===d.modifier&&a.ctrlKey||"cmd"===d.modifier&&a.metaKey||"auto"===d.modifier&&(a.ctrlKey||a.metaKey)?b.call():c.call()},isShift:function(a,b,c){return a.shiftKey?b.call():c.call()},isModifier:function(a,b){var c=this.settings.modifiers[a.keyCode];return c?b.call(null,c):!1},special:function(){var a={};return a[i.backspace]=!0,a[i.shift]=!0,a[i.ctrl]=!0,a[i.alt]=!0,a[i["delete"]]=!0,a[i.cmd]=!0,a}(),isSpecial:function(a){return this.cache.cmd?!0:"undefined"!=typeof this.special[a.keyCode]},navigational:function(){var a={};return a[i.upArrow]=!0,a[i.downArrow]=!0,a[i.leftArrow]=!0,a[i.rightArrow]=!0,a}(),isNavigational:function(a){return"undefined"!=typeof this.navigational[a.keyCode]},addEvent:function(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c,this},removeEvent:function(a,b,c){return a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null,this},preventDefaultEvent:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stopPropagation:function(a){a=a||window.event,a.cancelBubble=!0,void 0!==a.stopPropagation&&a.stopPropagation()},triggerEvent:function(a,c){var d;return b.createEvent?(d=b.createEvent("HTMLEvents"),d.initEvent(c,!0,!0),d.eventName=c,a.dispatchEvent(d)):(d=b.createEventObject(),a.fireEvent("on"+c,d)),this},deepExtend:function(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},this.deepExtend(a[c],b[c])):a[c]=b[c];return a},pasteHook:function(a){},setupContents:function(){var a,c=this.element,d=c.children,e=c.childNodes;!this.settings.tags.paragraph||d.length>0||this.settings.mode===j.inlineMode||(e.length>0?(a=b.createElement(this.settings.tags.paragraph),c.innerHTML.match("^[&]nbsp[;]")&&(c.innerHTML=c.innerHTML.substring(6,c.innerHTML.length-1)),a.innerHTML=c.innerHTML,c.innerHTML="",c.appendChild(a),this.cursor.set(a.innerHTML.length,a)):(a=b.createElement(this.settings.tags.paragraph),a.innerHTML="&nbsp;",c.appendChild(a)))},traverseAll:function(a,b,c){var d,e=a.childNodes,f=e.length,g=0,c=c||1;if(b=b||{},f>0)for(;f>g;g++){switch(d=e[g],d.nodeType){case 1:this.traverseAll(d,b,c+1),void 0!==b.element&&b.element(d,g,c,a);break;case 3:void 0!==b.fragment&&b.fragment(d,g,c,a)}f=e.length,d===a.lastChild&&(g=f)}}},j.Selection=function(){},j.Selection.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},saveSelection:function(){if(a.getSelection){var c=a.getSelection();if(c.rangeCount>0)return c.getRangeAt(0)}else if(b.selection&&b.selection.createRange)return b.selection.createRange();return null},restoreSelection:function(c){if(c)if(a.getSelection){var d=a.getSelection();d.removeAllRanges(),d.addRange(c)}else b.selection&&c.select&&c.select()}},j.Cursor=function(){},j.Cursor.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},set:function(c,d){var e,f=this.html;if(b.createRange){var g=a.getSelection(),h=f.lastChild(),i=f.text(h).length-1,j=d?d:h,k="undefined"!=typeof c&&null!==c?c:i;e=b.createRange(),e.setStart(j,k),e.collapse(!0),g.removeAllRanges(),g.addRange(e)}else e=b.body.createTextRange(),e.moveToElementText(d),e.collapse(!1),e.select()},parent:function(){var c,d=null;return a.getSelection?(c=a.getSelection().getRangeAt(0),d=c.commonAncestorContainer,d=1===d.nodeType?d:d.parentNode):b.selection&&(d=b.selection.createRange().parentElement()),"SPAN"==d.tagName&&(d=d.parentNode),d},caretToBeginning:function(a){this.set(0,a)},caretToEnd:function(a){this.set(this.html.text(a).length,a)}},j.HtmlAssistant=function(){},j.HtmlAssistant.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},encodeHtml:function(a){return b.createElement("a").appendChild(b.createTextNode(a)).parentNode.innerHTML},text:function(a,b){if(a=a||this.settings.element,b)a.textContent&&"undefined"!=typeof a.textContent?a.textContent=b:a.innerText=b;else{if(a.innerText)return d(a.innerText);if(a.textContent)return d(a.textContent);if(a.data)return d(a.data)}return""},changeTag:function(a,c){var d,e,f=b.createElement(c);for(d=a.firstChild;d;)e=d.nextSibling,f.appendChild(d),d=e;return a.parentNode.insertBefore(f,a),a.parentNode.removeChild(a),f},deleteNode:function(a){a.parentNode.removeChild(a)},placeholders:function(){if(a.getComputedStyle){var c=this.settings,e=this.medium.placeholder||(this.medium.placeholder=b.createElement("div")),f=c.element,g=e.style,h=a.getComputedStyle(f,null),i=function(a){return h.getPropertyValue(a)},k=this.utils,l=k.html.text(f),m=this.cursor,n=f.children.length;if(f.placeholder=e,l.length<1&&2>n){if(f.placeHolderActive)return;f.innerHTML.match("<"+c.tags.paragraph)||(f.innerHTML=""),c.placeholder.length>0&&(e.setup||(e.setup=!0,g.background=i("background"),g.backgroundColor=i("background-color"),g.fontSize=i("font-size"),g.color=h.color,g.marginTop=i("margin-top"),g.marginBottom=i("margin-bottom"),g.marginLeft=i("margin-left"),g.marginRight=i("margin-right"),g.paddingTop=i("padding-top"),g.paddingBottom=i("padding-bottom"),g.paddingLeft=i("padding-left"),g.paddingRight=i("padding-right"),g.borderTopWidth=i("border-top-width"),g.borderTopColor=i("border-top-color"),g.borderTopStyle=i("border-top-style"),g.borderBottomWidth=i("border-bottom-width"),g.borderBottomColor=i("border-bottom-color"),g.borderBottomStyle=i("border-bottom-style"),g.borderLeftWidth=i("border-left-width"),g.borderLeftColor=i("border-left-color"),g.borderLeftStyle=i("border-left-style"),g.borderRightWidth=i("border-right-width"),g.borderRightColor=i("border-right-color"),g.borderRightStyle=i("border-right-style"),e.className=c.cssClasses.placeholder+" "+c.cssClasses.placeholder+"-"+c.mode,e.innerHTML="<div>"+c.placeholder+"</div>",f.parentNode.insertBefore(e,f)),f.className+=" "+c.cssClasses.clear,g.display="",g.minHeight=f.clientHeight+"px",g.minWidth=f.clientWidth+"px",c.mode!==j.inlineMode&&(k.setupContents(),0===n&&f.firstChild&&m.set(0,f.firstChild))),f.placeHolderActive=!0}else f.placeHolderActive&&(f.placeHolderActive=!1,g.display="none",f.className=d(f.className.replace(c.cssClasses.clear,"")),k.setupContents())}},clean:function(b){var c,d,e,f=this.settings,g=f.cssClasses.placeholder,h=(f.attributes||{}).remove||[],i=f.tags||{},j=i.outerLevel||null,k=i.innerLevel||null,l={},m={},n=(i.paragraph||"").toUpperCase(),o=this.html;if(b=b||f.element,null!==j)for(e=0;e<j.length;e++)l[j[e].toUpperCase()]=!0;if(null!==k)for(e=0;e<k.length;e++)m[k[e].toUpperCase()]=!0;this.utils.traverseAll(b,{element:function(b,f,i,p){var q=b.nodeName,r=!0;for(e=0;e<h.length;e++)c=h[e],b.hasAttribute(c)&&b.getAttribute(c)!==g&&b.removeAttribute(c);if((null!==j||null!==k)&&(1===i&&void 0!==l[q]?r=!1:i>1&&void 0!==m[q]&&(r=!1),r))if("block"===a.getComputedStyle(b,null).getPropertyValue("display")){if(n.length>0&&n!==q&&o.changeTag(b,n),i>1)for(;p.childNodes.length>f;)p.parentNode.insertBefore(p.lastChild,p.nextSibling)}else switch(q){case"BR":if(b===b.parentNode.lastChild){if(b===b.parentNode.firstChild)break;d=document.createTextNode(""),d.innerHTML="&nbsp",p.insertBefore(d,b);break}default:for(;null!==b.firstChild;)p.insertBefore(b.firstChild,b);o.deleteNode(b)}}})},lastChild:function(){return this.element.lastChild},addTag:function(a,c,d,e){if(!this.settings.beforeAddTag(a,c,d,e)){var f,g=b.createElement(a);return"undefined"!=typeof d&&d===!1&&(g.contentEditable=!1),0==g.innerHTML.length&&(g.innerHTML=" "),e&&e.nextSibling?(e.parentNode.insertBefore(g,e.nextSibling),f=e.nextSibling):(this.settings.element.appendChild(g),f=this.html.lastChild()),c&&(this.cache.focusedElement=f,this.cursor.set(0,f)),g}return null},baseAtCaret:function(){if(!this.medium.isActive())return null;var b=a.getSelection?a.getSelection():document.selection;if(b.rangeCount){var c=b.getRangeAt(0),d=c.endContainer;switch(d.nodeType){case 3:if(d.data&&d.data.length!=c.endOffset)return!1}return d}return null},getTopLevel:function(a){for(;a&&a.parentNode!==this.element;)a=a.parentNode;return a},atCaret:function(){var a=this.baseAtCaret()||{};this.element;return a===!1?null:(a=this.getTopLevel(a),a&&1==a.nodeType?a:null)},textElementsAtCaret:function(){if(!this.medium.isActive())return null;var b=a.getSelection?a.getSelection():document.selection;if(b.rangeCount){for(var c=b.getRangeAt(0),d=this.getTopLevel(c.startContainer),e=this.getTopLevel(c.endContainer),f=[];;){if(1==d.nodeType&&f.push(d),d===e||!d.nextElementSibling)break;d=d.nextElementSibling}return f}return null}},j.Action=function(){},j.Action.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},listen:function(){var a=this.element,b=this.intercept;this.utils.addEvent(a,"keyup",b.up).addEvent(a,"keydown",b.down).addEvent(a,"focus",b.focus).addEvent(a,"blur",b.blur).addEvent(a,"paste",this.settings.pasteEventHandler)},preserveElementFocus:function(){var c=a.getSelection?a.getSelection().anchorNode:b.activeElement;if(c){var d,e=this.medium.cache,f=this.settings,g=c.parentNode,h=f.element.children,i=g!==e.focusedElement,j=0;for(g===f.element&&(g=c),d=0;d<h.length;d++)if(g===h[d]){j=d;break}i&&(e.focusedElement=g,e.focusedElementIndex=j)}}},j.Cache=function(){this.initialized=!1,this.cmd=!1,this.focusedElement=null},j.Cache.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]}},j.inlineMode="inline",j.partialMode="partial",j.richMode="rich",j.Messages={pastHere:"Paste Here"},j}();"function"==typeof define&&define.amd?define(function(){return d}):"undefined"!=typeof module&&module.exports?module.exports=d:"undefined"!=typeof this&&(this.Medium=d)}.call(this,window,document),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";function b(a){return"string"==typeof a?parseInt(a,10):~~a}var c={wheelSpeed:1,wheelPropagation:!1,swipePropagation:!0,minScrollbarLength:null,maxScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1},d=0,e=function(){var a=d++;return function(b){var c=".perfect-scrollbar-"+a;return"undefined"==typeof b?c:b+c}},f="WebkitAppearance"in document.documentElement.style;a.fn.perfectScrollbar=function(d,g){return this.each(function(){function h(a,c){var d=a+c,e=C-K;L=0>d?0:d>e?e:d;var f=b(L*(E-C)/(C-K));z.scrollTop(f)}function i(a,c){var d=a+c,e=B-G;H=0>d?0:d>e?e:d;var f=b(H*(D-B)/(B-G));z.scrollLeft(f)}function j(a){return y.minScrollbarLength&&(a=Math.max(a,y.minScrollbarLength)),y.maxScrollbarLength&&(a=Math.min(a,y.maxScrollbarLength)),a}function k(){var a={width:I};N?a.left=z.scrollLeft()+B-D:a.left=z.scrollLeft(),T?a.bottom=S-z.scrollTop():a.top=U+z.scrollTop(),Q.css(a);var b={top:z.scrollTop(),height:M};$?N?b.right=D-z.scrollLeft()-Z-Y.outerWidth():b.right=Z-z.scrollLeft():N?b.left=z.scrollLeft()+2*B-D-_-Y.outerWidth():b.left=_+z.scrollLeft(),X.css(b),R.css({left:H,width:G-V}),Y.css({top:L,height:K-aa})}function l(){z.removeClass("ps-active-x"),z.removeClass("ps-active-y"),B=y.includePadding?z.innerWidth():z.width(),C=y.includePadding?z.innerHeight():z.height(),D=z.prop("scrollWidth"),E=z.prop("scrollHeight"),!y.suppressScrollX&&B+y.scrollXMarginOffset<D?(F=!0,I=B-W,G=j(b(I*B/D)),H=b(z.scrollLeft()*(I-G)/(D-B))):(F=!1,G=0,H=0,z.scrollLeft(0)),!y.suppressScrollY&&C+y.scrollYMarginOffset<E?(J=!0,M=C-ba,K=j(b(M*C/E)),L=b(z.scrollTop()*(M-K)/(E-C))):(J=!1,K=0,L=0,z.scrollTop(0)),H>=I-G&&(H=I-G),L>=M-K&&(L=M-K),k(),F&&z.addClass("ps-active-x"),J&&z.addClass("ps-active-y")}function m(){var b,c,d=function(a){i(b,a.pageX-c),l(),a.stopPropagation(),a.preventDefault()},e=function(b){Q.removeClass("in-scrolling"),a(P).unbind(O("mousemove"),d)};R.bind(O("mousedown"),function(f){c=f.pageX,b=R.position().left,Q.addClass("in-scrolling"),a(P).bind(O("mousemove"),d),a(P).one(O("mouseup"),e),f.stopPropagation(),f.preventDefault()}),b=c=null}function n(){var b,c,d=function(a){h(b,a.pageY-c),l(),a.stopPropagation(),a.preventDefault()},e=function(b){X.removeClass("in-scrolling"),a(P).unbind(O("mousemove"),d)};Y.bind(O("mousedown"),function(f){c=f.pageY,b=Y.position().top,X.addClass("in-scrolling"),a(P).bind(O("mousemove"),d),a(P).one(O("mouseup"),e),f.stopPropagation(),f.preventDefault()}),b=c=null}function o(a,b){var c=z.scrollTop();if(0===a){if(!J)return!1;if(0===c&&b>0||c>=E-C&&0>b)return!y.wheelPropagation}var d=z.scrollLeft();if(0===b){if(!F)return!1;if(0===d&&0>a||d>=D-B&&a>0)return!y.wheelPropagation}return!0}function p(a,b){var c=z.scrollTop(),d=z.scrollLeft(),e=Math.abs(a),f=Math.abs(b);if(f>e){if(0>b&&c===E-C||b>0&&0===c)return!y.swipePropagation}else if(e>f&&(0>a&&d===D-B||a>0&&0===d))return!y.swipePropagation;return!0}function q(){function a(a){var b=a.originalEvent.deltaX,c=-1*a.originalEvent.deltaY;return("undefined"==typeof b||"undefined"==typeof c)&&(b=-1*a.originalEvent.wheelDeltaX/6,c=a.originalEvent.wheelDeltaY/6),a.originalEvent.deltaMode&&1===a.originalEvent.deltaMode&&(b*=10,c*=10),b!==b&&c!==c&&(b=0,c=a.originalEvent.wheelDelta),[b,c]}function b(b){if(f||!(z.find("select:focus").length>0)){var d=a(b),e=d[0],g=d[1];c=!1,y.useBothWheelAxes?J&&!F?(g?z.scrollTop(z.scrollTop()-g*y.wheelSpeed):z.scrollTop(z.scrollTop()+e*y.wheelSpeed),c=!0):F&&!J&&(e?z.scrollLeft(z.scrollLeft()+e*y.wheelSpeed):z.scrollLeft(z.scrollLeft()-g*y.wheelSpeed),c=!0):(z.scrollTop(z.scrollTop()-g*y.wheelSpeed),z.scrollLeft(z.scrollLeft()+e*y.wheelSpeed)),l(),c=c||o(e,g),c&&(b.stopPropagation(),b.preventDefault())}}var c=!1;"undefined"!=typeof window.onwheel?z.bind(O("wheel"),b):"undefined"!=typeof window.onmousewheel&&z.bind(O("mousewheel"),b)}function r(){var b=!1;z.bind(O("mouseenter"),function(a){b=!0}),z.bind(O("mouseleave"),function(a){b=!1});var c=!1;a(P).bind(O("keydown"),function(d){if((!d.isDefaultPrevented||!d.isDefaultPrevented())&&b){for(var e=document.activeElement?document.activeElement:P.activeElement;e.shadowRoot;)e=e.shadowRoot.activeElement;if(!a(e).is(":input,[contenteditable]")){var f=0,g=0;switch(d.which){case 37:f=-30;break;case 38:g=30;break;case 39:f=30;break;case 40:g=-30;break;case 33:g=90;break;case 32:case 34:g=-90;break;case 35:g=d.ctrlKey?-E:-C;break;case 36:g=d.ctrlKey?z.scrollTop():C;break;default:return}z.scrollTop(z.scrollTop()-g),z.scrollLeft(z.scrollLeft()+f),c=o(f,g),c&&d.preventDefault()}}})}function s(){function a(a){a.stopPropagation()}Y.bind(O("click"),a),X.bind(O("click"),function(a){var c=b(K/2),d=a.pageY-X.offset().top-c,e=C-K,f=d/e;0>f?f=0:f>1&&(f=1),z.scrollTop((E-C)*f)}),R.bind(O("click"),a),Q.bind(O("click"),function(a){var c=b(G/2),d=a.pageX-Q.offset().left-c,e=B-G,f=d/e;0>f?f=0:f>1&&(f=1),z.scrollLeft((D-B)*f)})}function t(){function b(){var a=window.getSelection?window.getSelection():document.getSlection?document.getSlection():{rangeCount:0};return 0===a.rangeCount?null:a.getRangeAt(0).commonAncestorContainer}function c(){e||(e=setInterval(function(){return A()?(z.scrollTop(z.scrollTop()+f.top),z.scrollLeft(z.scrollLeft()+f.left),void l()):void clearInterval(e)},50))}function d(){e&&(clearInterval(e),e=null),Q.removeClass("in-scrolling"),X.removeClass("in-scrolling")}var e=null,f={top:0,left:0},g=!1;a(P).bind(O("selectionchange"),function(c){a.contains(z[0],b())?g=!0:(g=!1,d())}),a(window).bind(O("mouseup"),function(a){g&&(g=!1,d())}),a(window).bind(O("mousemove"),function(a){if(g){var b={x:a.pageX,y:a.pageY},e=z.offset(),h={left:e.left,right:e.left+z.outerWidth(),top:e.top,bottom:e.top+z.outerHeight()};b.x<h.left+3?(f.left=-5,Q.addClass("in-scrolling")):b.x>h.right-3?(f.left=5,Q.addClass("in-scrolling")):f.left=0,b.y<h.top+3?(h.top+3-b.y<5?f.top=-5:f.top=-20,X.addClass("in-scrolling")):b.y>h.bottom-3?(b.y-h.bottom+3<5?f.top=5:f.top=20,X.addClass("in-scrolling")):f.top=0,0===f.top&&0===f.left?d():c()}})}function u(b,c){function d(a,b){z.scrollTop(z.scrollTop()-b),z.scrollLeft(z.scrollLeft()-a),l()}function e(a){r=!0}function f(a){r=!1}function g(a){return a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:a.originalEvent}function h(a){var b=a.originalEvent;return b.targetTouches&&1===b.targetTouches.length?!0:b.pointerType&&"mouse"!==b.pointerType&&b.pointerType!==b.MSPOINTER_TYPE_MOUSE?!0:!1}function i(a){if(h(a)){s=!0;var b=g(a);m.pageX=b.pageX,m.pageY=b.pageY,n=(new Date).getTime(),null!==q&&clearInterval(q),a.stopPropagation()}}function j(a){if(!r&&s&&h(a)){var b=g(a),c={pageX:b.pageX,pageY:b.pageY},e=c.pageX-m.pageX,f=c.pageY-m.pageY;d(e,f),m=c;var i=(new Date).getTime(),j=i-n;j>0&&(o.x=e/j,o.y=f/j,n=i),p(e,f)&&(a.stopPropagation(),a.preventDefault())}}function k(a){!r&&s&&(s=!1,clearInterval(q),q=setInterval(function(){return A()?Math.abs(o.x)<.01&&Math.abs(o.y)<.01?void clearInterval(q):(d(30*o.x,30*o.y),o.x*=.8,void(o.y*=.8)):void clearInterval(q)},10))}var m={},n=0,o={},q=null,r=!1,s=!1;b&&(a(window).bind(O("touchstart"),e),a(window).bind(O("touchend"),f),z.bind(O("touchstart"),i),z.bind(O("touchmove"),j),z.bind(O("touchend"),k)),c&&(window.PointerEvent?(a(window).bind(O("pointerdown"),e),a(window).bind(O("pointerup"),f),z.bind(O("pointerdown"),i),z.bind(O("pointermove"),j),z.bind(O("pointerup"),k)):window.MSPointerEvent&&(a(window).bind(O("MSPointerDown"),e),a(window).bind(O("MSPointerUp"),f),z.bind(O("MSPointerDown"),i),z.bind(O("MSPointerMove"),j),z.bind(O("MSPointerUp"),k)))}function v(){z.bind(O("scroll"),function(a){l()})}function w(){z.unbind(O()),a(window).unbind(O()),a(P).unbind(O()),z.data("perfect-scrollbar",null),z.data("perfect-scrollbar-update",null),z.data("perfect-scrollbar-destroy",null),R.remove(),Y.remove(),Q.remove(),X.remove(),z=Q=X=R=Y=F=J=B=C=D=E=G=H=S=T=U=K=L=Z=$=_=N=O=null}function x(){l(),v(),m(),n(),s(),t(),q(),(ca||da)&&u(ca,da),y.useKeyboard&&r(),z.data("perfect-scrollbar",z),z.data("perfect-scrollbar-update",l),z.data("perfect-scrollbar-destroy",w)}var y=a.extend(!0,{},c),z=a(this),A=function(){return!!z};if("object"==typeof d?a.extend(!0,y,d):g=d,"update"===g)return z.data("perfect-scrollbar-update")&&z.data("perfect-scrollbar-update")(),z;if("destroy"===g)return z.data("perfect-scrollbar-destroy")&&z.data("perfect-scrollbar-destroy")(),z;if(z.data("perfect-scrollbar"))return z.data("perfect-scrollbar");z.addClass("ps-container");var B,C,D,E,F,G,H,I,J,K,L,M,N="rtl"===z.css("direction"),O=e(),P=this.ownerDocument||document,Q=a("<div class='ps-scrollbar-x-rail'>").appendTo(z),R=a("<div class='ps-scrollbar-x'>").appendTo(Q),S=b(Q.css("bottom")),T=S===S,U=T?null:b(Q.css("top")),V=b(Q.css("borderLeftWidth"))+b(Q.css("borderRightWidth")),W=b(Q.css("marginLeft"))+b(Q.css("marginRight")),X=a("<div class='ps-scrollbar-y-rail'>").appendTo(z),Y=a("<div class='ps-scrollbar-y'>").appendTo(X),Z=b(X.css("right")),$=Z===Z,_=$?null:b(X.css("left")),aa=b(X.css("borderTopWidth"))+b(X.css("borderBottomWidth")),ba=b(X.css("marginTop"))+b(X.css("marginBottom")),ca="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,da=null!==window.navigator.msMaxTouchPoints;return x(),z})}}),function(a,b){function c(){function c(b){var c=b||a.event,d=c.keyCode||c.which;if(-1!==[9,13,32,27].indexOf(d)){for(var e=c.target||c.srcElement,f=-1,g=0;g<y.length;g++)if(e===y[g]){f=g;break}9===d?(e=-1===f?w:f===y.length-1?y[0]:y[f+1],I(c),e.focus(),h(e,l.confirmButtonColor)):(e=13===d||32===d?-1===f?w:void 0:27!==d||x.hidden||"none"===x.style.display?void 0:x,void 0!==e&&H(e,c))}}function g(b){var c=b||a.event,d=c.target||c.srcElement,e=c.relatedTarget,f=v(p,"visible");if(f){var g=-1;if(null!==e){for(var h=0;h<y.length;h++)if(e===y[h]){g=h;break}-1===g&&d.focus()}else o=d}}if(void 0===arguments[0])return a.console.error("sweetAlert expects at least 1 attribute!"),!1;var l=f({},s);switch(typeof arguments[0]){case"string":l.title=arguments[0],l.text=arguments[1]||"",l.type=arguments[2]||"";break;case"object":if(void 0===arguments[0].title)return a.console.error('Missing "title" argument!'),!1;l.title=arguments[0].title,l.text=arguments[0].text||s.text,l.type=arguments[0].type||s.type,l.customClass=arguments[0].customClass||l.customClass,l.allowOutsideClick=arguments[0].allowOutsideClick||s.allowOutsideClick,l.showCancelButton=void 0!==arguments[0].showCancelButton?arguments[0].showCancelButton:s.showCancelButton,l.closeOnConfirm=void 0!==arguments[0].closeOnConfirm?arguments[0].closeOnConfirm:s.closeOnConfirm,l.closeOnCancel=void 0!==arguments[0].closeOnCancel?arguments[0].closeOnCancel:s.closeOnCancel,l.timer=arguments[0].timer||s.timer,l.confirmButtonText=s.showCancelButton?"Confirm":s.confirmButtonText,l.confirmButtonText=arguments[0].confirmButtonText||s.confirmButtonText,l.confirmButtonColor=arguments[0].confirmButtonColor||s.confirmButtonColor,l.cancelButtonText=arguments[0].cancelButtonText||s.cancelButtonText,l.imageUrl=arguments[0].imageUrl||s.imageUrl,l.imageSize=arguments[0].imageSize||s.imageSize,l.doneFunction=arguments[1]||null;break;default:return a.console.error('Unexpected type of argument! Expected "string" or "object", got '+typeof arguments[0]),!1}d(l),k(),i();for(var p=t(),q=function(b){var c=b||a.event,d=c.target||c.srcElement,f="confirm"===d.className,g=v(p,"visible"),h=l.doneFunction&&"true"===p.getAttribute("data-has-done-function");switch(c.type){case"mouseover":f&&(d.style.backgroundColor=e(l.confirmButtonColor,-.04));break;case"mouseout":f&&(d.style.backgroundColor=l.confirmButtonColor);break;case"mousedown":f&&(d.style.backgroundColor=e(l.confirmButtonColor,-.14));break;case"mouseup":f&&(d.style.backgroundColor=e(l.confirmButtonColor,-.04));break;case"focus":var i=p.querySelector("button.confirm"),k=p.querySelector("button.cancel");f?k.style.boxShadow="none":i.style.boxShadow="none";break;case"click":if(f&&h&&g)l.doneFunction(!0),l.closeOnConfirm&&j();else if(h&&g){var m=String(l.doneFunction).replace(/\s/g,""),n="function("===m.substring(0,9)&&")"!==m.substring(9,10);n&&l.doneFunction(!1),l.closeOnCancel&&j()}else j()}},r=p.querySelectorAll("button"),u=0;u<r.length;u++)r[u].onclick=q,r[u].onmouseover=q,r[u].onmouseout=q,r[u].onmousedown=q,r[u].onfocus=q;m=b.onclick,
b.onclick=function(b){var c=b||a.event,d=c.target||c.srcElement,e=p===d,f=D(p,d),g=v(p,"visible"),h="true"===p.getAttribute("data-allow-ouside-click");!e&&!f&&g&&h&&j()};var w=p.querySelector("button.confirm"),x=p.querySelector("button.cancel"),y=p.querySelectorAll("button:not([type=hidden])");n=a.onkeydown,a.onkeydown=c,w.onblur=g,x.onblur=g,a.onfocus=function(){a.setTimeout(function(){void 0!==o&&(o.focus(),o=void 0)},0)}}function d(b){var c=t(),d=c.querySelector("h2"),e=c.querySelector("p"),f=c.querySelector("button.cancel"),g=c.querySelector("button.confirm");if(d.innerHTML=y(b.title).split("\n").join("<br>"),e.innerHTML=y(b.text||"").split("\n").join("<br>"),b.text&&A(e),b.customClass&&w(c,b.customClass),C(c.querySelectorAll(".icon")),b.type){for(var i=!1,j=0;j<r.length;j++)if(b.type===r[j]){i=!0;break}if(!i)return a.console.error("Unknown alert type: "+b.type),!1;var k=c.querySelector(".icon."+b.type);switch(A(k),b.type){case"success":w(k,"animate"),w(k.querySelector(".tip"),"animateSuccessTip"),w(k.querySelector(".long"),"animateSuccessLong");break;case"error":w(k,"animateErrorIcon"),w(k.querySelector(".x-mark"),"animateXMark");break;case"warning":w(k,"pulseWarning"),w(k.querySelector(".body"),"pulseWarningIns"),w(k.querySelector(".dot"),"pulseWarningIns")}}if(b.imageUrl){var l=c.querySelector(".icon.custom");l.style.backgroundImage="url("+b.imageUrl+")",A(l);var m=80,n=80;if(b.imageSize){var o=b.imageSize.split("x")[0],p=b.imageSize.split("x")[1];o&&p?(m=o,n=p,l.css({width:o+"px",height:p+"px"})):a.console.error("Parameter imageSize expects value with format WIDTHxHEIGHT, got "+b.imageSize)}l.setAttribute("style",l.getAttribute("style")+"width:"+m+"px; height:"+n+"px")}c.setAttribute("data-has-cancel-button",b.showCancelButton),b.showCancelButton?f.style.display="inline-block":C(f),b.cancelButtonText&&(f.innerHTML=y(b.cancelButtonText)),b.confirmButtonText&&(g.innerHTML=y(b.confirmButtonText)),g.style.backgroundColor=b.confirmButtonColor,h(g,b.confirmButtonColor),c.setAttribute("data-allow-ouside-click",b.allowOutsideClick);var q=b.doneFunction?!0:!1;c.setAttribute("data-has-done-function",q),c.setAttribute("data-timer",b.timer)}function e(a,b){a=String(a).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),b=b||0;var c,d,e="#";for(d=0;3>d;d++)c=parseInt(a.substr(2*d,2),16),c=Math.round(Math.min(Math.max(0,c+c*b),255)).toString(16),e+=("00"+c).substr(c.length);return e}function f(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function g(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?parseInt(b[1],16)+", "+parseInt(b[2],16)+", "+parseInt(b[3],16):null}function h(a,b){var c=g(b);a.style.boxShadow="0 0 2px rgba("+c+", 0.8), inset 0 0 0 1px rgba(0, 0, 0, 0.05)"}function i(){var a=t();F(u(),10),A(a),w(a,"showSweetAlert"),x(a,"hideSweetAlert"),l=b.activeElement;var c=a.querySelector("button.confirm");c.focus(),setTimeout(function(){w(a,"visible")},500);var d=a.getAttribute("data-timer");"null"!==d&&""!==d&&(a.timeout=setTimeout(function(){j()},d))}function j(){var c=t();G(u(),5),G(c,5),x(c,"showSweetAlert"),w(c,"hideSweetAlert"),x(c,"visible");var d=c.querySelector(".icon.success");x(d,"animate"),x(d.querySelector(".tip"),"animateSuccessTip"),x(d.querySelector(".long"),"animateSuccessLong");var e=c.querySelector(".icon.error");x(e,"animateErrorIcon"),x(e.querySelector(".x-mark"),"animateXMark");var f=c.querySelector(".icon.warning");x(f,"pulseWarning"),x(f.querySelector(".body"),"pulseWarningIns"),x(f.querySelector(".dot"),"pulseWarningIns"),a.onkeydown=n,b.onclick=m,l&&l.focus(),o=void 0,clearTimeout(c.timeout)}function k(){var a=t();a.style.marginTop=E(t())}var l,m,n,o,p=".sweet-alert",q=".sweet-overlay",r=["error","warning","info","success"],s={title:"",text:"",type:null,allowOutsideClick:!1,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",confirmButtonColor:"#AEDEF4",cancelButtonText:"Cancel",imageUrl:null,imageSize:null,timer:null},t=function(){return b.querySelector(p)},u=function(){return b.querySelector(q)},v=function(a,b){return new RegExp(" "+b+" ").test(" "+a.className+" ")},w=function(a,b){v(a,b)||(a.className+=" "+b)},x=function(a,b){var c=" "+a.className.replace(/[\t\r\n]/g," ")+" ";if(v(a,b)){for(;c.indexOf(" "+b+" ")>=0;)c=c.replace(" "+b+" "," ");a.className=c.replace(/^\s+|\s+$/g,"")}},y=function(a){var c=b.createElement("div");return c.appendChild(b.createTextNode(a)),c.innerHTML},z=function(a){a.style.opacity="",a.style.display="block"},A=function(a){if(a&&!a.length)return z(a);for(var b=0;b<a.length;++b)z(a[b])},B=function(a){a.style.opacity="",a.style.display="none"},C=function(a){if(a&&!a.length)return B(a);for(var b=0;b<a.length;++b)B(a[b])},D=function(a,b){for(var c=b.parentNode;null!==c;){if(c===a)return!0;c=c.parentNode}return!1},E=function(a){a.style.left="-9999px",a.style.display="block";var b,c=a.clientHeight;return b="undefined"!=typeof getComputedStyle?parseInt(getComputedStyle(a).getPropertyValue("padding"),10):parseInt(a.currentStyle.padding),a.style.left="",a.style.display="none","-"+parseInt(c/2+b)+"px"},F=function(a,b){if(+a.style.opacity<1){b=b||16,a.style.opacity=0,a.style.display="block";var c=+new Date,d=function(){a.style.opacity=+a.style.opacity+(new Date-c)/100,c=+new Date,+a.style.opacity<1&&setTimeout(d,b)};d()}a.style.display="block"},G=function(a,b){b=b||16,a.style.opacity=1;var c=+new Date,d=function(){a.style.opacity=+a.style.opacity-(new Date-c)/100,c=+new Date,+a.style.opacity>0?setTimeout(d,b):a.style.display="none"};d()},H=function(c){if(MouseEvent){var d=new MouseEvent("click",{view:a,bubbles:!1,cancelable:!0});c.dispatchEvent(d)}else if(b.createEvent){var e=b.createEvent("MouseEvents");e.initEvent("click",!1,!1),c.dispatchEvent(e)}else b.createEventObject?c.fireEvent("onclick"):"function"==typeof c.onclick&&c.onclick()},I=function(b){"function"==typeof b.stopPropagation?(b.stopPropagation(),b.preventDefault()):a.event&&a.event.hasOwnProperty("cancelBubble")&&(a.event.cancelBubble=!0)};a.sweetAlertInitialize=function(){var a='<div class="sweet-overlay" tabIndex="-1"></div><div class="sweet-alert" tabIndex="-1"><div class="icon error"><span class="x-mark"><span class="line left"></span><span class="line right"></span></span></div><div class="icon warning"> <span class="body"></span> <span class="dot"></span> </div> <div class="icon info"></div> <div class="icon success"> <span class="line tip"></span> <span class="line long"></span> <div class="placeholder"></div> <div class="fix"></div> </div> <div class="icon custom"></div> <h2>Title</h2><p>Text</p><button class="cancel" tabIndex="2">Cancel</button><button class="confirm" tabIndex="1">OK</button></div>',c=b.createElement("div");c.innerHTML=a,b.body.appendChild(c)},a.sweetAlert=a.swal=function(){var a=arguments;if(null!==t())c.apply(this,a);else var b=setInterval(function(){null!==t()&&(clearInterval(b),c.apply(this,a))},100)},a.swal.setDefaults=function(a){if(!a)throw new Error("userParams is required");if("object"!=typeof a)throw new Error("userParams has to be a object");f(s,a)},function(){"complete"===b.readyState||"interactive"===b.readyState&&b.body?a.sweetAlertInitialize():b.addEventListener?b.addEventListener("DOMContentLoaded",function(){b.removeEventListener("DOMContentLoaded",arguments.callee,!1),a.sweetAlertInitialize()},!1):b.attachEvent&&b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&(b.detachEvent("onreadystatechange",arguments.callee),a.sweetAlertInitialize())})}()}(window,document),function(a,b,c,d){function e(b,c){this.options=a.extend(!0,{},f,c),this.input=b,this.$input=a(b),this._defaults=f,this._name="geocomplete",this.init()}var f={bounds:!0,country:null,map:!1,details:!1,detailsAttribute:"name",autoselect:!0,location:!1,mapOptions:{zoom:14,scrollwheel:!1,mapTypeId:"roadmap"},markerOptions:{draggable:!1},maxZoom:16,types:["geocode"],blur:!1},g="street_address route intersection political country administrative_area_level_1 administrative_area_level_2 administrative_area_level_3 colloquial_area locality sublocality neighborhood premise subpremise postal_code natural_feature airport park point_of_interest post_box street_number floor room lat lng viewport location formatted_address location_type bounds".split(" "),h="id place_id url website vicinity reference name rating international_phone_number icon formatted_phone_number".split(" ");a.extend(e.prototype,{init:function(){this.initMap(),this.initMarker(),this.initGeocoder(),this.initDetails(),this.initLocation()},initMap:function(){if(this.options.map){if("function"==typeof this.options.map.setCenter)return void(this.map=this.options.map);this.map=new google.maps.Map(a(this.options.map)[0],this.options.mapOptions),google.maps.event.addListener(this.map,"click",a.proxy(this.mapClicked,this)),google.maps.event.addListener(this.map,"zoom_changed",a.proxy(this.mapZoomed,this))}},initMarker:function(){if(this.map){var b=a.extend(this.options.markerOptions,{map:this.map});b.disabled||(this.marker=new google.maps.Marker(b),google.maps.event.addListener(this.marker,"dragend",a.proxy(this.markerDragged,this)))}},initGeocoder:function(){var b={types:this.options.types,bounds:this.options.bounds===!0?null:this.options.bounds,componentRestrictions:this.options.componentRestrictions};this.options.country&&(b.componentRestrictions={country:this.options.country}),this.autocomplete=new google.maps.places.Autocomplete(this.input,b),this.geocoder=new google.maps.Geocoder,this.map&&this.options.bounds===!0&&this.autocomplete.bindTo("bounds",this.map),google.maps.event.addListener(this.autocomplete,"place_changed",a.proxy(this.placeChanged,this)),this.$input.keypress(function(a){return 13===a.keyCode?!1:void 0}),this.$input.bind("geocode",a.proxy(function(){this.find()},this)),this.options.blur===!0&&this.$input.blur(a.proxy(function(){this.find()},this))},initDetails:function(){function b(a){e[a]=c.find("["+d+"="+a+"]")}if(this.options.details){var c=a(this.options.details),d=this.options.detailsAttribute,e={};a.each(g,function(a,c){b(c),b(c+"_short")}),a.each(h,function(a,c){b(c)}),this.$details=c,this.details=e}},initLocation:function(){var a,b=this.options.location;if(b){if("string"==typeof b)return void this.find(b);b instanceof Array&&(a=new google.maps.LatLng(b[0],b[1])),b instanceof google.maps.LatLng&&(a=b),a&&(this.map&&this.map.setCenter(a),this.marker&&this.marker.setPosition(a))}},find:function(a){this.geocode({address:a||this.$input.val()})},geocode:function(b){this.options.bounds&&!b.bounds&&(this.options.bounds===!0?b.bounds=this.map&&this.map.getBounds():b.bounds=this.options.bounds),this.options.country&&(b.region=this.options.country),this.geocoder.geocode(b,a.proxy(this.handleGeocode,this))},selectFirstResult:function(){var b="";a(".pac-item-selected")[0]&&(b="-selected");var c=a(".pac-container .pac-item"+b+":first span:nth-child(2)").text(),d=a(".pac-container .pac-item"+b+":first span:nth-child(3)").text(),e=c;return d&&(e+=" - "+d),this.$input.val(e),e},handleGeocode:function(a,b){if(b===google.maps.GeocoderStatus.OK){var c=a[0];this.$input.val(c.formatted_address),this.update(c),a.length>1&&this.trigger("geocode:multiple",a)}else this.trigger("geocode:error",b)},trigger:function(a,b){this.$input.trigger(a,[b])},center:function(a){a.viewport?(this.map.fitBounds(a.viewport),this.map.getZoom()>this.options.maxZoom&&this.map.setZoom(this.options.maxZoom)):(this.map.setZoom(this.options.maxZoom),this.map.setCenter(a.location)),this.marker&&(this.marker.setPosition(a.location),this.marker.setAnimation(this.options.markerOptions.animation))},update:function(a){this.map&&this.center(a.geometry),this.$details&&this.fillDetails(a),this.trigger("geocode:result",a)},fillDetails:function(b){var c={},d=b.geometry,e=d.viewport,f=d.bounds;a.each(b.address_components,function(b,d){d.types[0];a.each(d.types,function(a,b){c[b]=d.long_name,c[b+"_short"]=d.short_name})}),a.each(h,function(a,d){c[d]=b[d]}),a.extend(c,{formatted_address:b.formatted_address,location_type:d.location_type||"PLACES",viewport:e,bounds:f,location:d.location,lat:d.location.lat(),lng:d.location.lng()}),a.each(this.details,a.proxy(function(a,b){var d=c[a];this.setDetail(b,d)},this)),this.data=c},setDetail:function(a,b){b===d?b="":"function"==typeof b.toUrlValue&&(b=b.toUrlValue()),a.is(":input")?a.val(b):a.text(b)},markerDragged:function(a){this.trigger("geocode:dragged",a.latLng)},mapClicked:function(a){this.trigger("geocode:click",a.latLng)},mapZoomed:function(a){this.trigger("geocode:zoom",this.map.getZoom())},resetMarker:function(){this.marker.setPosition(this.data.location),this.setDetail(this.details.lat,this.data.location.lat()),this.setDetail(this.details.lng,this.data.location.lng())},placeChanged:function(){var a=this.autocomplete.getPlace();if(a&&a.geometry)this.update(a);else if(this.options.autoselect){var b=this.selectFirstResult();this.find(b)}}}),a.fn.geocomplete=function(b){var c="plugin_geocomplete";if("string"==typeof b){var d=a(this).data(c)||a(this).geocomplete().data(c),f=d[b];return"function"==typeof f?(f.apply(d,Array.prototype.slice.call(arguments,1)),a(this)):(2==arguments.length&&(f=arguments[1]),f)}return this.each(function(){var d=a.data(this,c);d||(d=new e(this,b),a.data(this,c,d))})}}(jQuery,window,document),function(){function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;d.getListeners=function(a){var b,c,d=this._getEvents();if("object"==typeof a){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if("object"===c)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:this.EventEmitter=a}.call(this),function(a){function b(b){var c=a.event;return c.target=c.target||c.srcElement||b,c}var c=document.documentElement,d=function(){};c.addEventListener?d=function(a,b,c){a.addEventListener(b,c,!1)}:c.attachEvent&&(d=function(a,c,d){a[c+d]=d.handleEvent?function(){var c=b(a);d.handleEvent.call(d,c)}:function(){var c=b(a);d.call(a,c)},a.attachEvent("on"+c,a[c+d])});var e=function(){};c.removeEventListener?e=function(a,b,c){a.removeEventListener(b,c,!1)}:c.detachEvent&&(e=function(a,b,c){a.detachEvent("on"+b,a[b+c]);try{delete a[b+c]}catch(d){a[b+c]=void 0}});var f={bind:d,unbind:e};"function"==typeof define&&define.amd?define("eventie/eventie",f):a.eventie=f}(this),function(a,b){"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(c,d){return b(a,c,d)}):"object"==typeof exports?module.exports=b(a,require("wolfy87-eventemitter"),require("eventie")):a.imagesLoaded=b(a,a.EventEmitter,a.eventie)}(window,function(a,b,c){function d(a,b){for(var c in b)a[c]=b[c];return a}function e(a){return"[object Array]"===m.call(a)}function f(a){var b=[];if(e(a))b=a;else if("number"==typeof a.length)for(var c=0,d=a.length;d>c;c++)b.push(a[c]);else b.push(a);return b}function g(a,b,c){if(!(this instanceof g))return new g(a,b);"string"==typeof a&&(a=document.querySelectorAll(a)),this.elements=f(a),this.options=d({},this.options),"function"==typeof b?c=b:d(this.options,b),c&&this.on("always",c),this.getImages(),j&&(this.jqDeferred=new j.Deferred);var e=this;setTimeout(function(){e.check()})}function h(a){this.img=a}function i(a){this.src=a,n[a]=this}var j=a.jQuery,k=a.console,l="undefined"!=typeof k,m=Object.prototype.toString;g.prototype=new b,g.prototype.options={},g.prototype.getImages=function(){this.images=[];for(var a=0,b=this.elements.length;b>a;a++){var c=this.elements[a];"IMG"===c.nodeName&&this.addImage(c);var d=c.nodeType;if(d&&(1===d||9===d||11===d))for(var e=c.querySelectorAll("img"),f=0,g=e.length;g>f;f++){var h=e[f];this.addImage(h)}}},g.prototype.addImage=function(a){var b=new h(a);this.images.push(b)},g.prototype.check=function(){function a(a,e){return b.options.debug&&l&&k.log("confirm",a,e),b.progress(a),c++,c===d&&b.complete(),!0}var b=this,c=0,d=this.images.length;if(this.hasAnyBroken=!1,!d)return void this.complete();for(var e=0;d>e;e++){var f=this.images[e];f.on("confirm",a),f.check()}},g.prototype.progress=function(a){this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;var b=this;setTimeout(function(){b.emit("progress",b,a),b.jqDeferred&&b.jqDeferred.notify&&b.jqDeferred.notify(b,a)})},g.prototype.complete=function(){var a=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var b=this;setTimeout(function(){if(b.emit(a,b),b.emit("always",b),b.jqDeferred){var c=b.hasAnyBroken?"reject":"resolve";b.jqDeferred[c](b)}})},j&&(j.fn.imagesLoaded=function(a,b){var c=new g(this,a,b);return c.jqDeferred.promise(j(this))}),h.prototype=new b,h.prototype.check=function(){var a=n[this.img.src]||new i(this.img.src);if(a.isConfirmed)return void this.confirm(a.isLoaded,"cached was confirmed");if(this.img.complete&&void 0!==this.img.naturalWidth)return void this.confirm(0!==this.img.naturalWidth,"naturalWidth");var b=this;a.on("confirm",function(a,c){return b.confirm(a.isLoaded,c),!0}),a.check()},h.prototype.confirm=function(a,b){this.isLoaded=a,this.emit("confirm",this,b)};var n={};return i.prototype=new b,i.prototype.check=function(){if(!this.isChecked){var a=new Image;c.bind(a,"load",this),c.bind(a,"error",this),a.src=this.src,this.isChecked=!0}},i.prototype.handleEvent=function(a){var b="on"+a.type;this[b]&&this[b](a)},i.prototype.onload=function(a){this.confirm(!0,"onload"),this.unbindProxyEvents(a)},i.prototype.onerror=function(a){this.confirm(!1,"onerror"),this.unbindProxyEvents(a)},i.prototype.confirm=function(a,b){this.isConfirmed=!0,this.isLoaded=a,this.emit("confirm",this,b)},i.prototype.unbindProxyEvents=function(a){c.unbind(a.target,"load",this),c.unbind(a.target,"error",this)},g}),function(a,b){if(!a)return b;var c=function(){this.el=b,this.items=b,this.sizes=[],this.max=[0,0],this.current=0,this.interval=b,this.opts={speed:500,delay:3e3,complete:b,keys:!b,dots:b,fluid:b};var c=this;this.init=function(b,c){return this.el=b,this.ul=b.children("ul"),this.max=[b.outerWidth(),b.outerHeight()],this.items=this.ul.children("li").each(this.calculate),this.opts=a.extend(this.opts,c),this.setup(),this},this.calculate=function(b){var d=a(this),e=d.outerWidth(),f=d.outerHeight();c.sizes[b]=[e,f],e>c.max[0]&&(c.max[0]=e),f>c.max[1]&&(c.max[1]=f)},this.setup=function(){if(this.el.css({overflow:"hidden",width:c.max[0],height:this.items.first().outerHeight()}),this.ul.css({width:100*this.items.length+"%",position:"relative"}),this.items.css("width",100/this.items.length+"%"),this.opts.delay!==b&&(this.start(),this.el.hover(this.stop,this.start)),this.opts.keys&&a(document).keydown(this.keys),this.opts.dots&&this.dots(),this.opts.fluid){var d=function(){c.el.css("width",Math.min(Math.round(c.el.outerWidth()/c.el.parent().outerWidth()*100),100)+"%")};d(),a(window).resize(d)}this.opts.arrows&&this.el.parent().append('<p class="arrows"><span class="prev">â†</span><span class="next">â†’</span></p>').find(".arrows span").click(function(){a.isFunction(c[this.className])&&c[this.className]()}),a.event.swipe&&this.el.on("swipeleft",c.prev).on("swiperight",c.next)},this.move=function(b,d){this.items.eq(b).length||(b=0),0>b&&(b=this.items.length-1);var e=this.items.eq(b),f={height:e.outerHeight()},g=d?5:this.opts.speed;this.ul.is(":animated")||(c.el.find(".dot:eq("+b+")").addClass("active").siblings().removeClass("active"),this.el.animate(f,g)&&this.ul.animate(a.extend({left:"-"+b+"00%"},f),g,function(e){c.current=b,a.isFunction(c.opts.complete)&&!d&&c.opts.complete(c.el)}))},this.start=function(){c.interval=setInterval(function(){c.move(c.current+1)},c.opts.delay)},this.stop=function(){return c.interval=clearInterval(c.interval),c},this.keys=function(b){var d=b.which,e={37:c.prev,39:c.next,27:c.stop};a.isFunction(e[d])&&e[d]()},this.next=function(){return c.stop().move(c.current+1)},this.prev=function(){return c.stop().move(c.current-1)},this.dots=function(){var b='<ol class="dots">';a.each(this.items,function(a){b+='<li class="dot'+(1>a?" active":"")+'">'+(a+1)+"</li>"}),b+="</ol>",this.el.addClass("has-dots").append(b).find(".dot").click(function(){c.move(a(this).index())})}};a.fn.unslider=function(b){var d=this.length;return this.each(function(e){var f=a(this),g=(new c).init(f,b);f.data("unslider"+(d>1?"-"+(e+1):""),g)})}}(window.jQuery,!1),function(a){function b(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,d=a.ui.mouse.prototype,e=d._mouseInit,f=d._mouseDestroy;d._touchStart=function(a){var d=this;!c&&d._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,d._touchMoved=!1,b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))},d._touchMove=function(a){c&&(this._touchMoved=!0,b(a,"mousemove"))},d._touchEnd=function(a){c&&(b(a,"mouseup"),b(a,"mouseout"),this._touchMoved||b(a,"click"),c=!1)},d._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),e.call(b)},d._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),f.call(b)}}}(jQuery),function(a){a.widget("ui.tagit",{options:{allowDuplicates:!1,caseSensitive:!0,fieldName:"tags",placeholderText:null,readOnly:!1,removeConfirmation:!1,tagLimit:null,availableTags:[],autocomplete:{},showAutocompleteOnFocus:!0,allowSpaces:!1,singleField:!1,singleFieldDelimiter:",",singleFieldNode:null,animate:!0,tabIndex:null,beforeTagAdded:null,afterTagAdded:null,beforeTagRemoved:null,afterTagRemoved:null,onTagClicked:null,onTagLimitExceeded:null,onTagAdded:null,onTagRemoved:null,tagSource:null},_create:function(){var b=this;this.element.is("input")?(this.tagList=a("<ul></ul>").insertAfter(this.element),this.options.singleField=!0,this.options.singleFieldNode=this.element,this.element.addClass("tagit-hidden-field")):this.tagList=this.element.find("ul, ol").andSelf().last(),this.tagInput=a('<input type="text" />').addClass("ui-widget-content"),this.options.readOnly&&this.tagInput.attr("disabled","disabled"),this.options.tabIndex&&this.tagInput.attr("tabindex",this.options.tabIndex),this.options.placeholderText&&this.tagInput.attr("placeholder",this.options.placeholderText),this.options.autocomplete.source||(this.options.autocomplete.source=function(b,c){var d=b.term.toLowerCase(),e=a.grep(this.options.availableTags.split(","),function(a){return 0===a.toLowerCase().indexOf(d)});this.options.allowDuplicates||(e=this._subtractArray(e,this.assignedTags())),c(e)}),this.options.showAutocompleteOnFocus&&(this.tagInput.focus(function(a,c){b._showAutocomplete()}),"undefined"==typeof this.options.autocomplete.minLength&&(this.options.autocomplete.minLength=0)),a.isFunction(this.options.autocomplete.source)&&(this.options.autocomplete.source=a.proxy(this.options.autocomplete.source,this)),a.isFunction(this.options.tagSource)&&(this.options.tagSource=a.proxy(this.options.tagSource,this)),this.tagList.addClass("tagit").addClass("ui-widget ui-widget-content ui-corner-all").append(a('<li class="tagit-new"></li>').append(this.tagInput)).click(function(c){var d=a(c.target);if(d.hasClass("tagit-label")){var e=d.closest(".tagit-choice");e.hasClass("removed")||b._trigger("onTagClicked",c,{tag:e,tagLabel:b.tagLabel(e)})}else b.tagInput.focus()});var c=!1;if(this.options.singleField)if(this.options.singleFieldNode){var d=a(this.options.singleFieldNode),e=d.val().split(this.options.singleFieldDelimiter);d.val(""),a.each(e,function(a,d){b.createTag(d,null,!0),c=!0})}else this.options.singleFieldNode=a('<input type="hidden" style="display:none;" value="" name="'+this.options.fieldName+'" />'),this.tagList.after(this.options.singleFieldNode);if(c||this.tagList.children("li").each(function(){a(this).hasClass("tagit-new")||(b.createTag(a(this).text(),a(this).attr("class"),!0),a(this).remove())}),this.tagInput.keydown(function(c){if(c.which==a.ui.keyCode.BACKSPACE&&""===b.tagInput.val()){var d=b._lastTag();!b.options.removeConfirmation||d.hasClass("remove")?b.removeTag(d):b.options.removeConfirmation&&d.addClass("remove ui-state-highlight")}else b.options.removeConfirmation&&b._lastTag().removeClass("remove ui-state-highlight");(c.which===a.ui.keyCode.COMMA&&c.shiftKey===!1||c.which===a.ui.keyCode.ENTER||c.which==a.ui.keyCode.TAB&&""!==b.tagInput.val()||c.which==a.ui.keyCode.SPACE&&b.options.allowSpaces!==!0&&('"'!=a.trim(b.tagInput.val()).replace(/^s*/,"").charAt(0)||'"'==a.trim(b.tagInput.val()).charAt(0)&&'"'==a.trim(b.tagInput.val()).charAt(a.trim(b.tagInput.val()).length-1)&&a.trim(b.tagInput.val()).length-1!==0))&&((c.which!==a.ui.keyCode.ENTER||""!==b.tagInput.val())&&c.preventDefault(),b.options.autocomplete.autoFocus&&b.tagInput.data("autocomplete-open")||(b.tagInput.autocomplete("close"),b.createTag(b._cleanedInput())))}).blur(function(a){b.tagInput.data("autocomplete-open")||b.createTag(b._cleanedInput())}),this.options.availableTags||this.options.tagSource||this.options.autocomplete.source){var f={select:function(a,c){return b.createTag(c.item.value),!1}};a.extend(f,this.options.autocomplete),f.source=this.options.tagSource||f.source,this.tagInput.autocomplete(f).bind("autocompleteopen.tagit",function(a,c){b.tagInput.data("autocomplete-open",!0)}).bind("autocompleteclose.tagit",function(a,c){b.tagInput.data("autocomplete-open",!1)}),this.tagInput.autocomplete("widget").addClass("tagit-autocomplete")}},destroy:function(){return a.Widget.prototype.destroy.call(this),this.element.unbind(".tagit"),this.tagList.unbind(".tagit"),this.tagInput.removeData("autocomplete-open"),this.tagList.removeClass(["tagit","ui-widget","ui-widget-content","ui-corner-all","tagit-hidden-field"].join(" ")),this.element.is("input")?(this.element.removeClass("tagit-hidden-field"),this.tagList.remove()):(this.element.children("li").each(function(){a(this).hasClass("tagit-new")?a(this).remove():(a(this).removeClass(["tagit-choice","ui-widget-content","ui-state-default","ui-state-highlight","ui-corner-all","remove","tagit-choice-editable","tagit-choice-read-only"].join(" ")),a(this).text(a(this).children(".tagit-label").text()))}),this.singleFieldNode&&this.singleFieldNode.remove()),this},_cleanedInput:function(){return a.trim(this.tagInput.val().replace(/^"(.*)"$/,"$1"))},_lastTag:function(){return this.tagList.find(".tagit-choice:last:not(.removed)")},_tags:function(){return this.tagList.find(".tagit-choice:not(.removed)")},assignedTags:function(){var b=this,c=[];return this.options.singleField?(c=a(this.options.singleFieldNode).val().split(this.options.singleFieldDelimiter),""===c[0]&&(c=[])):this._tags().each(function(){c.push(b.tagLabel(this))}),c},_updateSingleTagsField:function(b){a(this.options.singleFieldNode).val(b.join(this.options.singleFieldDelimiter)).trigger("change")},_subtractArray:function(b,c){for(var d=[],e=0;e<b.length;e++)-1==a.inArray(b[e],c)&&d.push(b[e]);return d},tagLabel:function(b){return this.options.singleField?a(b).find(".tagit-label:first").text():a(b).find("input:first").val()},_showAutocomplete:function(){this.tagInput.autocomplete("search","")},_findTagByLabel:function(b){var c=this,d=null;return this._tags().each(function(e){return c._formatStr(b)==c._formatStr(c.tagLabel(this))?(d=a(this),!1):void 0}),d},_isNew:function(a){return!this._findTagByLabel(a)},_formatStr:function(b){return this.options.caseSensitive?b:a.trim(b.toLowerCase())},_effectExists:function(b){return Boolean(a.effects&&(a.effects[b]||a.effects.effect&&a.effects.effect[b]))},createTag:function(b,c,d){var e=this;if(b=a.trim(b),this.options.preprocessTag&&(b=this.options.preprocessTag(b)),""===b)return!1;if(!this.options.allowDuplicates&&!this._isNew(b)){var f=this._findTagByLabel(b);return this._trigger("onTagExists",null,{existingTag:f,duringInitialization:d})!==!1&&this._effectExists("highlight")&&f.effect("highlight"),!1}if(this.options.tagLimit&&this._tags().length>=this.options.tagLimit)return this._trigger("onTagLimitExceeded",null,{duringInitialization:d}),!1;var g=a(this.options.onTagClicked?'<a class="tagit-label"></a>':'<span class="tagit-label"></span>').text(b),h=a("<li></li>").addClass("tagit-choice ui-widget-content ui-state-default ui-corner-all").addClass(c).append(g);if(this.options.readOnly)h.addClass("tagit-choice-read-only");else{h.addClass("tagit-choice-editable");var i=a("<span></span>").addClass("ui-icon ui-icon-close"),j=a('<a><span class="text-icon">×</span></a>').addClass("tagit-close").append(i).click(function(a){e.removeTag(h)});h.append(j)}if(!this.options.singleField){var k=g.html();h.append('<input type="hidden" value="'+k+'" name="'+this.options.fieldName+'" class="tagit-hidden-field" />')}if(this._trigger("beforeTagAdded",null,{tag:h,tagLabel:this.tagLabel(h),duringInitialization:d})!==!1){if(this.options.singleField){var l=this.assignedTags();l.push(b),this._updateSingleTagsField(l)}this._trigger("onTagAdded",null,h),this.tagInput.val(""),this.tagInput.parent().before(h),this._trigger("afterTagAdded",null,{tag:h,tagLabel:this.tagLabel(h),duringInitialization:d}),this.options.showAutocompleteOnFocus&&!d&&setTimeout(function(){e._showAutocomplete()},0)}},removeTag:function(b,c){if(c="undefined"==typeof c?this.options.animate:c,b=a(b),this._trigger("onTagRemoved",null,b),this._trigger("beforeTagRemoved",null,{
tag:b,tagLabel:this.tagLabel(b)})!==!1){if(this.options.singleField){var d=this.assignedTags(),e=this.tagLabel(b);d=a.grep(d,function(a){return a!=e}),this._updateSingleTagsField(d)}if(c){b.addClass("removed");var f=this._effectExists("blind")?["blind",{direction:"horizontal"},"fast"]:["fast"],g=this;f.push(function(){b.remove(),g._trigger("afterTagRemoved",null,{tag:b,tagLabel:g.tagLabel(b)})}),b.fadeOut("fast").hide.apply(b,f).dequeue()}else b.remove(),this._trigger("afterTagRemoved",null,{tag:b,tagLabel:this.tagLabel(b)})}},removeTagByLabel:function(a,b){var c=this._findTagByLabel(a);if(!c)throw"No such tag exists with the name '"+a+"'";this.removeTag(c,b)},removeAll:function(){var a=this;this._tags().each(function(b,c){a.removeTag(c,!1)})}})}(jQuery),jQuery(document).ready(function(a){function b(a){if(a)if(window.getSelection){var b=window.getSelection();b.removeAllRanges(),b.addRange(a)}else document.selection&&a.select&&a.select()}var c=lasso_editor.editor,d=lasso_editor.strings,e=lasso_editor.settingsLink,f=lasso_editor.article_object,g=lasso_editor.toolbar,h=lasso_editor.toolbarHeadings,i=lasso_editor.component_sidebar,j=lasso_editor.postid,k=(lasso_editor.component_modal,lasso_editor.components),l=lasso_editor.featImgClass,m=(lasso_editor.featImgNonce,lasso_editor.titleClass),n=lasso_editor.featImgControls,o=lasso_editor.wpImgEdit,p=lasso_editor.handle,q=(lasso_editor.mapFormFooter,lasso_editor.mapLocations),r=lasso_editor.mapZoom,s=lasso_editor.mapStart,t=lasso_editor.objectsNoSave,u=lasso_editor.objectsNonEditable,v=lasso_editor.supportedNoSave;a("#lasso--edit").click(function(w){function x(){var a={action:"editus_lock_post",postid:lasso_editor.postid};jQuery.post(lasso_editor.ajaxurl2,a,function(a){})}function y(a){function b(a){return("0"+parseInt(a).toString(16)).slice(-2)}return a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+b(a[1])+b(a[2])+b(a[3])}function z(a){var b=articleMedium.html.textElementsAtCaret();if(b)for(H=0;H<b.length;H++)b[H].style.textAlign=a;return articleMedium.makeUndoable(),!1}function A(a){return articleMedium.element.contentEditable=!0,article.highlight(),articleMedium.invokeElement(a),articleMedium.makeUndoable(),!1}function B(b){return articleMedium.element.contentEditable=!0,article.highlight(),articleMedium.invokeElement(b),reg=new RegExp("<"+b+' class="lasso-'+b+'">([^<>]*)<\\/'+b+">","i"),a(articleMedium.element).html(function(a,c){return c.replace(reg,"</p><"+b+">$1</"+b+"><p>")}),articleMedium.makeUndoable(),!1}function C(a){var b={action:"editus_do_shortcode",code:a};jQuery.post(lasso_editor.ajaxurl2,b,function(b){return D(b?b:a)})}function D(b){var c,d=window.selRange.startContainer;c=d.localName;var e=a(d);return b=a(b),b.attr("contenteditable","true"),"p"==c?(b.insertAfter(e),e.remove()):(d=d.parentNode,c=d.localName,"p"==c?b.insertAfter(e):articleMedium.insertHtml(b.text())),window.selRange=null,a("#lasso-toolbar--html").removeClass("html--drop-up"),articleMedium.makeUndoable(),!1}function E(){(localStorage.getItem("lasso_backup_"+j)||lasso_editor.dirtyByComponent)&&a(".lasso--controls__right a:not(#lasso--exit)").trigger("click")}function F(){return lasso_editor.intervalID&&window.clearInterval(lasso_editor.intervalID),a("body").hasClass("lasso-sidebar-open")?(a("body").removeClass("lasso-sidebar-open"),void a("#lasso--component__settings").perfectScrollbar("destroy")):(a("body").removeClass("lasso-sidebar-open lasso-editing"),a(".lasso--toolbar_wrap, #lasso--sidebar, #lasso--featImgControls, #lasso--wpimg-edit, #lasso--exit").fadeOut().remove(),a("#lasso--edit").css("opacity",1),a(".lasso--controls__right").css("opacity",0),a(f).attr("id",""),a(".lasso--wpimg__wrap").each(function(){a(this).children().unwrap()}),a("#lasso--map-form").each(function(){var b=a(this);b.find(".lasso-component--controls, .lasso--map-form__footer ").remove(),b.children().unwrap()}),a(m).attr("contenteditable",!1),a(articleMedium.element).find("*").removeAttr("contenteditable"),void articleMedium.destroy())}if(0==a(f).length){for(var G=[".shapely-content",".entry-content",".aesop-entry-content",".novella-entry-content",".post-content",".entry-content-wrapper"],H=0;H<G.length;H++)if(a(G[H]).length>0){f=G[H];break}if(0==a(f).length)return void swal({title:d.warning,type:"info",text:d.missingClass,showCancelButton:!0,cancelButtonText:d.cancelText,confirmButtonColor:"#007aab",confirmButtonText:d.missingConfirm,closeOnConfirm:!1},function(){location.replace(e)})}var I={action:"editus_lock_post",postid:lasso_editor.postid};if(lasso_editor.dontlock=!1,jQuery.post(lasso_editor.ajaxurl2,I,function(a){a?"true"!=a&&(lasso_editor.dontlock=!0):(alert("Error locking the post for edit"),F())}),lasso_editor.dontlock||(lasso_editor.lockIntervalID=window.setInterval(x,12e4)),w.preventDefault(),a("body").toggleClass("lasso-editing"),a(f).attr("id",c),a(g).hide().appendTo("body").fadeIn(300),a(".lasso--controls__right").css("opacity",1),a("#"+c).attr("contenteditable",!0),a("body").append(i),a(l).length>0&&a(l).append(n),a(m).length>0)a(m).attr("contenteditable",!0);else for(var J=[".entry-title-primary",".entry-title",".novella-entry-title"],H=0;H<J.length;H++)if(a(J[H]).length>0){lasso_editor.titleClass=m=J[H],a(m).attr("contenteditable",!0);break}lasso_editor.subtitleClass="";for(var K=[".entry-subtitle",".novella-entry-subtitle"],H=0;H<J.length;H++)if(a(K[H]).length>0){lasso_editor.subtitleClass=K[H],a(K[H]).attr("contenteditable",!0);break}if(a(".scroll-nav__section").each(function(){a(this).children().unwrap()}),a(".lasso--controls__right ").prepend('<a title="Exit Editor" id="lasso--exit" href="#"></a>'),a(".aesop-component").each(function(){if(!a(".lasso-component--toolbar").length>0)if(a(this).hasClass("aesop-map-component")){var b=a(this);b.wrap('<div id="lasso--map-form" class="aesop-component aesop-map-component lasso--map-drag-holder" data-component-type="map" >').before(p)}else a(this).append(p)}),a("[class*='wp-image-']").each(function(){var b=a(this);!a(".lasso--wpimg-edit").length>0&&(b.parent().hasClass("wp-caption")?b.parent().addClass("lasso--wpimg__wrap"):b.wrap('<div data-component-type="wpimg" class="lasso--wpimg__wrap lasso-component">'),b.parent().prepend(o))}),a(".lasso-component:not(.lasso--wpimg__wrap)").each(function(){a(this);!a(".lasso-component--toolbar").length>0&&a(this).append(p)}),article=document.getElementById(c),articleMedium=new Medium({element:article,mode:Medium.richMode,attributes:null,tags:null,placeholder:lasso_editor.strings.justWrite,pasteAsText:!0,cssClasses:{editor:"lasso-editor",pasteHook:"lasso-editor-paste-hook",placeholder:"lasso-editor-placeholder",clear:"lasso-editor-clear"}}),a(u).attr("contenteditable",!1),a(u).attr("readonly",!0),t=t.length?t+","+v:v,lasso_editor.objectsNoSave=t,a(u).length||lasso_editor.showIgnoredItems&&a(t).length||a(v).length?lasso_editor.readOnlyExists=!0:lasso_editor.readOnlyExists=!1,lasso_editor.showIgnoredItems?(a(t).attr("contenteditable",!1),a(t).attr("readonly",!0)):(a(t).remove(),a(v).remove()),lasso_editor.aviaEditor=a(".av_toggle_section,.av_textblock_section").length>0,a("a").attr("contenteditable",!1),lasso_editor.customFields){var M=[];for(var N in lasso_editor.customFields){M.push(lasso_editor.customFields[N]),lasso_editor.cfselector=N;break}lasso_editor.cfselector=M.join(","),(lasso_editor.undeletableExists=a(lasso_editor.cfselector).length>0)&&a(lasso_editor.cfselector).addClass("lasso-undeletable")}if(document.execCommand("defaultParagraphSeparator",!1,"p"),null==articleMedium.element.firstChild){var O=document.createElement("p"),P=document.createTextNode(" ");O.appendChild(P),articleMedium.element.appendChild(O)}articleMedium.cursor.caretToBeginning(articleMedium.element.firstChild),article.highlight=function(){return document.activeElement===article?!1:void article.focus()},lasso_editor.showColor&&(a("#lasso-toolbar--color-pick").iris(),a("#lasso-toolbar--color-pick").iris("color","#f00"),a("#lasso-toolbar--color-pick").css("color","#f00"),a("#lasso-toolbar--color-set").css("color","#f00"),a(window).mousedown(function(){a("#lasso-toolbar--color-pick").iris("hide")}),lasso_editor.isMobile||a(".iris-picker").css({position:"absolute",top:-180}),a("#lasso-toolbar--color-pick").iris({palettes:!0,change:function(b,c){a("#lasso-toolbar--color-pick").css("color",c.color.toString()),a("#lasso-toolbar--color-set").css("color",c.color.toString())}}),a("#lasso-toolbar--color-pick").mousedown(function(b){"lasso-toolbar--color-pick"==b.target.id&&a("#lasso-toolbar--color-pick").iris("toggle"),b.stopPropagation()}),a("#lasso-toolbar--color-set").mousedown(function(){a("#lasso-toolbar--color-pick").iris("hide"),articleMedium.element.contentEditable=!0;var b=y(a("#lasso-toolbar--color-pick").css("color"));return articleMedium.invokeElement("span",{style:"color:"+b+";"}),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),articleMedium.makeUndoable(),!1})),lasso_editor.showAlignment&&(a("#lasso-toolbar--right-align").mousedown(function(){return z("right")}),a("#lasso-toolbar--left-align").mousedown(function(){return z("left")}),a("#lasso-toolbar--center-align").mousedown(function(){return z("center")})),document.getElementById("lasso-toolbar--bold").onmousedown=function(){return A(lasso_editor.boldTag)},document.getElementById("lasso-toolbar--underline").onmousedown=function(){return A("u")},document.getElementById("lasso-toolbar--italic").onmousedown=function(){return A(lasso_editor.iTag)},document.getElementById("lasso-toolbar--strike").onmousedown=function(){return A("strike")},h&&(document.getElementById("lasso-toolbar--h2").onmousedown=function(){return B("h2")},document.getElementById("lasso-toolbar--h3").onmousedown=function(){return B("h3")}),lasso_editor.toolbarHeadingsH4&&(document.getElementById("lasso-toolbar--h4").onmousedown=function(){return B("h4")},document.getElementById("lasso-toolbar--h5").onmousedown=function(){return B("h5")},document.getElementById("lasso-toolbar--h6").onmousedown=function(){return B("h6")}),document.getElementById("lasso-toolbar--link__create").onmousedown=function(){articleMedium.element.contentEditable=!0,article.highlight(),b(window.selRange),a("#aesop-toolbar--link_newtab").is(":checked")?articleMedium.insertHtml('<a class="lasso-link" contenteditable="false" target="_blank" href="'+a("#lasso-toolbar--link__inner").text()+'">'+window.selRange+"</a>"):articleMedium.insertHtml('<a class="lasso-link" contenteditable="false"  href="'+a("#lasso-toolbar--link__inner").text()+'">'+window.selRange+"</a>");var c=window.selRange.startContainer.parentNode,d=c.localName;if("a"==d){var e=a(window.selRange.startContainer.parentNode);e.replaceWith(e[0].innerHTML)}return window.selRange=null,a("#lasso-toolbar--link").removeClass("link--drop-up"),articleMedium.makeUndoable(),!1},document.getElementById("lasso-toolbar--html__insert").onmousedown=function(){articleMedium.element.contentEditable=!0,b(window.selRange);var c=a("#lasso-toolbar--html__inner").text();return-1!=c.indexOf("]")?(C(c),!1):D(c)},lasso_editor.enableAutoSave&&(lasso_editor.intervalID=window.setInterval(E,6e4)),a(document).keyup(function(b){27==b.keyCode&&(a("#lasso-toolbar--link").hasClass("link--drop-up")?a("#lasso-toolbar--link").removeClass("link--drop-up"):a("#lasso-toolbar--html").hasClass("html--drop-up")?a("#lasso-toolbar--html").removeClass("html--drop-up"):F())}),jQuery(document).on("click","#lasso--exit",function(a){a.preventDefault(),articleMedium.dirty?location.reload():F()}),a(document).keydown(function(b){return"115"!=b.which&&"83"!=b.which||!b.ctrlKey&&!b.metaKey?!0:(b.preventDefault(),a(".lasso-editing #lasso--save").trigger("click"),!1)});var Q=function(){!a(".aesop-timeline").length>0&&a("body").append('<div class="aesop-timeline"></div>').addClass("has-timeline"),!a(".aesop-timeline .scroll-nav").length>0&&(a(".aesop-entry-content").scrollNav({sections:".aesop-timeline-stop",arrowKeys:!0,insertTarget:".aesop-timeline",insertLocation:"appendTo",showTopLink:!1,showHeadline:!1,scrollOffset:0}),a(".aesop-timeline-stop").each(function(){var b=a(this).attr("data-title");a(this).text(b).append(p)}))},R=function(){a(".aesop-video-component").fitVids()},S=s?s:[29.76,-95.38],T=r?r:12,U=lasso_editor.mapTileProvider,V=function(){function a(a,b){var c=m(a,b);jQuery('input[name="ase-map-component-start-point"]').remove(),jQuery(".lasso--map-form__footer").append('<input type="hidden" name="ase-map-component-start-point" data-ase="map" value="'+c+'">'),jQuery("#lasso-map-address").val(a+", "+b)}function b(a){jQuery('input[name="ase-map-component-zoom"]').remove(),jQuery(".lasso--map-form__footer").append('<input type="hidden" name="ase-map-component-zoom" data-ase="map" value="'+a+'">')}function c(a){k(a.target)}function d(b){var c=b.target.getCenter();a(f(c.lat),f(c.lng))}function e(a){b(a.target.getZoom())}function f(a){return Math.round(100*a)/100}function g(a){var b,d={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[a.latlng.lat,a.latlng.lng]}};L.geoJson(d,{pointToLayer:function(d,e){return b=L.marker(a.latlng,{title:"Resource Location",alt:"Resource Location",riseOnHover:!0,draggable:!0}).bindPopup("			            	<input type='text' name='ase_marker_text[]' value='Location Title'>			            	<a class='marker-update-button dashicons dashicons-yes'/></a>			            	<a class='marker-delete-button dashicons dashicons-trash'/></a>			            	"),b.on("popupopen",h),b.on("dragend",c),b}}).addTo(p),j(b._leaflet_id,l(a.latlng.lat,a.latlng.lng,"Location Title"))}function h(){var a=this;jQuery(".marker-delete-button:visible").click(function(){jQuery('input[data-marker="'+a._leaflet_id+'"]').remove(),p.removeLayer(a)}),jQuery(".marker-update-button:visible").click(function(b){var c=b.target.previousElementSibling.value,d=l(a._latlng.lat,a._latlng.lng,c);jQuery('input[data-marker="'+a._leaflet_id+'"]').val(d),a.options.title=c,a.closePopup(),a.bindPopup("				            	<input type='text' name='ase_marker_text[]' value='"+c+"'>				            	<a class='marker-update-button dashicons dashicons-yes'/></a>				            	<a class='marker-delete-button dashicons dashicons-trash'/></a>				            	")})}function i(a,b){return marker=L.marker(a,{title:b,alt:b,riseOnHover:!0,draggable:!0}).bindPopup("	            	<input type='text' name='ase_marker_text[]' value='"+b+"'>	            	<a class='marker-update-button dashicons dashicons-yes'/></a>	            	<a class='marker-delete-button dashicons dashicons-trash'/></a>	            	"),marker.on("popupopen",h),marker.on("dragend",c),marker}function j(a,b){jQuery(".lasso--map-form__footer").append('<input type="hidden" name="ase-map-component-locations[]" data-ase="map" data-marker="'+a+'" value="'+b+'">')}function k(a){var b=l(a._latlng.lat,a._latlng.lng,a.options.title);jQuery('input[data-marker="'+a._leaflet_id+'"]').val(b)}function l(a,b,c){return encodeURIComponent(JSON.stringify({lat:a,lng:b,title:c}))}function m(a,b){return encodeURIComponent(JSON.stringify({lat:a,lng:b}))}var n=S.lat?S.lat:29.76,o=S.lng?S.lng:-95.38,p=L.map("aesop-map-component",{scrollWheelZoom:!1,zoom:T,center:[n,o]});a(S[0],S[1]),jQuery("#lasso-map-address").geocomplete().bind("geocode:result",function(b,c){var d=c.geometry.location.k,e=c.geometry.location.B;p.panTo(new L.LatLng(d,e)),a(d,e)}),L.tileLayer(U,{maxZoom:T}).addTo(p),q.forEach(function(a){i([a.lat,a.lng],a.title).addTo(p),j(marker._leaflet_id,l(a.lat,a.lng,a.title))}),p.on("click",g),p.on("dragend",d),p.on("zoomend",e)};a("#"+c).sortable({opacity:.65,placeholder:"lasso-drop-zone",handle:".lasso-drag",cursor:"move",tolerance:"pointer",refreshPositions:!0,helper:function(b,c){var d=c.context,e=a(d).attr("data-component-type");return a('<div class="lasso-drag-holder lasso-toolbar--component__'+e+'"></div>')},beforeStop:function(a,b){draggedItem=b.item},receive:function(b,c){a("#lasso-toolbar--components").removeClass("toolbar--drop-up");var d,e=draggedItem.context,f=a(e).attr("data-type");if("draggable"==origin){var g=a(this).data("ui-sortable").currentItem.index(),h=a(this).data("ui-sortable").items.length,i=!1,d="";g>=h-1&&(i=!0),d="wpimg"==f?a(k[f].content).prepend(o):a(k[f].content).prepend(p).attr({"data-component-type":f}),i&&d.append("<p></p>"),a(e).replaceWith(d),"map"==f&&V(),"timeline_stop"==f&&Q(),"video"==f&&R(),a(d).find(".lasso-settings").trigger("click")}}}),a("#lasso-toolbar--components__list li").draggable({axis:"y",helper:"clone",cursor:"move",connectToSortable:"#"+c,start:function(b){origin="draggable";var c=b.currentTarget,d=a(c).attr("data-type");a(this).addClass(d)}})}),lasso_editor.skipToEdit&&(a("#lasso--edit").trigger("click"),lasso_editor.skipToEdit=!1)}),function(a){a(document).ready(function(){var b=function(){a("body").removeClass("lasso-modal-open"),a("#lasso--post-settings__modal, #lasso--modal__overlay").remove()};jQuery(document).on("click",".lasso--postsettings__option",function(c){(a(c.target).hasClass("tagit")||a(c.target).hasClass("story-categories-option"))&&b()}),jQuery(document).on("click","#lasso--post-settings",function(b){b.preventDefault(),a("body").toggleClass("lasso-modal-open"),a("body").append(lasso_editor.component_modal);var c=function(a){var b;return 100==a?b="draft":200==a?b="publish":"draft"==a?b=100:"publish"==a&&(b=200),b};a("#lasso--slider").slider({value:c(lasso_editor.post_status),min:100,max:200,step:100,animate:"fast",slide:function(b,d){a('input[name="status"]').val(c(d.value)),a(".lasso--postsettings__footer").slideDown(),100==d.value?a(".story-status").removeClass("story-status-publish").addClass("story-status-draft"):200==d.value&&a(".story-status").removeClass("story-status-draft").addClass("story-status-publish")}}),a('input[name="status"]').val(c(a("#lasso--slider").slider("value"))),a(".lasso--modal__trigger-footer").on("keyup",function(){a(".lasso--postsettings__footer").slideDown()});var d=a("#lasso--cat-select"),e=a("#lasso--tag-select");d.tagit({placeholderText:"add categories...",availableTags:lasso_editor.postCategories}),d.on("change",function(b){a(".lasso--postsettings__footer").slideDown()}),e.tagit({placeholderText:"add tags...",availableTags:lasso_editor.postTags}),e.on("change",function(b){a(".lasso--postsettings__footer").slideDown()}),a(".editus_custom_date").length&&a(".editus_custom_date").datepicker({}),modalResizer()}),jQuery(document).on("click","#lasso--modal__close, #lasso--modal__overlay, .lasso--postsettings-cancel",function(a){a.preventDefault(),b()}),a(document).keyup(function(a){27==a.keyCode&&b()});jQuery(document).on("submit","#lasso--postsettings__form",function(b){b.preventDefault();var c=a(this);a(this).find('input[type="submit"]').val(lasso_editor.strings.saving);var d=c.serialize();a.post(lasso_editor.ajaxurl,d,function(b){console.log(b),1==b.success?(a('input[type="submit"]').addClass("saved"),a('input[type="submit"]').val(lasso_editor.strings.saved),location.reload(),window.location.replace(lasso_editor.permalink)):(alert("error"),console.log(b))}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})}),a(document).on("click",".lasso--modal__tabs li",function(b){b.preventDefault();var c=a(this),d=c.data("addon-name"),e="not-visible",f="visible";a(".lasso--modal__tabs li").removeClass("active-tab"),c.addClass("active-tab"),a(".lasso--modal__content").removeClass(f).addClass(e),c.closest(".lasso--modal__inner").find('div[data-addon-content="'+d+'"]').removeClass(e).addClass(f),modalResizer()})})}(jQuery),function(a){a(document).ready(function(){var b=function(){a("body").removeClass("lasso-sidebar-open")};a("body").on("click","#"+lasso_editor.editor,function(){b()});var c,d=function(){var b=a("#lasso--component__settings");b.height(a(window).height()),a(window).resize(function(){b.height(a(window).height())})};a(document).on("click","#lasso-component--settings__trigger",function(){var b=a("#lasso--component__settings");a(this);if(c=a(this).parent().parent().hasClass("aesop-map-component")?a(this).parent().parent().find(".aesop-component"):a(this).closest(".aesop-component"),window.component=c,j=c.data(),a(this).parent().parent().hasClass("aesop-hero-gallery-wrapper")&&jQuery.extend(j,a(c).find(".fotorama").data()),a("body").toggleClass("lasso-sidebar-open"),b.find('input[name="unique"]').val(j.unique),d(),b.html(lasso_editor.component_options[j.componentType]),b.find(".component_type").val(j.componentType),a(".lasso-buttoninsert-wrap").fadeIn(600),b.perfectScrollbar("destroy"),b.perfectScrollbar(),b.find(".lasso-option").each(function(){var b=a(this).data("option"),c=a(this).find(".lasso-generator-attr");if("gallery-type"==b){var d=function(b){"grid"==b?(a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--hero").fadeOut(),a(".ase-gallery-opts--grid").fadeIn()):a(".ase-gallery-opts--grid").fadeOut(),"thumbnail"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--hero").fadeOut(),a(".ase-gallery-opts--thumb").fadeIn()):a(".ase-gallery-opts--thumb").fadeOut(),"photoset"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--hero").fadeOut(),a(".ase-gallery-opts--photoset").fadeIn()):a(".ase-gallery-opts--photoset").fadeOut(),"hero"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--hero").fadeIn()):a(".ase-gallery-opts--hero").fadeOut()};a(c).each(function(){a(this).val()==j.galleryType&&(a(this).parent().addClass("selected"),a(this).prop("checked",!0),d(a(this).val()),a("#ase_gallery_type").val(a(this).val()))})}else a(c[0]).val(j[b])}),c.hasClass("aesop-content-component"))var e=c.find(".aesop-content-comp-wrap").attr("id"),f=a("#"+e);else var f=a("#"+c.attr("id"));if(a("html, body").animate({scrollTop:f.length?f.offset().top-50:!1},400),a(this).parent().parent().hasClass("empty-gallery")&&b.addClass("gallery-no-images"),a(this).parent().parent().hasClass("aesop-gallery-component")){var g=(a(this),lasso_editor.ajaxurl),h=(a("#lasso--component-settings-form.gallery"),lasso_editor.getGallImgNonce),i=j.id,j={action:"process_gallery_get-images",post_id:i,nonce:h};a.post(g,j,function(b){a("#lasso--gallery__images").html(b.data.html);var c=a("#ase-gallery-images");c.ready(function(){c.sortable({containment:"parent",cursor:"move",opacity:.8,placeholder:"ase-gallery-drop-zone",forcePlaceholderSize:!0,update:function(){var b=a(this).sortable("toArray");a("#ase_gallery_ids").val(b)},create:function(){var b=a(this).sortable("toArray");a("#ase_gallery_ids").val(b)}})})}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})}}).on("click","#lasso-upload-img",function(b){b.preventDefault(),className=b.currentTarget.parentElement.className;var d=a('input[name="component_type"]').val();"undefined"!=typeof lasso_file_frame&&lasso_file_frame.close(),lasso_file_frame=wp.media.frames.file_frame=wp.media({title:"Select Image",button:{text:"Insert Image"},multiple:!1}),lasso_file_frame.on("select",function(){var b=lasso_file_frame.state().get("selection").first().toJSON();a(".lasso-generator-attr-media_upload").attr("value",b.url),"parallax"==d?c.find(".aesop-parallax-sc-img").attr("src",b.url):"quote"==d?c.css({"background-image":"url("+b.url+")"}):"image"==d?c.find(".aesop-image-component-image > img").attr("src",b.url):"character"==d?c.find(".aesop-character-avatar").attr("src",b.url):"chapter"==d&&c.find(".aesop-article-chapter").css({"background-image":"url("+b.url+")"})}),lasso_file_frame.open()}),jQuery(document).on("click","#lasso--sidebar__close",function(c){c.preventDefault(),b(),a("#lasso--component__settings").perfectScrollbar("destroy")})})}(jQuery),function(a){a(document).ready(function(){function b(b,c,d){b.find(".lasso-video-id > #lasso-generator-attr-id").on("change",function(){video_id=a(this).val(),"vimeo"==d?c.find("iframe").attr("src","//player.vimeo.com/video/"+video_id+" "):"youtube"==d&&c.find("iframe").attr("src","//www.youtube.com/embed/"+video_id+"?rel=0&wmode=transparent")})}a(document).on("click","#lasso-component--settings__trigger",function(){var c=a("#lasso--component__settings");c.find("#lasso-generator-attr-background").on("change",function(){component.css({"background-color":a(this).val()})}),c.find("#lasso-generator-attr-text").on("change",function(){component.css({color:a(this).val()})}),c.find("#lasso-generator-attr-quote").on("keyup",function(){component.find("blockquote span").text(a(this).val())}),c.find("#lasso-generator-attr-cite").on("keyup",function(){var b=component.find("blockquote cite");0==b.length?component.find("blockquote").append('<cite class="aesop-quote-component-cite">'+a(this).val()+"</cite>"):component.find("blockquote cite").text(a(this).val())}),c.find(".lasso-quote-width > #lasso-generator-attr-width").on("keyup",function(){component.css("width",a(this).val())}),c.find(".lasso-quote-type #lasso-generator-attr-type").on("change",function(){var b=a(this).val();"pull"==b&&component.css("background-color","transparent"),component.removeClass("aesop-quote-type-block aesop-quote-type-pull"),component.addClass("aesop-quote-type-"+a(this).val()+" ")}),c.find(".lasso-quote-align #lasso-generator-attr-align").on("change",function(){var b=a(this).val();"left"==b?(component.removeClass("aesop-component-align-right aesop-component-align-center"),component.find("blockquote").removeClass("aesop-component-align-right aesop-component-align-center")):"right"==b?(component.removeClass("aesop-component-align-left aesop-component-align-center"),component.find("blockquote").removeClass("aesop-component-align-left aesop-component-align-center")):"center"==b&&(component.removeClass("aesop-component-align-left aesop-component-align-right"),component.find("blockquote").removeClass("aesop-component-align-left aesop-component-align-right")),component.addClass("aesop-component-align-"+a(this).val()+" "),component.find("blockquote").addClass("aesop-component-align-"+a(this).val()+" ")}),c.find(".lasso-parallax-caption > #lasso-generator-attr-caption").on("keyup",function(){var b=component.find(".aesop-parallax-sc-caption-wrap");0==b.length?component.find("img").after('<figcaption class="aesop-parallax-sc-caption-wrap bottom-left">'+a(this).val()+"</figcaption>"):component.find(".aesop-parallax-sc-caption-wrap").text(a(this).val())}),c.find(".lasso-parallax-captionposition > #lasso-generator-attr-captionposition").on("change",function(){var b=a(this).val();"bottom-left"==b?component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-right top-left top-right"):"bottom-right"==b?component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-left top-left top-right"):"top-left"==b?component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-right top-right bottom-left"):"top-right"==b&&component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-right bottom-left top-left"),component.find(".aesop-parallax-sc-caption-wrap").addClass(b)}),c.find(".lasso-image-caption > #lasso-generator-attr-caption").on("keyup",function(){var b=component.find(".aesop-image-component-caption");0==b.length?component.find("img").after('<p class="aesop-image-component-caption">'+a(this).val()+"</p>"):component.find(".aesop-image-component-caption").text(a(this).val())}),c.find(".lasso-image-imgwidth > #lasso-generator-attr-imgwidth").on("keyup",function(){component.find(".aesop-image-component-image").css("max-width",a(this).val())}),c.find(".lasso-image-align > #lasso-generator-attr-align").on("change",function(){var b=a(this).val();"left"==b?component.find(".aesop-image-component-image").removeClass("aesop-component-align-right aesop-component-align-center"):"right"==b?component.find(".aesop-image-component-image").removeClass("aesop-component-align-left aesop-component-align-center"):"center"==b&&component.find(".aesop-image-component-image").removeClass("aesop-component-align-left aesop-component-align-right"),component.find(".aesop-image-component-image").addClass("aesop-component-align-"+a(this).val()+" ")}),c.find(".lasso-image-captionposition > #lasso-generator-attr-captionposition").on("change",function(){var b=a(this).val();"left"==b?component.find(".aesop-image-component-image").removeClass("aesop-image-component-caption-right aesop-image-component-caption-center"):"right"==b?component.find(".aesop-image-component-image").removeClass("aesop-image-component-caption-left aesop-image-component-caption-center"):"center"==b&&component.find(".aesop-image-component-image").removeClass("aesop-image-component-caption-left aesop-image-component-caption-right"),component.find(".lasso-image-component-image").addClass("lasso-image-component-caption-"+b+" ")}),c.find(".lasso-image-offset > #lasso-generator-attr-offset").on("keyup",function(){a(this).val();component.find(".aesop-image-component-image").hasClass("aesop-component-align-left")?component.find(".aesop-image-component-image").css("margin-left",a(this).val()):component.find(".aesop-image-component-image").css("margin-right",a(this).val())}),c.find(".lasso-character-name > #lasso-generator-attr-name").on("keyup",function(){component.find(".aesop-character-title").text(a(this).val())}),c.find(".lasso-character-caption > #lasso-generator-attr-caption").on("keyup",function(){component.find(".aesop-character-cap").text(a(this).val())}),c.find(".lasso-character-align > #lasso-generator-attr-align").on("change",function(){var b=a(this).val();"left"==b?component.removeClass("aesop-component-align-right aesop-component-align-center"):"center"==b&&component.removeClass("aesop-component-align-left aesop-component-align-right"),component.addClass("aesop-component-align-"+a(this).val()+" ")}),c.find(".lasso-chapter-title > #lasso-generator-attr-title").on("keyup",function(){component.find(".aesop-cover-title span").text(a(this).val())}),c.find(".lasso-chapter-subtitle > #lasso-generator-attr-subtitle").on("keyup",function(){component.find(".aesop-cover-title small").text(a(this).val())}),c.find(".lasso-video-src > #lasso-generator-attr-src").on("change blur",function(){val=a(this).val(),"vimeo"==val?(component.find("iframe").attr("src","//player.vimeo.com/video/"+val+" "),b(c,component,"vimeo")):"youtube"==val&&(component.find("iframe").attr("src","//www.youtube.com/embed/"+val+"?rel=0&wmode=transparent"),b(c,component,"youtube"))}),c.find(".lasso-video-id > #lasso-generator-attr-id").on("keyup",function(){t=a(".lasso-video-src > #lasso-generator-attr-src").val(),val=a(this).val(),"vimeo"==t?component.find("iframe").attr("src","//player.vimeo.com/video/"+val+" "):"youtube"==t&&component.find("iframe").attr("src","//www.youtube.com/embed/"+val+"?rel=0&wmode=transparent")}),c.find(".lasso-video-width > #lasso-generator-attr-width").on("keyup",function(){component.find(".aesop-video-container").css("max-width",a(this).val())}),c.find(".lasso-content-background > #lasso-generator-attr-background").on("change",function(){component.find(".aesop-content-comp-wrap").css({"background-color":a(this).val()})}),c.find(".lasso-content-color > #lasso-generator-attr-color").on("change",function(){component.find(".aesop-content-comp-wrap").css({color:a(this).val()})}),c.find(".lasso-content-height > #lasso-generator-attr-height").on("keyup",function(){val=a(this).val(),component.find(".aesop-content-comp-wrap").css({"min-height":a(this).val()})}),c.find(".lasso-content-columns > #lasso-generator-attr-columns").on("change",function(){val=a(this).val(),"1"==val?component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-2 aesop-content-comp-columns-3 aesop-content-comp-columns-4").addClass("aesop-content-comp-columns-1"):"2"==val?component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-1 aesop-content-comp-columns-3 aesop-content-comp-columns-4").addClass("aesop-content-comp-columns-2"):"3"==val?component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-1 aesop-content-comp-columns-2 aesop-content-comp-columns-4").addClass("aesop-content-comp-columns-3"):"4"==val&&component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-1 aesop-content-comp-columns-2 aesop-content-comp-columns-3").addClass("aesop-content-comp-columns-4");
})})})}(jQuery),jQuery(function(a){function b(){if(window.getSelection){if(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount)return sel.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null}function c(a){a&&(window.getSelection?(sel=window.getSelection(),sel.removeAllRanges(),sel.addRange(a)):document.selection&&a.select&&a.select())}var d=function(){return 600<=a(window).width()?!0:!1},f=function(){return d()?"up":"down"};a(document).on("click","#lasso-toolbar--components",function(b){a(this).toggleClass("toolbar--drop-"+f());var c=a(this).find("ul");if(a(this).hasClass("toolbar--drop-"+f())?a(c).show():a(c).hide(),a("#lasso-toolbar--html").removeClass("html--drop-"+f()),a("#lasso-toolbar--link").removeClass("link--drop-"+f()),lasso_editor.isMobile)a(c).css({dropUp:e,top:40});else{var e=a(c).height(),g=15;1==d()&&a(c).css({dropUp:e,top:-(e+g)})}}),jQuery(document).on("mousedown","#lasso-toolbar--html",function(){if(!a(this).hasClass("html--drop-"+f())){var c=document.getElementById(lasso_editor.editor);window.selRange=b(),("undefined"==typeof window.selRange||null==window.selRange)&&(c.highlight(),window.selRange=b())}}),jQuery(document).on("focusout","#lasso-toolbar--html__inner",function(){c(window.selRange)}),jQuery(document).on("focus","#lasso-toolbar--html__inner",function(){0!=a(b().commonAncestorContainer).parents("#lasso--content").length&&(window.selRange=b())}),a(document).on("click","#lasso-toolbar--html",function(b){a(this).toggleClass("html--drop-"+f()),a("#lasso-toolbar--components").removeClass("toolbar--drop-"+f()),a("#lasso-toolbar--link").removeClass("link--drop-"+f()),jQuery(document).on("click","#lasso-toolbar--html__wrap",function(){return!1}),a(this).find("#lasso-toolbar--html__inner").focus()}),jQuery(document).on("click",".lasso-toolbar--html__cancel",function(){a(this).closest("li").removeClass("html--drop-"+f())});var g=function(b){return a("#lasso-toolbar--html__inner").text(b)};jQuery(document).on("click","#lasso-html--h2",function(a){a.preventDefault(),g("<h2>H2 Heading</h2>")}),jQuery(document).on("click","#lasso-html--h3",function(a){a.preventDefault(),g("<h3>H3 Heading</h3>")}),jQuery(document).on("click","#lasso-html--ul",function(a){a.preventDefault(),g("<ul><li>Item</li></ul>")}),jQuery(document).on("click","#lasso-html--ol",function(a){a.preventDefault(),g("<ol><li>Item</li></ol>")}),jQuery(document).on("mousedown","#lasso-toolbar--link",function(){if(!a(this).hasClass("link--drop-up")){var c=document.getElementById(lasso_editor.editor);window.selRange=b(),("undefined"==typeof window.selRange||null==window.selRange)&&(c.highlight(),window.selRange=b())}}),jQuery(document).on("focusout","#lasso-toolbar--link__inner",function(){c(window.selRange)}),jQuery(document).on("focus","#lasso-toolbar--link__inner",function(){0!=a(b().commonAncestorContainer).parents("#lasso--content").length&&(window.selRange=b())}),a(document).on("click","#lasso-toolbar--link",function(b){a(this).toggleClass("link--drop-"+f()),a("#lasso-toolbar--components").removeClass("toolbar--drop-"+f()),a("#lasso-toolbar--html").removeClass("html--drop-"+f()),a("#aesop-toolbar--link_newtab").unbind("mousedown").mousedown(function(){a(this).prop("checked",!a(this).prop("checked"))}),jQuery(document).on("click","#lasso-toolbar--link__wrap",function(){return!1}),a(this).find("#lasso-toolbar--link__inner").focus()}),jQuery(document).on("click",".lasso-editing .lasso-link",function(){e.preventDefault(),jQuery(document).on("click","#lasso-toolbar--link__wrap",function(){return!1});var b=a(this).attr("href");a("#lasso-toolbar--link").addClass("link--drop-"+f()),a("#lasso-toolbar--link__inner").text(b)}),jQuery(document).on("click",".lasso-delete",function(b){b.preventDefault();var c=a(this);swal({title:"Delete this component?",type:"warning",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){c.closest(".aesop-component").remove(),c.closest(".lasso-component").remove()})}),jQuery(document).on("click",".lasso-clone",function(b){var c=a(this);b.preventDefault(),c.closest(".aesop-component").clone().insertAfter(a(this).parent().parent()).hide().fadeIn(),c.closest(".lasso-component").clone().insertAfter(a(this).parent().parent()).hide().fadeIn()})}),jQuery(document).ready(function(a){var b=lasso_editor.ajaxurl,c=(a(".lasso--controls__right a"),lasso_editor.editor),d=lasso_editor.postid,e=a("#"+c).html(),f="You have unsaved changes!";noWarningReload=!1,jQuery(document).on("change","#"+c,function(){var b=a(this),c=b.html();e!==c&&localStorage.setItem("lasso_backup_"+d,c)}),window.onbeforeunload=function(){return localStorage.getItem("lasso_backup_"+d)&&lasso_editor.userCanEdit?f:void 0},window.onunload=function(){localStorage.getItem("lasso_backup_"+d)&&lasso_editor.userCanEdit&&localStorage.clear()},jQuery(document).on("click",".lasso--controls__right a:not(#lasso--exit)",function(d){function e(a){return a.replace(/contenteditable="(false|true)"/g,"")}function f(b){var c=a("<div></div>").html(b),d={},e=lasso_editor.customFields;for(var f in e)if(e.hasOwnProperty(f)){var g=c.find(e[f]);g.length&&(d[f]=c.find(e[f])[0].innerText.replace(/[\n\r]/g,""))}lasso_editor.cftosave=d}function g(b,c){var d=a.parseHTML(b),e="";if(null==d)return b;for(var f=0;f<d.length;f++){var h=a(d[f]);if(h.hasClass("aesop-component")){var i=h.data(),j="";if(i.hasOwnProperty("componentType")){for(var k in i)i.hasOwnProperty(k)&&"componentType"!=k&&(j+=" "+k+'="'+i[k]+'"');var l="[aesop_"+i.componentType+j+"]",m=h.find(".aesop-component-content-data");0!=m.length&&(l+=m[0].innerHTML+"[/aesop_"+i.componentType+"]"),e+=l}}else if(0!==h.find(".aesop-component").length){var n=h.html();n=g(n),h.html(n),e+=h.clone().wrap("<p>").parent().html()}else e+=3==h.context.nodeType?d[f].data:8==h.context.nodeType?"<!--"+d[f].data+"-->":d[f].outerHTML}return e}function h(b){if(-1==b.indexOf("twitterwidget"))return b;var d,e=a("#"+c).clone(),f=e.find("twitterwidget"),g=a("#"+c).find("twitterwidget");for(d=0;d<f.length;d++){var h=a("<div></div>").html(g[d].shadowRoot.innerHTML).find(".EmbeddedTweet").data("click-to-open-target");a(f[d]).replaceWith(h)}var i=e.html();return i}function i(b,c){for(var d=a.parseHTML(b),e="",f=0;f<d.length;f++){var g=a(d[f]);if(g.hasClass("su-box")||g.hasClass("su-note")||g.hasClass("su-document")||g.hasClass("su-spoiler")){if(g.hasClass("su-box")){var h=g.find(".su-box-title")[0].innerHTML,j=g.find(".su-box-content")[0].innerHTML,k=g.find(".su-box-title")[0].style.backgroundColor,l='[su_box title="'+h+'" box_color="'+k+'"]'+j+"[/su_box]";e+=l}else if(g.hasClass("su-note")){var m=g.find(".su-note-inner")[0].innerHTML;m=i(m);var n=g.find(".su-note-inner")[0].style.backgroundColor,o=g.find(".su-note-inner")[0].style.color,l='[su_note note_color="'+n+'" text_color="'+o+'"]'+m+"[/su_note]";e+=l}else if(g.hasClass("su-document")){var p=g.find("iframe.su-document")[0],q=getParameterByName("url",p.src),r=p.width,s=p.height,l='[su_document url="'+q+'" width="'+r+'" height="'+s+'"]';e+=l}else if(g.hasClass("su-spoiler")){var t=g.find(".su-spoiler-content")[0].innerHTML;t=i(t);var u=g.find(".su-spoiler-title")[0].textContent,l='[su_spoiler title="'+u+'" style="fancy" open="no"]'+t+"[/su_spoiler]";e+=l}}else e+=3==g.context.nodeType?d[f].data:8==g.context.nodeType?"<!--"+d[f].data+"-->":d[f].outerHTML}return e}function j(b,c){for(var d=a.parseHTML(b),e="",f=0;f<d.length;f++){var g=a(d[f]);if(g.hasClass("av_textblock_section")||g.hasClass("av_toggle_section")||g.hasClass("togglecontainer")){if(g.hasClass("av_textblock_section")){var h=g.find(".avia_textblock")[0].innerHTML,i="[av_textblock]"+h+"[/av_textblock]";e+=i}else if(g.hasClass("togglecontainer")){var b=g[0].innerHTML,k="accordion";b=j(b),g[0].hasClass("enable_toggles")&&(k="toggle");var i="[av_toggle_container mode='"+k+"']"+b+"[/av_toggle_container]";e+=i}else if(g.hasClass("av_toggle_section")){var l=g.find(".toggler")[0].innerText,m=g.find(".toggle_content")[0].innerHTML,i='[av_toggle title="'+l+'"]'+m+"[/av_toggle]";e+=i}}else e+=3==g.context.nodeType?d[f].data:8==g.context.nodeType?"<!--"+d[f].data+"-->":d[f].outerHTML}return e}function k(a){if(a=a.replace(/<script.*>.*<\/script>/g," "),-1==a.indexOf("--EDITUS_OTHER_SHORTCODE_START|"))return a;var b=/<!--EDITUS_OTHER_SHORTCODE_START\|\[([\s\S]*?)\]-->([\s\S]*?)<!--EDITUS_OTHER_SHORTCODE_END-->/g;return a=a.replace(b,"$1")}function l(b,c,d,e,f,g){var h={content:e,status:g};lasso_editor.aviaEditor&&(h.content="",h.metadata={_aviaLayoutBuilderCleanData:e}),lasso_editor.cftosave&&(h.metadata?Object.assign(h.metadata,lasso_editor.cftosave):h.metadata=lasso_editor.cftosave);var i;i="post"==f?"posts":"page"==f?"pages":f,c.length>0&&(h.title=c),d.length>0&&(h.metadata={_subtitle:d}),"on"==lasso_editor.disableSavePost&&delete h.content,a.ajax({method:"POST",url:lasso_editor.rest_root+"wp/v2/"+i+"/"+b,data:h,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",lasso_editor.rest_nonce)},success:function(a){m()},error:function(b,c){console.log(b),alert("AJAX Error: "+b.responseText),a("#lasso--save").removeClass("being-saved").addClass("lasso--error")}})}function m(){a("#lasso--save").removeClass("being-saved").addClass("lasso--saved"),o.hasClass("lasso-publish-post")&&o.remove(),setTimeout(function(){a("#lasso--save").removeClass("lasso--saved"),o.hasClass("lasso-publish-post")&&location.reload()},1200),localStorage.removeItem("lasso_backup_"+q),lasso_editor.dirtyByComponent=!1}function n(c){if(lasso_editor.saveusingrest){var d=a(".lasso--controls__right").data("status"),e="";a(lasso_editor.titleClass).length>0&&(e=a(lasso_editor.titleClass)[0].innerText);var f="";return a(lasso_editor.subtitleClass).length>0&&(f=a(lasso_editor.subtitleClass)[0].innerText),c&&(d="publish"),void l(lasso_editor.postid,e,f,s.content,a(".lasso--controls__right").data("posttype"),d)}a.post(b,s,function(b){1==b.success?m():a("#lasso--save").removeClass("being-saved").addClass("lasso--error")}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c)),a("#lasso--save").removeClass("being-saved").addClass("lasso--error")})}d.preventDefault();var o=a(this);a(".lasso--wpimg__wrap").each(function(){a(this).hasClass("wp-caption")||a(this).children().unwrap(),a(".lasso-component--controls").remove()}),a(".lasso-component").each(function(){a(".lasso-component--controls").remove()}),a("#lasso--map-form").each(function(){var b=a(this);b.find(".lasso-component--controls, .lasso--map-form__footer ").remove(),b.children().unwrap()}),a(".scroll-nav__section").each(function(){a(this).children().unwrap()}),a("#lasso--notice").remove();var p=a("#"+c).html(),q=o.closest("#lasso--controls").data("post-id");if(p=h(p),lasso_editor.showIgnoredItems){var r=a("<div></div>").html(p);r.find(lasso_editor.objectsNoSave).remove(),r.find(lasso_editor.supportedNoSave).remove(),p=r.html()}a(this).addClass("being-saved");var r=a("<div></div>").html(p);r.find("a").removeClass("lasso-link"),r.find("span").removeClass("lasso-span"),r.find("h2").removeClass("lasso-h2"),r.find("h3").removeClass("lasso-h3"),r.find(".lasso-noclass").removeClass("lasso-noclass"),r.find(".lasso-undeletable").removeClass("lasso-undeletable"),r.find(".lasso-component--controls, .aesop-events-edit").remove(),r.find('*[class=""]').removeAttr("class"),p=r.html(),p=e(p),lasso_editor.customFields&&f(p),p=i(p),p=o.hasClass("shortcodify-enabled")?g(p):p,lasso_editor.filterArray&&a(lasso_editor.filterArray).each(function(a,b){p=b(p)}),p=k(p),lasso_editor.aviaEditor&&(p=j(p));var s={action:o.hasClass("lasso-publish-post")?"process_save_publish-content":"process_save_content",author:lasso_editor.author,content:p,post_id:q,nonce:lasso_editor.nonce};o.hasClass("lasso-publish-post")?swal({title:lasso_editor.strings.publishPost,type:"info",text:!1,showCancelButton:!0,confirmButtonColor:"#5bc0de",confirmButtonText:lasso_editor.strings.publishYes,closeOnConfirm:!0},function(){n(!0)}):n(!1)})}),function(a){"use strict";function b(a){var b={componentType:"gallery",id:a};window.get_aesop_component_ajax(b)}function c(){if(g=a("#lasso--gallery__images #ase-gallery-images"),g.length){var b=g.sortable("toArray");a("#ase_gallery_ids").val(b)}}function d(b,d){var e="<li id='"+b+"' class='ase-gallery-image'><i class='dashicons dashicons-no-alt'></i><i title='Edit Image Caption' class='dashicons dashicons-edit'></i><img src='"+d+"'></li>";a("#ase-gallery-images").append(e),g.sortable("refresh"),c()}function e(b,d,e){var f="<li id='"+b+"' class='ase-gallery-image'><i class='dashicons dashicons-no-alt'></i><i title='Edit Image Caption' class='dashicons dashicons-edit'></i><img src='"+d+"'></li>";a(e).replaceWith(f),g.sortable("refresh"),c()}jQuery(document).on("click","#lasso--gallery__create",function(b){b.preventDefault(),a(this).closest("form").addClass("creating-gallery"),a(".ase-gallery-opts--create-gallery").fadeIn(),a(".ase-gallery-opts--edit-gallery").fadeOut(1),a("#ase-gallery-images li").remove(),a("#lasso--gallery__create").remove(),a(".ase-gallery-opts--edit-gallery").text(lasso_editor.strings.addNewGallery),a(".ase-gallery-opts--edit-gallery .lasso-option-desc").text("Select new images to create a gallery with.")});var f,g=a("#ase-gallery-images");jQuery(document).on("click","#lasso--gallery__selectImages",function(b){return b.preventDefault(),f?void f.open():(f=wp.media.frames.file_frame=wp.media({title:lasso_editor.strings.chooseImages,button:{text:lasso_editor.strings.addImages},multiple:!0}),f.on("select",function(){var b=f.state().get("selection");if(b){b.each(function(a){var b=a.id,c=a.attributes.sizes.thumbnail.url;d(b,c)});var c=b.map(function(a){var a=a.toJSON();return a.id}).join(",");a("#ase_gallery_ids").val(c),a(".has-galleries > #lasso--gallery__save").fadeIn(),a("#lasso--gallery__selectImages").remove()}}),void f.open())}),jQuery(document).on("change",".lasso-gallery-id #lasso-generator-attr-id",function(){b(a(this).val());var c={action:"process_gallery_get-images",post_id:a(this).val(),nonce:lasso_editor.getGallImgNonce};a.post(lasso_editor.ajaxurl,c,function(b){a("#lasso--gallery__images").html(b.data.html);var c=a("#ase-gallery-images");c.ready(function(){c.sortable({containment:"parent",cursor:"move",opacity:.8,placeholder:"ase-gallery-drop-zone",forcePlaceholderSize:!0,update:function(){var b=a(this).sortable("toArray");a("#ase_gallery_ids").val(b)},create:function(){var b=a(this).sortable("toArray");a("#ase_gallery_ids").val(b)}})})}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})}),a(document).on("click",".ase-gallery-image > i.dashicons-no-alt",function(){a(this).parent().remove(),g.sortable("refresh"),c()});var h=!1;a(document).on("click","#ase-gallery-add-image",function(b){b.preventDefault();if(h=a(this),wp.media.frames.ase_frame)return void wp.media.frames.ase_frame.open();wp.media.frames.ase_frame=wp.media({title:lasso_editor.strings.selectGallery,multiple:!0,library:{type:"image"},button:{text:lasso_editor.strings.useSelectedImages}});var c=function(){var a=wp.media.frames.ase_frame.state().get("selection");a&&a.each(function(a){var b=a.id,c=a.attributes.sizes.thumbnail.url;d(b,c)})};wp.media.frames.ase_frame.on("select",c),wp.media.frames.ase_frame.open()});var i=function(){var b;a(document).on("click",".ase-gallery-image > i.dashicons-edit",function(c){c.preventDefault();if(b=a(this),wp.media.frames.ase_edit_frame)return void wp.media.frames.ase_edit_frame.open();wp.revisions,wp.media.frames.ase_edit_frame=wp.media({title:lasso_editor.strings.editImage,multiple:!1,library:{type:"image"},button:{text:lasso_editor.strings.updateSelectedImg}});var d=function(){var a=wp.media.frames.ase_edit_frame.state().get("selection");a&&a.each(function(a){var c=a.id,d=a.attributes.sizes.thumbnail.url;e(c,d,b.parent())})};wp.media.frames.ase_edit_frame.on("select",d),wp.media.frames.ase_edit_frame.on("open",function(){var a=wp.media.frames.ase_edit_frame.state().get("selection"),c=wp.media.attachment(b.parent().attr("id"));c.fetch(),a.add(c?[c]:[])}),wp.media.frames.ase_edit_frame.open()})};i(),c()}(jQuery),function(a){a(document).ready(function(a){var b=function(b){"grid"==b?(a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--hero").fadeOut(),a(".ase-gallery-opts--grid").fadeIn()):a(".ase-gallery-opts--grid").fadeOut(),"thumbnail"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--hero").fadeOut(),a(".ase-gallery-opts--thumb").fadeIn()):a(".ase-gallery-opts--thumb").fadeOut(),"photoset"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--hero").fadeOut(),a(".ase-gallery-opts--photoset").fadeIn()):a(".ase-gallery-opts--photoset").fadeOut(),"hero"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--hero").fadeIn()):a(".ase-gallery-opts--hero").fadeOut()};a(".ase-gallery-type-radio").each(function(){if(a(this).is(":checked")){a(this).parent().addClass("selected");var c=a(this).val();b(c)}}),jQuery(document).on("click",".ase-gallery-layout-label",function(){a(".ase-gallery-layout-label").removeClass("selected"),a(this).addClass("selected");var c=a(this).find("input").val();b(c),a("#ase_gallery_type").val(c)})})}(jQuery),function(a){jQuery(document).on("submit","#lasso--map-form",function(b){b.preventDefault();var c=a(this);a(this).find('input[type="submit"]').val("Saving...").addClass("being-saved");var d=c.serialize();a.post(lasso_editor.ajaxurl,d,function(a){1==a.success?(c.find('input[type="submit"]').val("Saved"),c.removeClass("being-saved").addClass("lasso--saved"),setTimeout(function(){c.find('input[type="submit"]').val("Save Locations").removeClass("lasso-saved")},1200)):c.removeClass("being-saved").addClass("lasso--error")})})}(jQuery),function(a){"use strict";jQuery(document).on("click","#lasso--featImgSave a",function(b){b.preventDefault();var c=a(this),d=a("#lasso--save-status"),e={action:"process_upload-image_upload",postid:lasso_editor.postid,image_id:c.data("featimg-id"),nonce:lasso_editor.featImgNonce};d.removeClass("not-visible").addClass("visible lasso--animate__spin"),a.post(lasso_editor.ajaxurl,e,function(b){b&&(console.log("response"),a("#lasso--featImgSave").css("opacity",0),d.removeClass("lasso--animate__spin lasso-icon-spinner6").addClass("lasso-icon-check"),setTimeout(function(){d.removeClass("lasso--animate__spin lasso-icon-check").addClass("lasso-icon-spinner6 not-visible")},500))}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})});var b,c;a(document).on("click","#lasso--featImgUpload > a",function(d){d.preventDefault(),c=d.currentTarget.parentElement.className;var e=a("#lasso--featImgSave a");return b?void b.open():(b=wp.media.frames.file_frame=wp.media({title:lasso_editor.strings.chooseImage,button:{text:lasso_editor.strings.updateImage},multiple:!1}),b.on("select",function(){var c=b.state().get("selection").first().toJSON();a("body").addClass("lasso--post-thumb-applied"),a("article").removeClass("no-post-thumbnail").addClass("has-post-thumbnail"),a(lasso_editor.featImgClass).css({"background-image":"url("+c.url+")"}),e.attr("data-featimg-id",c.id).trigger("click"),a(".no-post-cover-note").remove()}),void b.open())}),a(document).on("click","#lasso--featImgDelete > a",function(b){b.preventDefault();var c=a(this),d={action:"process_upload-image_delete",postid:lasso_editor.postid,nonce:lasso_editor.featImgNonce};swal({title:lasso_editor.strings.removeFeatImg,type:"warning",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:lasso_editor.strings.deleteYes,closeOnConfirm:!0},function(){a.post(lasso_editor.ajaxurl,d,function(b){1==b.success&&(a("body").addClass("lasso--post-thumb-removed"),a("article").removeClass("has-post-thumbnail").addClass("no-post-thumbnail"),a("#lasso--featImgDelete").addClass("lasso--featImg--controlHidden"),c.closest("ul").removeClass("lasso--featImg--has-thumb"),a(lasso_editor.featImgClass).css({"background-image":"url()"}))})})});var d;a(document).on("click","#lasso--post-thumb__add",function(b){b.preventDefault();var c=a(this),e=a("#lasso--featImgSave a");return d?void d.open():(d=wp.media.frames.featimg_frame=wp.media({title:lasso_editor.strings.chooseImage,button:{text:lasso_editor.strings.updateImage},multiple:!1}),d.on("select",function(){var b=d.state().get("selection").first().toJSON(),f=c.closest(".lasso--post-thumb").find("img");f.attr("src",b.url),e.attr("data-featimg-id",b.id).trigger("click"),a("#lasso--postsettings__form").removeClass("no-thumbnail").addClass("has-thumbnail"),f.removeAttr("srcset"),noWarningReload=!0}),void d.open())}).on("click","#lasso--post-thumb__delete",function(b){b.preventDefault();var c=a(this),d={action:"process_upload-image_delete",postid:lasso_editor.postid,nonce:lasso_editor.featImgNonce};swal({title:lasso_editor.strings.removeFeatImg,type:"warning",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:lasso_editor.strings.deleteYes,closeOnConfirm:!0},function(){a.post(lasso_editor.ajaxurl,d,function(b){if(1==b.success){var d=c.closest(".lasso--post-thumb").data("default-thumb");c.closest(".lasso--postsettings__left").find("img").attr("src",d),c.closest(".lasso--postsettings__left").find("img").removeAttr("srcset"),a("#lasso--postsettings__form").removeClass("has-thumbnail").addClass("no-thumbnail"),noWarningReload=!0}})})})}(jQuery),function(a){window.get_aesop_component_ajax=function(b){var c={action:"get_aesop_component",code:"aesop_"+b.componentType};for(var d in b)b.hasOwnProperty(d)&&"componentType"!=d&&"sortableItem"!=d&&(c[d]=b[d]);jQuery.post(lasso_editor.ajaxurl2,c,function(c){if(c){c=c.replace(/\\'/g,"'");var d=a(c);window.component.replaceWith(d),window.component=d,d.find(".fotorama")&&a(".fotorama").fotorama(),d.find(".aesop-gallery-photoset")&&a(window).trigger("load"),a(".aesop-component").each(function(){if("0px"==a(this).css("height")&&a(this).css("height","auto"),!a(".lasso-component--toolbar").length>0)if(a(this).hasClass("aesop-map-component")){var b=a(this);b.wrap('<div id="lasso--map-form" class="aesop-component aesop-map-component lasso--map-drag-holder" data-component-type="map" >').before(lassoDragHandle)}else a(this).append(lasso_editor.handle)}),"video"==b.componentType&&a(".aesop-video-component").fitVids(),lasso_editor.dirtyByComponent=!0}else alert("error")})},jQuery(document).on("submit","#lasso--component-settings-form",function(b){b.preventDefault();var c=window.component,d=c.data(),e=a("#lasso-generator-insert"),f=a("#lasso--component-settings-form"),g=a(this);e.val(lasso_editor.strings.saving),g.find(".lasso-generator-attr").each(function(){var b=a(this).closest(".lasso-option").data("option");c.attr("data-"+b,a(this).val()),c.data(b,a(this).val())});var h=function(a){return delete a.sortableItem,a},i=function(b,c,d){var g=function(a){e.addClass("saved"),1==a?e.val(lasso_editor.strings.galleryCreated):e.val(lasso_editor.strings.saved)};1==b?setTimeout(function(){g()},500):1==d?(f.addClass("hide-all-fields").prepend('<div id="lasso--pagerefresh">Gallery Created! Save your post and refresh the page to access this new gallery.</div>'),setTimeout(function(){g(!0)},500)):g(),setTimeout(function(){a("body").removeClass("lasso-sidebar-open")},c),lasso_editor.dirtyByComponent=!0};if("gallery"==d.componentType){var j={action:f.hasClass("creating-gallery")?"process_gallery_create":"process_gallery_update",postid:d.id,unique:d.unique,fields:h(d),gallery_type:a("#ase_gallery_type").val(),gallery_ids:a("#ase_gallery_ids").val(),nonce:a("#lasso-generator-nonce").val()};f.hasClass("creating-gallery")&&(j.edgallerytitle=document.getElementById("lasso--gallery__galleryname").value),a.post(lasso_editor.ajaxurl,j,function(a){"gallery-created"==a.data.message?(i(!1,1e3,!0),d.id=a.data.id):"gallery-updated"==a.data.message?(i(!1,1e3),f.before(lasso_editor.refreshRequired)):alert("error"),window.get_aesop_component_ajax(d)}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})}else i(!0,1200);if("image"==d.componentType||"quote"==d.componentType||"parallax"==d.componentType||"chapter"==d.componentType||"video"==d.componentType||"character"==d.componentType||"collection"==d.componentType||"audio"==d.componentType)window.get_aesop_component_ajax(d);else if("content"==d.componentType){var k=component.find(".aesop-component-content-data");0!=k.length&&(d.content_data=k[0].innerHTML),window.get_aesop_component_ajax(d)}})}(jQuery),function(a){function b(b,c,d){var e,f={title:b,content:d,status:"draft"};e="post"==c?"posts":"page"==c?"pages":c,a.ajax({method:"POST",url:lasso_editor.rest_root+"wp/v2/"+e,data:f,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",lasso_editor.rest_nonce)},success:function(b){a('input[type="submit"]').addClass("saved"),a('input[type="submit"]').val(lasso_editor.strings.added),window.location.replace(b.link)},error:function(a,b){alert("AJAX Error: "+a.responseText)}})}a(document).ready(function(){var c=function(){a("body").removeClass("lasso-modal-open"),a(".lasso--modal, #lasso--modal__overlay").remove(),noWarningReload&&location.reload()};jQuery(document).on("click","#lasso--post-new",function(b){b.preventDefault(),a("body").toggleClass("lasso-modal-open"),a("body").append(lasso_editor.newPostModal),a(".lasso--modal__trigger-footer").on("keyup",function(){a(".lasso--postsettings__footer").slideDown()}),modalResizer()}),jQuery(document).on("click","#lasso--modal__close, #lasso--modal__overlay, .lasso--postsettings-cancel",function(a){a.preventDefault(),c()}),a(document).keyup(function(a){27==a.keyCode&&c()});jQuery(document).on("submit","#lasso--postnew__form",function(c){c.preventDefault();var d=a(this);if(a(this).find('input[type="submit"]').val(lasso_editor.strings.adding),lasso_editor.saveusingrest){var e=d.serializeArray().reduce(function(a,b){return a[b.name]=b.value,a},{});b(e.story_title,e.object,lasso_editor.newObjectContent)}else{var f=d.serialize();a.post(lasso_editor.ajaxurl,f,function(b){1==b.success?(a('input[type="submit"]').addClass("saved"),a('input[type="submit"]').val(lasso_editor.strings.added),window.location.replace(b.data.postlink)):alert("error")})}})}),jQuery(document).on("change","#lasso--select-type",function(){var b=a(this).val();a('input[name="object"]').val(b),a(this).closest(".story-slug-option").find("label span:not(.lasso-util--help)").text(b)})}(jQuery),function(a){a(document).ready(function(){a(lasso_editor.titleClass).on("blur",function(){var b=a(this),c={action:"process_title-update_post",postid:lasso_editor.postid,title:a.trim(b.text()),nonce:lasso_editor.titleNonce};a.post(lasso_editor.ajaxurl,c,function(a){if(1==a.success){var c="lasso-title-saved";b.addClass(c),setTimeout(function(){b.removeClass(c)},500)}}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})})})}(jQuery),function(a){a(document).ready(function(){var b,c;a(document).on("click","#lasso--wpimg-edit",function(d){d.preventDefault();var e=a(this),f=a(this).parent().next("img").attr("class").match(/\d+/);c=d.currentTarget.parentElement.className,b=wp.media.frames.ase_edit_frame=wp.media({title:lasso_editor.strings.selectImage,button:{text:lasso_editor.strings.insertImage},multiple:!1}),b.on("open",function(){var a=b.state().get("selection"),c=wp.media.attachment(f);c.fetch(),a.add(c?[c]:[])}),b.on("select",function(){var c=b.state().get("selection").first().toJSON(),d=void 0===c.sizes.large?c.sizes.full.url:c.sizes.large.url;a(e).parent().next("img").attr({src:d,alt:c.alt,"class":"aligncenter size-large wp-image-"+c.id})}),b.open()})})}(jQuery),function(a){a(document).on("submit","#lasso--post-form",function(b){b.preventDefault();var c=a(this),d=c.find('input[type="submit"]'),e=lasso_editor.strings,f=c.serialize();d.val(e.saving),a.post(lasso_editor.ajaxurl,f,function(a){1==a.success&&(d.val(e.saved).addClass("saved"),console.log(a),setTimeout(function(){d.removeClass("saved"),d.val(e.save)},1e3))}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})})}(jQuery),function(a){jQuery(document).ready(function(a){modalResizer=function(){var b=a(".lasso--modal"),c=b.height(),d=a(window).height(),e=a(".lasso--modal").hasClass("lasso--tour__modal")?0:30;b.css({top:(d-c-e)/2})},a(".lasso--modal").imagesLoaded(function(){modalResizer()}),jQuery(window).resize(function(){modalResizer()})})}(jQuery),function(a,b,c,d,e){function f(){a("#lasso--loading").remove()}function g(){a(t).perfectScrollbar({suppressScrollX:!0})}function h(b){a("#lasso--loading").remove();try{var c=JSON.parse(b.responseText);"rest_post_invalid_page_number"==c.code?(a("#lasso--load-more").remove(),a(t).append(z)):a(t).append(A+'<div style="overflow-y: scroll; height:400px;"><code style="font-size:8px;">'+JSON.stringify(b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</code></div>")}catch(d){a(t).append(A)}}function i(b){var c=lasso_editor.edit_others_posts;if(I=b,"pages"==b&&(c=lasso_editor.edit_others_pages),"posts"==b)M=c?m(b,H):m(b,H,lasso_editor.author),J=new wp.api.collections.Posts,J.fetch(M).done(function(){if(a("#lasso--load-more").remove(),J.length>0){var c=a('<div data-page-num="'+J.state.currentPage+'" class="lasso--object-batch" id="lasso--object-batch-'+H+'"></div>');lasso_editor.restapi2?J.each(function(a){c.append(r({post:a.attributes,link_:a.attributes._links.self[0].href,settings:d}))}):J.each(function(a){c.append(r({post:a.attributes,settings:d}))}),a(t).append(c),a(t).append(D),a(".lasso--post-filtering").removeClass("not-visible").addClass("visible"),a("#lasso--load-more").attr("data-post-type",b).removeClass("lasso--btn-loading"),g()}else a(t).append(z),setTimeout(function(){a("#lasso--end-posts").fadeOut("slow")},1e3);f()}).fail(function(a,b){h(a)});else{var e=c?lasso_editor.author:-1,i=k(!0,H,e);jQuery.ajax({method:"GET",url:d.root+"wp/v2/"+b+i,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",lasso_editor.rest_nonce)},success:function(c){j(c,b),i=k(!1,H,e),jQuery.ajax({method:"GET",url:d.root+"wp/v2/"+b+i,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",lasso_editor.rest_nonce)},success:function(a){j(a,b)},done:function(a){},error:function(b,c){a("#lasso--loading").remove()}})},done:function(a){},error:function(c,e){a("#lasso--loading").remove(),i=k(!1,H,lasso_editor.author),jQuery.ajax({method:"GET",url:d.root+"wp/v2/"+b+i,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",lasso_editor.rest_nonce)},success:function(a){j(a,b)},done:function(a){},error:function(b,c){a("#lasso--loading").remove()}})}}),M=c?l(b,H):l(b,H,lasso_editor.author),jQuery.getJSON(d.root+"wp/v2/"+b,M,function(c){if(a("#lasso--load-more").remove(),c.length>0){var e=a('<div data-page-num="'+H+'" class="lasso--object-batch" id="lasso--object-batch-'+H+'"></div>');jQuery.each(c,function(a,b){e.append(r({post:b,link_:b.link,settings:d}))}),a(t).append(e),c.length>=7&&(a(t).append(D),a("#lasso--load-more").attr("data-post-type",b).removeClass("lasso--btn-loading")),a(".lasso--post-filtering").removeClass("not-visible").addClass("visible"),g()}else a(t).append(z),setTimeout(function(){a("#lasso--end-posts").fadeOut("slow")},1e3);f()}).fail(function(a,b){h(a)})}}function j(b,c){if(a("#lasso--load-more").remove(),b.length>0){var e=a('<div data-page-num="'+H+'" class="lasso--object-batch" id="lasso--object-batch-'+H+'"></div>');jQuery.each(b,function(a,b){e.append(r({post:b,link_:b.link,settings:d}))}),a(t).append(e),b.length>=7&&(a(t).append(D),
a("#lasso--load-more").attr("data-post-type",c).removeClass("lasso--btn-loading")),a(".lasso--post-filtering").removeClass("not-visible").addClass("visible"),g()}else setTimeout(function(){a("#lafesso--end-posts").fadeOut("slow")},1e3);f()}function k(a,b,c){var d="?page="+b;return-1!=c&&(d+="&author[]="+c),a&&(d+="&status[]=draft"),d}function l(a,b,c){return c?{page:b,type:a,author:c,per_page:7}:{page:b,type:a,per_page:7}}function m(a,b,c){return M={data:{page:b,type:a,author:c,status:["publish","draft","pending"],per_page:7,filter:{post_status:["publish","draft","pending"],posts_per_page:7,author:c}}}}function n(){a(F).remove()}function o(b){a(t).children().remove(),i(b),a("#lasso--search-field").val("").focusout(),a("#lasso--results-found").parent().css("opacity",0),a(G).remove(),n()}var p,q=a("#lasso-tmpl--post"),r=c.template(q.html()),s=a("#lasso--post-all"),t="#lasso--post-list",u=lasso_editor.strings.loading,v=lasso_editor.strings.loadMore,w=lasso_editor.strings.noPostsFound,x=lasso_editor.strings.fetchFail,y=a("body"),z='<li id="lasso--end-posts">'+w+"</li>",A='<li id="lasso--end-posts">'+x+"</li>",B=lasso_editor.noResultsDiv,C='<div id="lasso--loading" class="lasso--loading"><div class="lasso--loader"></div></div>',D='<a href="#" id="lasso--load-more">'+v+"</a>",E='<i id="lasso--clear-search" class="dashicons dashicons-dismiss"></i>',F="#lasso--clear-search",G="#lasso--helper",H=1,I="posts",J=!1,K=null,L=d.root,M={data:{page:H,filter:{post_status:["publish","draft","pending"]}}};a("a").attr("contenteditable",!1),a(s).on("click",function(a){a.preventDefault(),y.toggleClass("lasso-modal-open"),y.append(lasso_editor.allPostModal),i("posts"),modalResizer()}),a(y).on("click","#lasso--load-more",function(b){b.preventDefault(),type=a(this).attr("data-post-type"),a(this).addClass("lasso--btn-loading").text(u),I==type?H++:H=1,I=type,i(type)}).on("click",".lasso--show-objects",function(b){b.preventDefault(),a(".lasso--show-objects").removeClass("active"),a(this).addClass("active"),a("#lasso--post-list").empty(),type=a(this).data("post-type"),H=1,K=null,a("#lasso--load-more").attr("data-post-type",type),a(t).prepend(C),i(type)}).on("click","#lasso--post__delete",function(b){b.preventDefault();var c=a(this);swal({title:lasso_editor.strings.deletePost,type:"error",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:lasso_editor.strings.deleteYes,closeOnConfirm:!0},function(){var b={action:"process_delete_post",postid:c.closest("a").data("postid"),nonce:lasso_editor.deletePost};a.post(lasso_editor.ajaxurl,b,function(a){1==a.success&&c.closest("li").fadeOut().remove()}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})})}).on("keyup","#lasso--search-field",function(b){clearTimeout(p);var c=b.which,e=this,f=a.trim(a(this).val()),h=f==a(e).val(),i=""!==f,j=a(".active.lasso--show-objects").data("post-type"),k=L+"/"+j+"s?filter[s]="+f+"&filter[posts_per_page]=50",l="#lasso--search-field",m=a("#lasso--results-found"),o=lasso_editor.strings.helperText,q='<span id="lasso--helper">'+o+"</span>";p=setTimeout(function(){return h||i?(2!=f.length||a(G).length||(n(),a(l).after(q)),void((f.length>=3||f.length>=3&&13==c)&&(a(t).prepend(C),a(G).fadeOut().remove(),n(),a.getJSON(k,function(b){a(t).children().remove(),m.parent().css("opacity",1),0==b.length?(m.text("0"),a("#lasso--empty-results").length||a(t).prepend(B),n()):(a(F).length||a(l).after(E),m.text(b.length),a.each(b,function(c){a(t).append(r({post:b[c],settings:d}))}),g())})))):!1},600)}).on("click","#lasso--search__toggle",function(b){b.preventDefault();var c=a("#lasso--search-field");a(".lasso--search").toggleClass("lasso--search__visible"),c.focus(),a(this).parent().hasClass("lasso--search__visible")||""===c.val()||o("post")}).on("click",F,function(a){a.preventDefault(),o("post")}),jQuery(document).on("click","#lasso--post-list",function(b){"lasso--post-list"===b.target.id&&(a("#lasso--all-posts__modal").remove(),a("#lasso--modal__overlay").remove(),a("body").remove("#lasso--modal__overlay"))})}(jQuery,Backbone,_,WP_API_Settings),function(a){a(document).ready(function(){destroyModal=function(){a("body").removeClass("lasso-modal-open"),a("#lasso--tour__modal,#lasso--tour__modal ~ #lasso--modal__overlay").remove()},jQuery(document).on("click",'#lasso--tour__modal input[type="submit"]',function(b){b.preventDefault();a(this);if(a("#hide_tour").is(":checked"))if(lasso_editor.saveusingrest){var c={action:"process_tour_hide",nonce:a(this).data("nonce")};a.post(lasso_editor.ajaxurl,c,function(a){1==a.success&&destroyModal()}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})}else{var c={action:"process_tour_hide",nonce:a(this).data("nonce")};a.post(lasso_editor.ajaxurl,c,function(a){1==a.success&&destroyModal()}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))})}else destroyModal()})})}(jQuery),function(a){jQuery(document).ready(function(a){a("#lasso--tour__slides").length&&(a("body").addClass("lasso-modal-open"),a(".lasso--loading").remove(),a("#lasso--tour__slides").hide().fadeIn(),a("#lasso--tour__slides").unslider({dots:!0,delay:7e3}))})}(jQuery),function(a){a(document).ready(function(){function b(){a("#lasso--loading").remove()}function c(){a("body").data("revision")&&slider.slider("value",a("body").data("revision"))}function d(){a("#lasso--notice").length||a(g.article_object).before('<div id="lasso--notice" class="lasso--notice lasso--notice-warning">'+g.strings.editingBackup+"</div>")}function e(){a("body").removeClass(function(a,b){return(b.match(/(^|\s)lasso--revision-count-\S+/g)||[]).join(" ")})}var f,g=lasso_editor;revisionList=a("#lasso--revision-list");var h=function(){a("body").removeClass("lasso-modal-open"),a("#lasso--revision__modal").remove(),a("#lasso--post-revisions").show()},i=function(b){b in f&&(revision=f[b],a(g.titleClass).html(revision.post_title),a(g.article_object).html(revision.post_content),a("body").attr("data-revision",b))};a("#lasso--post-revisions").on("click",function(d){d.preventDefault(),a(this).hide(),a("body").append(g.revisionModal),innerModal=a("#lasso--revision__modal .lasso--modal__inner"),innerModal.draggable({cursor:"move",opacity:.8}),data={action:"process_revision_get",postid:g.postid,nonce:g.nonce},a.post(g.ajaxurl,data,function(d){if(1==d.success)if(revisionList=a("#lasso--revision-list"),slider=a("#lasso--slider"),lassoHide=a("#lasso--hide"),e(),b(),lassoHide.show(),"object"==typeof d.data&&d.data.length){f=d.data;var h=1==f.length?1:f.length-1;1!==f.length?(a.each(f,function(a,b){revisionList.append('<li class="lasso--jump-revision" data-revision="'+a+'"><span class="lasso-util--help lasso-util--help-top" data-tooltip="'+b.modified_date+'">'+b.modified_time+"</span></li>")}),slider.slider({min:0,max:h,animate:"fast",value:0,zindex:999,slide:function(a,b){i(b.value)}}),a(".lasso--jump-revision").on("click",function(b){b.preventDefault();var c=a(this).data("revision");slider.slider("value",c),i(c)}),revisionList.attr("data-count",h+1)):(lassoHide.hide(),innerModal.append(g.noRevisionsDiv)),a("body").addClass("lasso--revision-count-"+f.length),c(),modalResizer()}else a("#lasso--hide").hide(),innerModal.append(g.noRevisionsDiv),modalResizer();else alert("error")}).fail(function(b,c){var d=a(b.responseText).filter("title").get(0);alert(a(d).text()+"\n"+EditusFormatAJAXErrorMessage(b,c))}),modalResizer()}),a(document).on("click","#lasso--select-revision",function(b){b.preventDefault(),h(),a("#lasso--edit").trigger("click"),d()}).on("click","#lasso--close-modal",function(a){a.preventDefault(),h()}),a(document).keyup(function(a){27==a.keyCode&&h()})})}(jQuery);
//# sourceMappingURL=lasso.js.map