(function(){function a(a,b){var c,d;for(c in b)d=b[c],void 0!==d&&(a[c]=d);return a}var b,c=function(){},d=function(b,d){var e;return e=d&&d.hasOwnProperty("constructor")?d.constructor:function(){return b.apply(this,arguments)},c.prototype=b.prototype,e.prototype=new c,d&&a(e.prototype,d),e.prototype.constructor=e,e.__super__=b.prototype,e};b="undefined"!=typeof exports?exports:this.Undo={},b.Stack=function(){this.commands=[],this.stackPosition=-1,this.savePosition=-1},a(b.Stack.prototype,{execute:function(a){this._clearRedo(),a.execute(),this.commands.push(a),this.stackPosition++,this.changed()},undo:function(){this.commands[this.stackPosition].undo(),this.stackPosition--,this.changed()},canUndo:function(){return this.stackPosition>=0},redo:function(){this.stackPosition++,this.commands[this.stackPosition].redo(),this.changed()},canRedo:function(){return this.stackPosition<this.commands.length-1},save:function(){this.savePosition=this.stackPosition,this.changed()},dirty:function(){return this.stackPosition!=this.savePosition},_clearRedo:function(){this.commands=this.commands.slice(0,this.stackPosition+1)},changed:function(){}}),b.Command=function(a){this.name=a};var e=new Error("override me!");a(b.Command.prototype,{execute:function(){throw e},undo:function(){throw e},redo:function(){this.execute()}}),b.Command.extend=function(a){var c=d(this,a);return c.extend=b.Command.extend,c}}).call(this),function(a,b){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a():b.rangy=a()}(function(){function a(a,b){var c=typeof a[b];return c==s||!(c!=r||!a[b])||"unknown"==c}function b(a,b){return!(typeof a[b]!=r||!a[b])}function c(a,b){return typeof a[b]!=t}function d(a){return function(b,c){for(var d=c.length;d--;)if(!a(b,c[d]))return!1;return!0}}function e(a){return a&&y(a,x)&&A(a,w)}function f(a){return b(a,"body")?a.body:a.getElementsByTagName("body")[0]}function g(b){typeof console!=t&&a(console,"log")&&console.log(b)}function h(a,b){C&&b?alert(a):g(a)}function i(a){E.initialized=!0,E.supported=!1,h("Rangy is not supported in this environment. Reason: "+a,E.config.alertOnFail)}function j(a){h("Rangy warning: "+a,E.config.alertOnWarn)}function k(a){return a.message||a.description||String(a)}function l(){if(C&&!E.initialized){var b,c=!1,d=!1;a(document,"createRange")&&(b=document.createRange(),y(b,v)&&A(b,u)&&(c=!0));var h=f(document);if(!h||"body"!=h.nodeName.toLowerCase())return void i("No body element found");if(h&&a(h,"createTextRange")&&(b=h.createTextRange(),e(b)&&(d=!0)),!c&&!d)return void i("Neither Range nor TextRange are available");E.initialized=!0,E.features={implementsDomRange:c,implementsTextRange:d};var j,l;for(var m in B)(j=B[m])instanceof n&&j.init(j,E);for(var o=0,p=H.length;p>o;++o)try{H[o](E)}catch(q){l="Rangy init listener threw an exception. Continuing. Detail: "+k(q),g(l)}}}function m(a){a=a||window,l();for(var b=0,c=I.length;c>b;++b)I[b](a)}function n(a,b,c){this.name=a,this.dependencies=b,this.initialized=!1,this.supported=!1,this.initializer=c}function o(a,b,c){var d=new n(a,b,function(b){if(!b.initialized){b.initialized=!0;try{c(E,b),b.supported=!0}catch(d){var e="Module '"+a+"' failed to load: "+k(d);g(e)}}});return B[a]=d,d}function p(){}function q(){}var r="object",s="function",t="undefined",u=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],v=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],w=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],x=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],y=d(a),z=d(b),A=d(c),B={},C=typeof window!=t&&typeof document!=t,D={isHostMethod:a,isHostObject:b,isHostProperty:c,areHostMethods:y,areHostObjects:z,areHostProperties:A,isTextRange:e,getBody:f},E={version:"1.3.0-alpha.20140827",initialized:!1,isBrowser:C,supported:!0,util:D,features:{},modules:B,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==t?!0:rangyAutoInitialize}};E.fail=i,E.warn=j;var F;({}).hasOwnProperty?(D.extend=F=function(a,b,c){var d,e;for(var f in b)b.hasOwnProperty(f)&&(d=a[f],e=b[f],c&&null!==d&&"object"==typeof d&&null!==e&&"object"==typeof e&&F(d,e,!0),a[f]=e);return b.hasOwnProperty("toString")&&(a.toString=b.toString),a},D.createOptions=function(a,b){var c={};return F(c,b),a&&F(c,a,!0),c}):i("hasOwnProperty not supported"),C||i("Rangy can only run in a browser"),function(){var a;if(C){var b=document.createElement("div");b.appendChild(document.createElement("span"));var c=[].slice;try{1==c.call(b.childNodes,0)[0].nodeType&&(a=function(a){return c.call(a,0)})}catch(d){}}a||(a=function(a){for(var b=[],c=0,d=a.length;d>c;++c)b[c]=a[c];return b}),D.toArray=a}();var G;C&&(a(document,"addEventListener")?G=function(a,b,c){a.addEventListener(b,c,!1)}:a(document,"attachEvent")?G=function(a,b,c){a.attachEvent("on"+b,c)}:i("Document does not have required addEventListener or attachEvent method"),D.addListener=G);var H=[];E.init=l,E.addInitListener=function(a){E.initialized?a(E):H.push(a)};var I=[];E.addShimListener=function(a){I.push(a)},C&&(E.shim=E.createMissingNativeApi=m),n.prototype={init:function(){for(var a,b,c=this.dependencies||[],d=0,e=c.length;e>d;++d){if(b=c[d],a=B[b],!(a&&a instanceof n))throw new Error("required module '"+b+"' not found");if(a.init(),!a.supported)throw new Error("required module '"+b+"' not supported")}this.initializer(this)},fail:function(a){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+a)},warn:function(a){E.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,b){E.warn("DEPRECATED: "+a+" in module "+this.name+"is deprecated. Please use "+b+" instead")},createError:function(a){return new Error("Error in Rangy "+this.name+" module: "+a)}},E.createModule=function(a){var b,c;2==arguments.length?(b=arguments[1],c=[]):(b=arguments[2],c=arguments[1]);var d=o(a,c,b);E.initialized&&E.supported&&d.init()},E.createCoreModule=function(a,b,c){o(a,b,c)},E.RangePrototype=p,E.rangePrototype=new p,E.selectionPrototype=new q,E.createCoreModule("DomUtil",[],function(a,b){function c(a){var b;return typeof a.namespaceURI==D||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b}function d(a){var b=a.parentNode;return 1==b.nodeType?b:null}function e(a){for(var b=0;a=a.previousSibling;)++b;return b}function f(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}}function g(a,b){var c,d=[];for(c=a;c;c=c.parentNode)d.push(c);for(c=b;c;c=c.parentNode)if(H(d,c))return c;return null}function h(a,b,c){for(var d=c?b:b.parentNode;d;){if(d===a)return!0;d=d.parentNode}return!1}function i(a,b){return h(a,b,!0)}function j(a,b,c){for(var d,e=c?a:a.parentNode;e;){if(d=e.parentNode,d===b)return e;e=d}return null}function k(a){var b=a.nodeType;return 3==b||4==b||8==b}function l(a){if(!a)return!1;var b=a.nodeType;return 3==b||8==b}function m(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function n(a,b,c){var d=a.cloneNode(!1);if(d.deleteData(0,b),a.deleteData(b,a.length-b),m(d,a),c)for(var f,g=0;f=c[g++];)f.node==a&&f.offset>b?(f.node=d,f.offset-=b):f.node==a.parentNode&&f.offset>e(a)&&++f.offset;return d}function o(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=D)return a.ownerDocument;if(typeof a.document!=D)return a.document;if(a.parentNode)return o(a.parentNode);throw b.createError("getDocument: no document found for node")}function p(a){var c=o(a);if(typeof c.defaultView!=D)return c.defaultView;if(typeof c.parentWindow!=D)return c.parentWindow;throw b.createError("Cannot get a window object for node")}function q(a){if(typeof a.contentDocument!=D)return a.contentDocument;if(typeof a.contentWindow!=D)return a.contentWindow.document;throw b.createError("getIframeDocument: No Document object found for iframe element")}function r(a){if(typeof a.contentWindow!=D)return a.contentWindow;if(typeof a.contentDocument!=D)return a.contentDocument.defaultView;throw b.createError("getIframeWindow: No Window object found for iframe element")}function s(a){return a&&E.isHostMethod(a,"setTimeout")&&E.isHostObject(a,"document")}function t(a,b,c){var d;if(a?E.isHostProperty(a,"nodeType")?d=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?q(a):o(a):s(a)&&(d=a.document):d=document,!d)throw b.createError(c+"(): Parameter must be a Window object or DOM node");return d}function u(a){for(var b;b=a.parentNode;)a=b;return a}function v(a,c,d,f){var h,i,k,l,m;if(a==d)return c===f?0:f>c?-1:1;if(h=j(d,a,!0))return c<=e(h)?-1:1;if(h=j(a,d,!0))return e(h)<f?-1:1;if(i=g(a,d),!i)throw new Error("comparePoints error: nodes have no common ancestor");if(k=a===i?i:j(a,i,!0),l=d===i?i:j(d,i,!0),k===l)throw b.createError("comparePoints got to case 4 and childA and childB are the same!");for(m=i.firstChild;m;){if(m===k)return-1;if(m===l)return 1;m=m.nextSibling}}function w(a){var b;try{return b=a.parentNode,!1}catch(c){return!0}}function x(a){if(!a)return"[No node]";if(I&&w(a))return"[Broken node]";if(k(a))return'"'+a.data+'"';if(1==a.nodeType){var b=a.id?' id="'+a.id+'"':"";return"<"+a.nodeName+b+">[index:"+e(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return a.nodeName}function y(a){for(var b,c=o(a).createDocumentFragment();b=a.firstChild;)c.appendChild(b);return c}function z(a){this.root=a,this._next=a}function A(a){return new z(a)}function B(a,b){this.node=a,this.offset=b}function C(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var D="undefined",E=a.util;E.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),E.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var F=document.createElement("div");E.areHostMethods(F,["insertBefore","appendChild","cloneNode"]||!E.areHostObjects(F,["previousSibling","nextSibling","childNodes","parentNode"]))||b.fail("Incomplete Element implementation"),E.isHostProperty(F,"innerHTML")||b.fail("Element is missing innerHTML property");var G=document.createTextNode("test");E.areHostMethods(G,["splitText","deleteData","insertData","appendData","cloneNode"]||!E.areHostObjects(F,["previousSibling","nextSibling","childNodes","parentNode"])||!E.areHostProperties(G,["data"]))||b.fail("Incomplete Text Node implementation");var H=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},I=!1;!function(){var b=document.createElement("b");b.innerHTML="1";var c=b.firstChild;b.innerHTML="<br>",I=w(c),a.features.crashyTextNodes=I}();var J;typeof window.getComputedStyle!=D?J=function(a,b){return p(a).getComputedStyle(a,null)[b]}:typeof document.documentElement.currentStyle!=D?J=function(a,b){return a.currentStyle[b]}:b.fail("No means of obtaining computed style properties found"),z.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a,b,c=this._current=this._next;if(this._current)if(a=c.firstChild)this._next=a;else{for(b=null;c!==this.root&&!(b=c.nextSibling);)c=c.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}},B.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+x(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},C.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},C.prototype.toString=function(){return this.message},a.dom={arrayContains:H,isHtmlNamespace:c,parentElement:d,getNodeIndex:e,getNodeLength:f,getCommonAncestor:g,isAncestorOf:h,isOrIsAncestorOf:i,getClosestAncestorIn:j,isCharacterDataNode:k,isTextOrCommentNode:l,insertAfter:m,splitDataNode:n,getDocument:o,getWindow:p,getIframeWindow:r,getIframeDocument:q,getBody:E.getBody,isWindow:s,getContentDocument:t,getRootContainer:u,comparePoints:v,isBrokenNode:w,inspectNode:x,getComputedStyleProperty:J,fragmentFromNodeChildren:y,createIterator:A,DomPosition:B},a.DOMException=C}),E.createCoreModule("DomRange",["DomUtil"],function(a){function b(a,b){return 3!=a.nodeType&&(O(a,b.startContainer)||O(a,b.endContainer))}function c(a){return a.document||P(a.startContainer)}function d(a){return new K(a.parentNode,N(a))}function e(a){return new K(a.parentNode,N(a)+1)}function f(a,b,c){var d=11==a.nodeType?a.firstChild:a;return M(b)?c==b.length?I.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:R(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function g(a,b,d){if(y(a),y(b),c(b)!=c(a))throw new L("WRONG_DOCUMENT_ERR");var e=Q(a.startContainer,a.startOffset,b.endContainer,b.endOffset),f=Q(a.endContainer,a.endOffset,b.startContainer,b.startOffset);return d?0>=e&&f>=0:0>e&&f>0}function h(a){for(var b,d,e,f=c(a.range).createDocumentFragment();d=a.next();){if(b=a.isPartiallySelectedSubtree(),d=d.cloneNode(!b),b&&(e=a.getSubtreeIterator(),d.appendChild(h(e)),e.detach()),10==d.nodeType)throw new L("HIERARCHY_REQUEST_ERR");f.appendChild(d)}return f}function i(a,b,c){var d,e;c=c||{stop:!1};for(var f,g;f=a.next();)if(a.isPartiallySelectedSubtree()){if(b(f)===!1)return void(c.stop=!0);if(g=a.getSubtreeIterator(),i(g,b,c),g.detach(),c.stop)return}else for(d=I.createIterator(f);e=d.next();)if(b(e)===!1)return void(c.stop=!0)}function j(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),j(b),b.detach()):a.remove()}function k(a){for(var b,d,e=c(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),d=a.getSubtreeIterator(),b.appendChild(k(d)),d.detach()):a.remove(),10==b.nodeType)throw new L("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function l(a,b,c){var d,e=!(!b||!b.length),f=!!c;e&&(d=new RegExp("^("+b.join("|")+")$"));var g=[];return i(new n(a,!1),function(b){if(!(e&&!d.test(b.nodeType)||f&&!c(b))){var h=a.startContainer;if(b!=h||!M(h)||a.startOffset!=h.length){var i=a.endContainer;b==i&&M(i)&&0==a.endOffset||g.push(b)}}}),g}function m(a){var b="undefined"==typeof a.getName?"Range":a.getName();return"["+b+"("+I.inspectNode(a.startContainer)+":"+a.startOffset+", "+I.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function n(a,b){if(this.range=a,this.clonePartiallySelectedTextNodes=b,!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&M(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||M(this.sc)?S(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||M(this.ec)?S(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function o(a){return function(b,c){for(var d,e=c?b:b.parentNode;e;){if(d=e.nodeType,U(a,d))return e;e=e.parentNode}return null}}function p(a,b){if(cb(a,b))throw new L("INVALID_NODE_TYPE_ERR")}function q(a,b){if(!U(b,a.nodeType))throw new L("INVALID_NODE_TYPE_ERR")}function r(a,b){if(0>b||b>(M(a)?a.length:a.childNodes.length))throw new L("INDEX_SIZE_ERR")}function s(a,b){if(ab(a,!0)!==ab(b,!0))throw new L("WRONG_DOCUMENT_ERR")}function t(a){if(bb(a,!0))throw new L("NO_MODIFICATION_ALLOWED_ERR")}function u(a,b){if(!a)throw new L(b)}function v(a){return W&&I.isBrokenNode(a)||!U(Y,a.nodeType)&&!ab(a,!0)}function w(a,b){return b<=(M(a)?a.length:a.childNodes.length)}function x(a){return!!a.startContainer&&!!a.endContainer&&!v(a.startContainer)&&!v(a.endContainer)&&w(a.startContainer,a.startOffset)&&w(a.endContainer,a.endOffset)}function y(a){if(!x(a))throw new Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")")}function z(a,b){y(a);var c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset,g=c===e;M(e)&&f>0&&f<e.length&&R(e,f,b),M(c)&&d>0&&d<c.length&&(c=R(c,d,b),g?(f-=d,e=c):e==c.parentNode&&f>=N(c)&&f++,d=0),a.setStartAndEnd(c,d,e,f)}function A(a){y(a);var b=a.commonAncestorContainer.parentNode.cloneNode(!1);return b.appendChild(a.cloneContents()),b.innerHTML}function B(a){a.START_TO_START=ib,a.START_TO_END=jb,a.END_TO_END=kb,a.END_TO_START=lb,a.NODE_BEFORE=mb,a.NODE_AFTER=nb,a.NODE_BEFORE_AND_AFTER=ob,a.NODE_INSIDE=pb}function C(a){B(a),B(a.prototype)}function D(a,b){return function(){y(this);var c,d,f=this.startContainer,g=this.startOffset,h=this.commonAncestorContainer,j=new n(this,!0);f!==h&&(c=S(f,h,!0),d=e(c),f=d.node,g=d.offset),i(j,t),j.reset();var k=a(j);return j.detach(),b(this,f,g,f,g),k}}function E(c,f){function g(a,b){return function(c){q(c,X),q(V(c),Y);var f=(a?d:e)(c);(b?h:i)(this,f.node,f.offset)}}function h(a,b,c){var d=a.endContainer,e=a.endOffset;(b!==a.startContainer||c!==a.startOffset)&&((V(b)!=V(d)||1==Q(b,c,d,e))&&(d=b,e=c),f(a,b,c,d,e))}function i(a,b,c){var d=a.startContainer,e=a.startOffset;(b!==a.endContainer||c!==a.endOffset)&&((V(b)!=V(d)||-1==Q(b,c,d,e))&&(d=b,e=c),f(a,d,e,b,c))}var l=function(){};l.prototype=a.rangePrototype,c.prototype=new l,J.extend(c.prototype,{setStart:function(a,b){p(a,!0),r(a,b),h(this,a,b)},setEnd:function(a,b){p(a,!0),r(a,b),i(this,a,b)},setStartAndEnd:function(){var a=arguments,b=a[0],c=a[1],d=b,e=c;switch(a.length){case 3:e=a[2];break;case 4:d=a[2],e=a[3]}f(this,b,c,d,e)},setBoundary:function(a,b,c){this["set"+(c?"Start":"End")](a,b)},setStartBefore:g(!0,!0),setStartAfter:g(!1,!0),setEndBefore:g(!0,!1),setEndAfter:g(!1,!1),collapse:function(a){y(this),a?f(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):f(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){p(a,!0),f(this,a,0,a,T(a))},selectNode:function(a){p(a,!1),q(a,X);var b=d(a),c=e(a);f(this,b.node,b.offset,c.node,c.offset)},extractContents:D(k,f),deleteContents:D(j,f),canSurroundContents:function(){y(this),t(this.startContainer),t(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},splitBoundaries:function(){z(this)},splitBoundariesPreservingPositions:function(a){z(this,a)},normalizeBoundaries:function(){y(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,d=this.endOffset,e=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(c=a,d=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},g=function(e){var f=e.previousSibling;if(f&&f.nodeType==e.nodeType){a=e;var g=e.length;if(b=f.length,e.insertData(0,f.data),f.parentNode.removeChild(f),a==c)d+=b,c=a;else if(c==e.parentNode){var h=N(e);d==h?(c=e,d=g):d>h&&d--}}},h=!0;if(M(c))c.length==d&&e(c);else{if(d>0){var i=c.childNodes[d-1];i&&M(i)&&e(i)}h=!this.collapsed}if(h){if(M(a))0==b&&g(a);else if(b<a.childNodes.length){var j=a.childNodes[b];j&&M(j)&&g(j)}}else a=c,b=d;f(this,a,b,c,d)},collapseToPoint:function(a,b){p(a,!0),r(a,b),this.setStartAndEnd(a,b)}}),C(c)}function F(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:I.getCommonAncestor(a.startContainer,a.endContainer)}function G(a,b,c,d,e){a.startContainer=b,a.startOffset=c,a.endContainer=d,a.endOffset=e,a.document=I.getDocument(b),F(a)}function H(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this.document=a,F(this)}var I=a.dom,J=a.util,K=I.DomPosition,L=a.DOMException,M=I.isCharacterDataNode,N=I.getNodeIndex,O=I.isOrIsAncestorOf,P=I.getDocument,Q=I.comparePoints,R=I.splitDataNode,S=I.getClosestAncestorIn,T=I.getNodeLength,U=I.arrayContains,V=I.getRootContainer,W=a.features.crashyTextNodes;n.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,M(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a,b,c=this._current;!M(c)||c!==this.sc&&c!==this.ec?c.parentNode&&c.parentNode.removeChild(c):(a=c===this.sc?this.so:0,b=c===this.ec?this.eo:c.length,a!=b&&c.deleteData(a,b-a))},isPartiallySelectedSubtree:function(){var a=this._current;return b(a,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new H(c(this.range));var b=this._current,d=b,e=0,f=b,g=T(b);O(b,this.sc)&&(d=this.sc,e=this.so),O(b,this.ec)&&(f=this.ec,g=this.eo),G(a,d,e,f,g)}return new n(a,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var X=[1,3,4,5,7,8,10],Y=[2,9,11],Z=[5,6,10,12],$=[1,3,4,5,7,8,10,11],_=[1,3,4,5,7,8],ab=o([9,11]),bb=o(Z),cb=o([6,10,12]),db=document.createElement("style"),eb=!1;try{db.innerHTML="<b>x</b>",eb=3==db.firstChild.nodeType}catch(fb){}a.features.htmlParsingConforms=eb;var gb=eb?function(a){var b=this.startContainer,c=P(b);if(!b)throw new L("INVALID_STATE_ERR");var d=null;return 1==b.nodeType?d=b:M(b)&&(d=I.parentElement(b)),d=null===d||"HTML"==d.nodeName&&I.isHtmlNamespace(P(d).documentElement)&&I.isHtmlNamespace(d)?c.createElement("body"):d.cloneNode(!1),d.innerHTML=a,I.fragmentFromNodeChildren(d)}:function(a){var b=c(this),d=b.createElement("body");return d.innerHTML=a,I.fragmentFromNodeChildren(d)},hb=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ib=0,jb=1,kb=2,lb=3,mb=0,nb=1,ob=2,pb=3;J.extend(a.rangePrototype,{compareBoundaryPoints:function(a,b){y(this),s(this.startContainer,b.startContainer);var c,d,e,f,g=a==lb||a==ib?"start":"end",h=a==jb||a==ib?"start":"end";return c=this[g+"Container"],d=this[g+"Offset"],e=b[h+"Container"],f=b[h+"Offset"],Q(c,d,e,f)},insertNode:function(a){if(y(this),q(a,$),t(this.startContainer),O(a,this.startContainer))throw new L("HIERARCHY_REQUEST_ERR");var b=f(a,this.startContainer,this.startOffset);this.setStartBefore(b)},cloneContents:function(){y(this);var a,b;if(this.collapsed)return c(this).createDocumentFragment();if(this.startContainer===this.endContainer&&M(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=c(this).createDocumentFragment(),b.appendChild(a),b;var d=new n(this,!0);return a=h(d),d.detach(),a},canSurroundContents:function(){y(this),t(this.startContainer),t(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},surroundContents:function(a){if(q(a,_),!this.canSurroundContents())throw new L("INVALID_STATE_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);f(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){y(this);for(var a,b=new H(c(this)),d=hb.length;d--;)a=hb[d],b[a]=this[a];return b},toString:function(){y(this);var a=this.startContainer;if(a===this.endContainer&&M(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],c=new n(this,!0);return i(c,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)}),c.detach(),b.join("")},compareNode:function(a){y(this);var b=a.parentNode,c=N(a);if(!b)throw new L("NOT_FOUND_ERR");var d=this.comparePoint(b,c),e=this.comparePoint(b,c+1);return 0>d?e>0?ob:mb:e>0?nb:pb},comparePoint:function(a,b){return y(this),u(a,"HIERARCHY_REQUEST_ERR"),s(a,this.startContainer),Q(a,b,this.startContainer,this.startOffset)<0?-1:Q(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:gb,toHtml:function(){return A(this)},intersectsNode:function(a,b){if(y(this),u(a,"NOT_FOUND_ERR"),P(a)!==c(this))return!1;var d=a.parentNode,e=N(a);u(d,"NOT_FOUND_ERR");var f=Q(d,e,this.endContainer,this.endOffset),g=Q(d,e+1,this.startContainer,this.startOffset);return b?0>=f&&g>=0:0>f&&g>0},isPointInRange:function(a,b){return y(this),u(a,"HIERARCHY_REQUEST_ERR"),s(a,this.startContainer),Q(a,b,this.startContainer,this.startOffset)>=0&&Q(a,b,this.endContainer,this.endOffset)<=0},intersectsRange:function(a){return g(this,a,!1)},intersectsOrTouchesRange:function(a){return g(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var b=Q(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=Q(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return-1==b&&d.setStart(a.startContainer,a.startOffset),1==c&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var b=this.cloneRange();return-1==Q(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==Q(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),b}throw new L("Ranges do not intersect")},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==pb},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&this.comparePoint(a,T(a))<=0},containsRange:function(a){var b=this.intersection(a);return null!==b&&a.equals(b)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);if(c.length>0){b.setStart(c[0],0);var d=c.pop();return b.setEnd(d,d.length),this.containsRange(b)}return this.containsNodeContents(a)},getNodes:function(a,b){return y(this),l(this,a,b)},getDocument:function(){return c(this)},collapseBefore:function(a){this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){this.setStartAfter(a),this.collapse(!0)},getBookmark:function(b){var d=c(this),e=a.createRange(d);b=b||I.getBody(d),e.selectNodeContents(b);var f=this.intersection(e),g=0,h=0;return f&&(e.setEnd(f.startContainer,f.startOffset),g=e.toString().length,h=g+f.toString().length),{start:g,end:h,containerNode:b}},moveToBookmark:function(a){var b=a.containerNode,c=0;this.setStart(b,0),this.collapse(!0);for(var d,e,f,g,h=[b],i=!1,j=!1;!j&&(d=h.pop());)if(3==d.nodeType)e=c+d.length,!i&&a.start>=c&&a.start<=e&&(this.setStart(d,a.start-c),i=!0),i&&a.end>=c&&a.end<=e&&(this.setEnd(d,a.end-c),j=!0),c=e;else for(g=d.childNodes,f=g.length;f--;)h.push(g[f])},getName:function(){return"DomRange"},equals:function(a){return H.rangesEqual(this,a)},isValid:function(){return x(this)},inspect:function(){return m(this)},detach:function(){}}),E(H,G),J.extend(H,{rangeProperties:hb,RangeIterator:n,copyComparisonConstants:C,createPrototypeRange:E,inspect:m,toHtml:A,getRangeDocument:c,rangesEqual:function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset}}),a.DomRange=H}),E.createCoreModule("WrappedRange",["DomRange"],function(a,b){var c,d,e=a.dom,f=a.util,g=e.DomPosition,h=a.DomRange,i=e.getBody,j=e.getContentDocument,k=e.isCharacterDataNode;if(a.features.implementsDomRange&&!function(){function d(a){for(var b,c=m.length;c--;)b=m[c],a[b]=a.nativeRange[b];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}function g(a,b,c,d,e){var f=a.startContainer!==b||a.startOffset!=c,g=a.endContainer!==d||a.endOffset!=e,h=!a.equals(a.nativeRange);(f||g||h)&&(a.setEnd(d,e),a.setStart(b,c))}var k,l,m=h.rangeProperties;c=function(a){if(!a)throw b.createError("WrappedRange: Range must be specified");this.nativeRange=a,d(this)},h.createPrototypeRange(c,g),k=c.prototype,k.selectNode=function(a){this.nativeRange.selectNode(a),d(this)},k.cloneContents=function(){return this.nativeRange.cloneContents()},k.surroundContents=function(a){this.nativeRange.surroundContents(a),d(this)},k.collapse=function(a){this.nativeRange.collapse(a),d(this)},k.cloneRange=function(){return new c(this.nativeRange.cloneRange())},k.refresh=function(){d(this)},k.toString=function(){return this.nativeRange.toString()};var n=document.createTextNode("test");i(document).appendChild(n);var o=document.createRange();o.setStart(n,0),o.setEnd(n,0);try{o.setStart(n,1),k.setStart=function(a,b){this.nativeRange.setStart(a,b),d(this)},k.setEnd=function(a,b){this.nativeRange.setEnd(a,b),d(this)},l=function(a){return function(b){this.nativeRange[a](b),d(this)}}}catch(p){k.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(c){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}d(this)},k.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(c){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,b)}d(this)},l=function(a,b){return function(c){try{this.nativeRange[a](c)}catch(e){this.nativeRange[b](c),this.nativeRange[a](c)}d(this)}}}k.setStartBefore=l("setStartBefore","setEndBefore"),k.setStartAfter=l("setStartAfter","setEndAfter"),k.setEndBefore=l("setEndBefore","setStartBefore"),k.setEndAfter=l("setEndAfter","setStartAfter"),k.selectNodeContents=function(a){this.setStartAndEnd(a,0,e.getNodeLength(a))},o.selectNodeContents(n),o.setEnd(n,3);var q=document.createRange();q.selectNodeContents(n),q.setEnd(n,4),q.setStart(n,2),k.compareBoundaryPoints=-1==o.compareBoundaryPoints(o.START_TO_END,q)&&1==o.compareBoundaryPoints(o.END_TO_START,q)?function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};var r=document.createElement("div");r.innerHTML="123";var s=r.firstChild,t=i(document);t.appendChild(r),o.setStart(s,1),o.setEnd(s,2),o.deleteContents(),"13"==s.data&&(k.deleteContents=function(){this.nativeRange.deleteContents(),d(this)},k.extractContents=function(){var a=this.nativeRange.extractContents();return d(this),a}),t.removeChild(r),t=null,f.isHostMethod(o,"createContextualFragment")&&(k.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)}),i(document).removeChild(n),k.getName=function(){return"WrappedRange"},a.WrappedRange=c,a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),a.createRange()}}(),a.features.implementsTextRange){var l=function(a){var b=a.parentElement(),c=a.duplicate();c.collapse(!0);var d=c.parentElement();c=a.duplicate(),c.collapse(!1);var f=c.parentElement(),g=d==f?d:e.getCommonAncestor(d,f);return g==b?g:e.getCommonAncestor(b,g)},m=function(a){return 0==a.compareEndPoints("StartToEnd",a)},n=function(a,b,c,d,f){var h=a.duplicate();h.collapse(c);var i=h.parentElement();if(e.isOrIsAncestorOf(b,i)||(i=b),!i.canHaveHTML){var j=new g(i.parentNode,e.getNodeIndex(i));return{boundaryPosition:j,nodeInfo:{nodeIndex:j.offset,containerElement:j.node}}}var l=e.getDocument(i).createElement("span");l.parentNode&&l.parentNode.removeChild(l);for(var m,n,o,p,q,r=c?"StartToStart":"StartToEnd",s=f&&f.containerElement==i?f.nodeIndex:0,t=i.childNodes.length,u=t,v=u;;){if(v==t?i.appendChild(l):i.insertBefore(l,i.childNodes[v]),h.moveToElementText(l),m=h.compareEndPoints(r,a),0==m||s==u)break;if(-1==m){if(u==s+1)break;s=v}else u=u==s+1?s:v;v=Math.floor((s+u)/2),i.removeChild(l)}if(q=l.nextSibling,-1==m&&q&&k(q)){h.setEndPoint(c?"EndToStart":"EndToEnd",a);var w;if(/[\r\n]/.test(q.data)){var x=h.duplicate(),y=x.text.replace(/\r\n/g,"\r").length;for(w=x.moveStart("character",y);-1==(m=x.compareEndPoints("StartToEnd",x));)w++,x.moveStart("character",1)}else w=h.text.length;p=new g(q,w)}else n=(d||!c)&&l.previousSibling,o=(d||c)&&l.nextSibling,p=o&&k(o)?new g(o,0):n&&k(n)?new g(n,n.data.length):new g(i,e.getNodeIndex(l));
return l.parentNode.removeChild(l),{boundaryPosition:p,nodeInfo:{nodeIndex:v,containerElement:i}}},o=function(a,b){var c,d,f,g,h=a.offset,j=e.getDocument(a.node),l=i(j).createTextRange(),m=k(a.node);return m?(c=a.node,d=c.parentNode):(g=a.node.childNodes,c=h<g.length?g[h]:null,d=a.node),f=j.createElement("span"),f.innerHTML="&#feff;",c?d.insertBefore(f,c):d.appendChild(f),l.moveToElementText(f),l.collapse(!b),d.removeChild(f),m&&l[b?"moveStart":"moveEnd"]("character",h),l};d=function(a){this.textRange=a,this.refresh()},d.prototype=new h(document),d.prototype.refresh=function(){var a,b,c,d=l(this.textRange);m(this.textRange)?b=a=n(this.textRange,d,!0,!0).boundaryPosition:(c=n(this.textRange,d,!0,!1),a=c.boundaryPosition,b=n(this.textRange,d,!1,!1,c.nodeInfo).boundaryPosition),this.setStart(a.node,a.offset),this.setEnd(b.node,b.offset)},d.prototype.getName=function(){return"WrappedTextRange"},h.copyComparisonConstants(d);var p=function(a){if(a.collapsed)return o(new g(a.startContainer,a.startOffset),!0);var b=o(new g(a.startContainer,a.startOffset),!0),c=o(new g(a.endContainer,a.endOffset),!1),d=i(h.getRangeDocument(a)).createTextRange();return d.setEndPoint("StartToStart",b),d.setEndPoint("EndToEnd",c),d};if(d.rangeToTextRange=p,d.prototype.toTextRange=function(){return p(this)},a.WrappedTextRange=d,!a.features.implementsDomRange||a.config.preferTextRange){var q=function(a){return a("return this;")()}(Function);"undefined"==typeof q.Range&&(q.Range=d),a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),i(a).createTextRange()},a.WrappedRange=d}}a.createRange=function(c){return c=j(c,b,"createRange"),new a.WrappedRange(a.createNativeRange(c))},a.createRangyRange=function(a){return a=j(a,b,"createRangyRange"),new h(a)},a.createIframeRange=function(c){return b.deprecationNotice("createIframeRange()","createRange(iframeEl)"),a.createRange(c)},a.createIframeRangyRange=function(c){return b.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),a.createRangyRange(c)},a.addShimListener(function(b){var c=b.document;"undefined"==typeof c.createRange&&(c.createRange=function(){return a.createRange(c)}),c=b=null})}),E.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(a,b){function c(a){return"string"==typeof a?/^backward(s)?$/i.test(a):!!a}function d(a,c){if(a){if(C.isWindow(a))return a;if(a instanceof r)return a.win;var d=C.getContentDocument(a,b,c);return C.getWindow(d)}return window}function e(a){return d(a,"getWinSelection").getSelection()}function f(a){return d(a,"getDocSelection").document.selection}function g(a){var b=!1;return a.anchorNode&&(b=1==C.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b}function h(a,b,c){var d=c?"end":"start",e=c?"start":"end";a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[e+"Container"],a.focusOffset=b[e+"Offset"]}function i(a){var b=a.nativeSelection;a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset}function j(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function k(b){var c;return b instanceof F?(c=a.createNativeRange(b.getDocument()),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset)):b instanceof G?c=b.nativeRange:J.implementsDomRange&&b instanceof C.getWindow(b.startContainer).Range&&(c=b),c}function l(a){if(!a.length||1!=a[0].nodeType)return!1;for(var b=1,c=a.length;c>b;++b)if(!C.isAncestorOf(a[0],a[b]))return!1;return!0}function m(a){var c=a.getNodes();if(!l(c))throw b.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return c[0]}function n(a){return!!a&&"undefined"!=typeof a.text}function o(a,b){var c=new G(b);a._ranges=[c],h(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function p(b){if(b._ranges.length=0,"None"==b.docSelection.type)j(b);else{var c=b.docSelection.createRange();if(n(c))o(b,c);else{b.rangeCount=c.length;for(var d,e=L(c.item(0)),f=0;f<b.rangeCount;++f)d=a.createRange(e),d.selectNode(c.item(f)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed,h(b,b._ranges[b.rangeCount-1],!1)}}}function q(a,c){for(var d=a.docSelection.createRange(),e=m(c),f=L(d.item(0)),g=M(f).createControlRange(),h=0,i=d.length;i>h;++h)g.add(d.item(h));try{g.add(e)}catch(j){throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}g.select(),p(a)}function r(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()}function s(a){a.win=a.anchorNode=a.focusNode=a._ranges=null,a.rangeCount=a.anchorOffset=a.focusOffset=0,a.detached=!0}function t(a,b){for(var c,d,e=bb.length;e--;)if(c=bb[e],d=c.selection,"deleteAll"==b)s(d);else if(c.win==a)return"delete"==b?(bb.splice(e,1),!0):d;return"deleteAll"==b&&(bb.length=0),null}function u(a,c){for(var d,e=L(c[0].startContainer),f=M(e).createControlRange(),g=0,h=c.length;h>g;++g){d=m(c[g]);try{f.add(d)}catch(i){throw b.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}f.select(),p(a)}function v(a,b){if(a.win.document!=L(b))throw new H("WRONG_DOCUMENT_ERR")}function w(b){return function(c,d){var e;this.rangeCount?(e=this.getRangeAt(0),e["set"+(b?"Start":"End")](c,d)):(e=a.createRange(this.win.document),e.setStartAndEnd(c,d)),this.setSingleRange(e,this.isBackward())}}function x(a){var b=[],c=new I(a.anchorNode,a.anchorOffset),d=new I(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=0,g=a.rangeCount;g>f;++f)b[f]=F.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.config.checkSelectionRanges=!0;var y,z,A="boolean",B="number",C=a.dom,D=a.util,E=D.isHostMethod,F=a.DomRange,G=a.WrappedRange,H=a.DOMException,I=C.DomPosition,J=a.features,K="Control",L=C.getDocument,M=C.getBody,N=F.rangesEqual,O=E(window,"getSelection"),P=D.isHostObject(document,"selection");J.implementsWinGetSelection=O,J.implementsDocSelection=P;var Q=P&&(!O||a.config.preferTextRange);Q?(y=f,a.isSelectionValid=function(a){var b=d(a,"isSelectionValid").document,c=b.selection;return"None"!=c.type||L(c.createRange().parentElement())==b}):O?(y=e,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected."),a.getNativeSelection=y;var R=y(),S=a.createNativeRange(document),T=M(document),U=D.areHostProperties(R,["anchorNode","focusNode","anchorOffset","focusOffset"]);J.selectionHasAnchorAndFocus=U;var V=E(R,"extend");J.selectionHasExtend=V;var W=typeof R.rangeCount==B;J.selectionHasRangeCount=W;var X=!1,Y=!0,Z=V?function(b,c){var d=F.getRangeDocument(c),e=a.createRange(d);e.collapseToPoint(c.endContainer,c.endOffset),b.addRange(k(e)),b.extend(c.startContainer,c.startOffset)}:null;D.areHostMethods(R,["addRange","getRangeAt","removeAllRanges"])&&typeof R.rangeCount==B&&J.implementsDomRange&&!function(){var b=window.getSelection();if(b){for(var c=b.rangeCount,d=c>1,e=[],f=g(b),h=0;c>h;++h)e[h]=b.getRangeAt(h);var i=M(document),j=i.appendChild(document.createElement("div"));j.contentEditable="false";var k=j.appendChild(document.createTextNode("   ")),l=document.createRange();if(l.setStart(k,1),l.collapse(!0),b.addRange(l),Y=1==b.rangeCount,b.removeAllRanges(),!d){var m=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(m&&parseInt(m[1])>=36)X=!1;else{var n=l.cloneRange();l.setStart(k,0),n.setEnd(k,3),n.setStart(k,2),b.addRange(l),b.addRange(n),X=2==b.rangeCount}}for(i.removeChild(j),b.removeAllRanges(),h=0;c>h;++h)0==h&&f?Z?Z(b,e[h]):(a.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),b.addRange(e[h])):b.addRange(e[h])}}(),J.selectionSupportsMultipleRanges=X,J.collapsedNonEditableSelectionsSupported=Y;var $,_=!1;T&&E(T,"createControlRange")&&($=T.createControlRange(),D.areHostProperties($,["item","add"])&&(_=!0)),J.implementsControlRange=_,z=U?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var ab;E(R,"getRangeAt")?ab=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:U&&(ab=function(b){var c=L(b.anchorNode),d=a.createRange(c);return d.setStartAndEnd(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),d.collapsed!==this.isCollapsed&&d.setStartAndEnd(b.focusNode,b.focusOffset,b.anchorNode,b.anchorOffset),d}),r.prototype=a.selectionPrototype;var bb=[],cb=function(a){if(a&&a instanceof r)return a.refresh(),a;a=d(a,"getNativeSelection");var b=t(a),c=y(a),e=P?f(a):null;return b?(b.nativeSelection=c,b.docSelection=e,b.refresh()):(b=new r(c,e,a),bb.push({win:a,selection:b})),b};a.getSelection=cb,a.getIframeSelection=function(c){return b.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),a.getSelection(C.getIframeWindow(c))};var db=r.prototype;if(!Q&&U&&D.areHostMethods(R,["removeAllRanges","addRange"])){db.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),j(this)};var eb=function(a,b){Z(a.nativeSelection,b),a.refresh()};db.addRange=W?function(b,d){if(_&&P&&this.docSelection.type==K)q(this,b);else if(c(d)&&V)eb(this,b);else{var e;X?e=this.rangeCount:(this.removeAllRanges(),e=0);var f=k(b).cloneRange();try{this.nativeSelection.addRange(f)}catch(g){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==e+1){if(a.config.checkSelectionRanges){var i=ab(this.nativeSelection,this.rangeCount-1);i&&!N(i,b)&&(b=new G(i))}this._ranges[this.rangeCount-1]=b,h(this,b,hb(this.nativeSelection)),this.isCollapsed=z(this)}else this.refresh()}}:function(a,b){c(b)&&V?eb(this,a):(this.nativeSelection.addRange(k(a)),this.refresh())},db.setRanges=function(a){if(_&&P&&a.length>1)u(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;c>b;++b)this.addRange(a[b])}}}else{if(!(E(R,"empty")&&E(S,"select")&&_&&Q))return b.fail("No means of selecting a Range or TextRange was found"),!1;db.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=L(this.anchorNode);else if(this.docSelection.type==K){var b=this.docSelection.createRange();b.length&&(a=L(b.item(0)))}if(a){var c=M(a).createTextRange();c.select(),this.docSelection.empty()}}}catch(d){}j(this)},db.addRange=function(b){this.docSelection.type==K?q(this,b):(a.WrappedTextRange.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,h(this,b,!1))},db.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?u(this,a):b&&this.addRange(a[0])}}db.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new H("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};var fb;if(Q)fb=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=M(b.win.document).createTextRange(),c.collapse(!0)),b.docSelection.type==K?p(b):n(c)?o(b,c):j(b)};else if(E(R,"getRangeAt")&&typeof R.rangeCount==B)fb=function(b){if(_&&P&&b.docSelection.type==K)p(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;d>c;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));h(b,b._ranges[b.rangeCount-1],hb(b.nativeSelection)),b.isCollapsed=z(b)}else j(b)};else{if(!U||typeof R.isCollapsed!=A||typeof S.collapsed!=A||!J.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;fb=function(a){var b,c=a.nativeSelection;c.anchorNode?(b=ab(c,0),a._ranges=[b],a.rangeCount=1,i(a),a.isCollapsed=z(a)):j(a)}}db.refresh=function(a){var b=a?this._ranges.slice(0):null,c=this.anchorNode,d=this.anchorOffset;if(fb(this),a){var e=b.length;if(e!=this._ranges.length)return!0;if(this.anchorNode!=c||this.anchorOffset!=d)return!0;for(;e--;)if(!N(b[e],this._ranges[e]))return!0;return!1}};var gb=function(a,b){var c=a.getAllRanges();a.removeAllRanges();for(var d=0,e=c.length;e>d;++d)N(b,c[d])||a.addRange(c[d]);a.rangeCount||j(a)};db.removeRange=_&&P?function(a){if(this.docSelection.type==K){for(var b,c=this.docSelection.createRange(),d=m(a),e=L(c.item(0)),f=M(e).createControlRange(),g=!1,h=0,i=c.length;i>h;++h)b=c.item(h),b!==d||g?f.add(c.item(h)):g=!0;f.select(),p(this)}else gb(this,a)}:function(a){gb(this,a)};var hb;!Q&&U&&J.implementsDomRange?(hb=g,db.isBackward=function(){return hb(this)}):hb=db.isBackward=function(){return!1},db.isBackwards=db.isBackward,db.toString=function(){for(var a=[],b=0,c=this.rangeCount;c>b;++b)a[b]=""+this._ranges[b];return a.join("")},db.collapse=function(b,c){v(this,b);var d=a.createRange(b);d.collapseToPoint(b,c),this.setSingleRange(d),this.isCollapsed=!0},db.collapseToStart=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},db.collapseToEnd=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},db.selectAllChildren=function(b){v(this,b);var c=a.createRange(b);c.selectNodeContents(b),this.setSingleRange(c)},db.deleteFromDocument=function(){if(_&&P&&this.docSelection.type==K){for(var a,b=this.docSelection.createRange();b.length;)a=b.item(0),b.remove(a),a.parentNode.removeChild(a);this.refresh()}else if(this.rangeCount){var c=this.getAllRanges();if(c.length){this.removeAllRanges();for(var d=0,e=c.length;e>d;++d)c[d].deleteContents();this.addRange(c[e-1])}}},db.eachRange=function(a,b){for(var c=0,d=this._ranges.length;d>c;++c)if(a(this.getRangeAt(c)))return b},db.getAllRanges=function(){var a=[];return this.eachRange(function(b){a.push(b)}),a},db.setSingleRange=function(a,b){this.removeAllRanges(),this.addRange(a,b)},db.callMethodOnEachRange=function(a,b){var c=[];return this.eachRange(function(d){c.push(d[a].apply(d,b))}),c},db.setStart=w(!0),db.setEnd=w(!1),a.rangePrototype.select=function(a){cb(this.getDocument()).setSingleRange(this,a)},db.changeEachRange=function(a){var b=[],c=this.isBackward();this.eachRange(function(c){a(c),b.push(c)}),this.removeAllRanges(),c&&1==b.length?this.addRange(b[0],"backward"):this.setRanges(b)},db.containsNode=function(a,b){return this.eachRange(function(c){return c.containsNode(a,b)},!0)||!1},db.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}},db.moveToBookmark=function(b){for(var c,d,e=[],f=0;c=b.rangeBookmarks[f++];)d=a.createRange(this.win),d.moveToBookmark(c),e.push(d);b.backward?this.setSingleRange(e[0],"backward"):this.setRanges(e)},db.toHtml=function(){var a=[];return this.eachRange(function(b){a.push(F.toHtml(b))}),a.join("")},J.implementsTextRange&&(db.getNativeTextRange=function(){var c;if(c=this.docSelection){var d=c.createRange();if(n(d))return d;throw b.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw b.createError("getNativeTextRange: selection contains no range")}),db.getName=function(){return"WrappedSelection"},db.inspect=function(){return x(this)},db.detach=function(){t(this.win,"delete"),s(this)},r.detachAll=function(){t(null,"deleteAll")},r.inspect=x,r.isDirectionBackward=c,a.Selection=r,a.selectionPrototype=db,a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return cb(a)}),a=null})});var J=!1,K=function(){J||(J=!0,!E.initialized&&E.config.autoInitialize&&l())};return C&&(/^(?:complete|interactive)$/.test(document.readyState)?K():(a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",K,!1),G(window,"load",K))),E},this),function(a,b){"function"==typeof define&&define.amd?define(["./rangy-core"],a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a(require("rangy")):a(b.rangy)}(function(a){a.createModule("ClassApplier",["WrappedSelection"],function(a,b){function c(a,b){for(var c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)return!1;return!0}function d(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function e(a,b){return a.className&&new RegExp("(?:^|\\s)"+b+"(?:\\s|$)").test(a.className)}function f(a,b){a.className?e(a,b)||(a.className+=" "+b):a.className=b}function g(a){return a&&a.split(/\s+/).sort().join(" ")}function h(a){return g(a.className)}function i(a,b){return h(a)==h(b)}function j(a,b,c,d,e){var f=a.node,g=a.offset,h=f,i=g;f==d&&g>e&&++i,f!=b||g!=c&&g!=c+1||(h=d,i+=e-c),f==b&&g>c+1&&--i,a.node=h,a.offset=i}function k(a,b,c){a.node==b&&a.offset>c&&--a.offset}function l(a,b,c,d){-1==c&&(c=b.childNodes.length);for(var e,f=a.parentNode,g=H.getNodeIndex(a),h=0;e=d[h++];)j(e,f,g,b,c);b.childNodes.length==c?b.appendChild(a):b.insertBefore(a,b.childNodes[c])}function m(a,b){for(var c,d=a.parentNode,e=H.getNodeIndex(a),f=0;c=b[f++];)k(c,d,e);a.parentNode.removeChild(a)}function n(a,b,c,d,e){for(var f,g=[];f=a.firstChild;)l(f,b,c++,e),g.push(f);return d&&m(a,e),g}function o(a,b){return n(a,a.parentNode,H.getNodeIndex(a),!0,b)}function p(a,b){var c=a.cloneRange();c.selectNodeContents(b);var d=c.intersection(a),e=d?d.toString():"";return""!=e}function q(a){for(var b,c=a.getNodes([3]),d=0;(b=c[d])&&!p(a,b);)++d;for(var e=c.length-1;(b=c[e])&&!p(a,b);)--e;return c.slice(d,e+1)}function r(a,b){if(a.attributes.length!=b.attributes.length)return!1;for(var c,d,e,f=0,g=a.attributes.length;g>f;++f)if(c=a.attributes[f],e=c.name,"class"!=e){if(d=b.attributes.getNamedItem(e),null===c!=(null===d))return!1;if(c.specified!=d.specified)return!1;if(c.specified&&c.nodeValue!==d.nodeValue)return!1}return!0}function s(a,b){for(var c,d=0,e=a.attributes.length;e>d;++d)if(c=a.attributes[d].name,(!b||!J(b,c))&&a.attributes[d].specified&&"class"!=c)return!0;return!1}function t(a,b){return c(b,function(b,c){if("object"==typeof c){if(!t(a[b],c))return!1}else if(a[b]!==c)return!1})}function u(a){var b;return a&&1==a.nodeType&&((b=a.parentNode)&&9==b.nodeType&&"on"==b.designMode||O(a)&&!O(a.parentNode))}function v(a){return(O(a)||1!=a.nodeType&&O(a.parentNode))&&!u(a)}function w(a){return a&&1==a.nodeType&&!P.test(N(a,"display"))}function x(a){if(0==a.data.length)return!0;if(Q.test(a.data))return!1;var b=N(a.parentNode,"whiteSpace");switch(b){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(a.data))return!1}return w(a.previousSibling)||w(a.nextSibling)}function y(a){var b,c,d=[];for(b=0;c=a[b++];)d.push(new I(c.startContainer,c.startOffset),new I(c.endContainer,c.endOffset));return d}function z(a,b){for(var c,d,e,f=0,g=a.length;g>f;++f)c=a[f],d=b[2*f],e=b[2*f+1],c.setStartAndEnd(d.node,d.offset,e.node,e.offset)}function A(a,b){return H.isCharacterDataNode(a)?0==b?!!a.previousSibling:b==a.length?!!a.nextSibling:!0:b>0&&b<a.childNodes.length}function B(a,c,d,e){var f,g,h=0==d;if(H.isAncestorOf(c,a))return a;if(H.isCharacterDataNode(c)){var i=H.getNodeIndex(c);if(0==d)d=i;else{if(d!=c.length)throw b.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+d+" in "+c.data);d=i+1}c=c.parentNode}if(A(c,d)){f=c.cloneNode(!1),g=c.parentNode,f.id&&f.removeAttribute("id");for(var j,k=0;j=c.childNodes[d];)l(j,f,k++,e);return l(f,g,H.getNodeIndex(c)+1,e),c==a?f:B(a,g,H.getNodeIndex(f),e)}if(a!=c){f=c.parentNode;var m=H.getNodeIndex(c);return h||m++,B(a,f,m,e)}return a}function C(a,b){return a.namespaceURI==b.namespaceURI&&a.tagName.toLowerCase()==b.tagName.toLowerCase()&&i(a,b)&&r(a,b)&&"inline"==N(a,"display")&&"inline"==N(b,"display")}function D(a){var b=a?"nextSibling":"previousSibling";return function(c,d){var e=c.parentNode,f=c[b];if(f){if(f&&3==f.nodeType)return f}else if(d&&(f=e[b],f&&1==f.nodeType&&C(e,f))){var g=f[a?"firstChild":"lastChild"];if(g&&3==g.nodeType)return g}return null}}function E(a){this.isElementMerge=1==a.nodeType,this.textNodes=[];var b=this.isElementMerge?a.lastChild:a;b&&(this.textNodes[0]=b)}function F(a,b,e){var f,g,h,i,j=this;j.cssClass=j.className=a;var k=null,l={};if("object"==typeof b&&null!==b){for(e=b.tagNames,k=b.elementProperties,l=b.elementAttributes,g=0;i=T[g++];)b.hasOwnProperty(i)&&(j[i]=b[i]);f=b.normalize}else f=b;j.normalize="undefined"==typeof f?!0:f,j.attrExceptions=[];var m=document.createElement(j.elementTagName);j.elementProperties=j.copyPropertiesToElement(k,m,!0),c(l,function(a){j.attrExceptions.push(a)}),j.elementAttributes=l,j.elementSortedClassName=j.elementProperties.hasOwnProperty("className")?j.elementProperties.className:a,j.applyToAnyTagName=!1;var n=typeof e;if("string"==n)"*"==e?j.applyToAnyTagName=!0:j.tagNames=d(e.toLowerCase()).split(/\s*,\s*/);else if("object"==n&&"number"==typeof e.length)for(j.tagNames=[],g=0,h=e.length;h>g;++g)"*"==e[g]?j.applyToAnyTagName=!0:j.tagNames.push(e[g].toLowerCase());else j.tagNames=[j.elementTagName]}function G(a,b,c){return new F(a,b,c)}var H=a.dom,I=H.DomPosition,J=H.arrayContains,K=H.isHtmlNamespace,L="span",M=function(){function a(a,b,c){return b&&c?" ":""}return function(b,c){b.className&&(b.className=b.className.replace(new RegExp("(^|\\s)"+c+"(\\s|$)"),a))}}(),N=H.getComputedStyleProperty,O=function(){var a=document.createElement("div");return"boolean"==typeof a.isContentEditable?function(a){return a&&1==a.nodeType&&a.isContentEditable}:function(a){return a&&1==a.nodeType&&"false"!=a.contentEditable?"true"==a.contentEditable||O(a.parentNode):!1}}(),P=/^inline(-block|-table)?$/i,Q=/[^\r\n\t\f \u200B]/,R=D(!1),S=D(!0);E.prototype={doMerge:function(a){var b=this.textNodes,c=b[0];if(b.length>1){for(var d,e,f,g,h=H.getNodeIndex(c),i=[],j=0,k=0,l=b.length;l>k;++k){if(d=b[k],e=d.parentNode,k>0&&(e.removeChild(d),e.hasChildNodes()||e.parentNode.removeChild(e),a))for(f=0;g=a[f++];)g.node==d&&(g.node=c,g.offset+=j),g.node==e&&g.offset>h&&(--g.offset,g.offset==h+1&&l-1>k&&(g.node=c,g.offset=j));i[k]=d.data,j+=d.data.length}c.data=i.join("")}return c.data},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=0,c=this.textNodes.length;c>b;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}};var T=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],U={};F.prototype={elementTagName:L,elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(a,b,c){var d,e,h,i,j,k,l={};for(var m in a)if(a.hasOwnProperty(m))if(i=a[m],j=b[m],"className"==m)f(b,i),f(b,this.className),b[m]=g(b[m]),c&&(l[m]=b[m]);else if("style"==m){e=j,c&&(l[m]=h={});for(d in a[m])e[d]=i[d],c&&(h[d]=e[d]);this.attrExceptions.push(m)}else b[m]=i,c&&(l[m]=b[m],k=U.hasOwnProperty(m)?U[m]:m,this.attrExceptions.push(k));return c?l:""},copyAttributesToElement:function(a,b){for(var c in a)a.hasOwnProperty(c)&&b.setAttribute(c,a[c])},hasClass:function(a){return 1==a.nodeType&&J(this.tagNames,a.tagName.toLowerCase())&&e(a,this.className)},getSelfOrAncestorWithClass:function(a){for(;a;){if(this.hasClass(a))return a;a=a.parentNode}return null},isModifiable:function(a){return!this.applyToEditableOnly||v(a)},isIgnorableWhiteSpaceNode:function(a){return this.ignoreWhiteSpace&&a&&3==a.nodeType&&x(a)},postApply:function(a,b,c,d){for(var e,f,g,h=a[0],i=a[a.length-1],j=[],k=h,l=i,m=0,n=i.length,o=0,p=a.length;p>o;++o)f=a[o],g=R(f,!d),g?(e||(e=new E(g),j.push(e)),e.textNodes.push(f),f===h&&(k=e.textNodes[0],m=k.length),f===i&&(l=e.textNodes[0],n=e.getLength())):e=null;var q=S(i,!d);if(q&&(e||(e=new E(i),j.push(e)),e.textNodes.push(q)),j.length){for(o=0,p=j.length;p>o;++o)j[o].doMerge(c);b.setStartAndEnd(k,m,l,n)}},createContainer:function(a){var b=a.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,b,!1),this.copyAttributesToElement(this.elementAttributes,b),f(b,this.className),this.onElementCreate&&this.onElementCreate(b,this),b},applyToTextNode:function(a){var b=a.parentNode;if(1==b.childNodes.length&&this.useExistingElements&&K(b)&&J(this.tagNames,b.tagName.toLowerCase())&&t(b,this.elementProperties))f(b,this.className);else{var c=this.createContainer(H.getDocument(a));a.parentNode.insertBefore(c,a),c.appendChild(a)}},isRemovable:function(a){return K(a)&&a.tagName.toLowerCase()==this.elementTagName&&h(a)==this.elementSortedClassName&&t(a,this.elementProperties)&&!s(a,this.attrExceptions)&&this.isModifiable(a)},isEmptyContainer:function(a){var b=a.childNodes.length;return 1==a.nodeType&&this.isRemovable(a)&&(0==b||1==b&&this.isEmptyContainer(a.firstChild))},removeEmptyContainers:function(a){for(var b,c=this,d=a.getNodes([1],function(a){return c.isEmptyContainer(a)}),e=[a],f=y(e),g=0;b=d[g++];)m(b,f);z(e,f)},undoToTextNode:function(a,b,c,d){if(!b.containsNode(c)){var e=b.cloneRange();e.selectNode(c),e.isPointInRange(b.endContainer,b.endOffset)&&(B(c,b.endContainer,b.endOffset,d),b.setEndAfter(c)),e.isPointInRange(b.startContainer,b.startOffset)&&(c=B(c,b.startContainer,b.startOffset,d))}this.isRemovable(c)?o(c,d):M(c,this.className)},applyToRange:function(a,b){b=b||[];var c=y(b||[]);a.splitBoundariesPreservingPositions(c),this.removeEmptyElements&&this.removeEmptyContainers(a);var d=q(a);if(d.length){for(var e,f=0;e=d[f++];)this.isIgnorableWhiteSpaceNode(e)||this.getSelfOrAncestorWithClass(e)||!this.isModifiable(e)||this.applyToTextNode(e,c);e=d[d.length-1],a.setStartAndEnd(d[0],0,e,e.length),this.normalize&&this.postApply(d,a,c,!1),z(b,c)}},applyToRanges:function(a){for(var b=a.length;b--;)this.applyToRange(a[b],a);return a},applyToSelection:function(b){var c=a.getSelection(b);c.setRanges(this.applyToRanges(c.getAllRanges()))},undoToRange:function(a,b){b=b||[];var c=y(b);a.splitBoundariesPreservingPositions(c),this.removeEmptyElements&&this.removeEmptyContainers(a,c);var d,e,f=q(a),g=f[f.length-1];if(f.length){for(var h=0,i=f.length;i>h;++h)d=f[h],e=this.getSelfOrAncestorWithClass(d),e&&this.isModifiable(d)&&this.undoToTextNode(d,a,e,c),a.setStartAndEnd(f[0],0,g,g.length);this.normalize&&this.postApply(f,a,c,!0),z(b,c)}},undoToRanges:function(a){for(var b=a.length;b--;)this.undoToRange(a[b],a);return a},undoToSelection:function(b){var c=a.getSelection(b),d=a.getSelection(b).getAllRanges();this.undoToRanges(d),c.setRanges(d)},isAppliedToRange:function(a){if(a.collapsed||""==a.toString())return!!this.getSelfOrAncestorWithClass(a.commonAncestorContainer);var b=a.getNodes([3]);if(b.length)for(var c,d=0;c=b[d++];)if(!this.isIgnorableWhiteSpaceNode(c)&&p(a,c)&&this.isModifiable(c)&&!this.getSelfOrAncestorWithClass(c))return!1;return!0},isAppliedToRanges:function(a){var b=a.length;if(0==b)return!1;for(;b--;)if(!this.isAppliedToRange(a[b]))return!1;return!0},isAppliedToSelection:function(b){var c=a.getSelection(b);return this.isAppliedToRanges(c.getAllRanges())},toggleRange:function(a){this.isAppliedToRange(a)?this.undoToRange(a):this.applyToRange(a)},toggleSelection:function(a){this.isAppliedToSelection(a)?this.undoToSelection(a):this.applyToSelection(a)},getElementsWithClassIntersectingRange:function(a){var b=[],c=this;return a.getNodes([3],function(a){var d=c.getSelfOrAncestorWithClass(a);d&&!J(b,d)&&b.push(d)}),b},detach:function(){}},F.util={hasClass:e,addClass:f,removeClass:M,hasSameClasses:i,replaceWithOwnChildren:o,elementsHaveSameNonClassAttributes:r,elementHasNonClassAttributes:s,splitNodeAt:B,isEditableElement:O,isEditingHost:u,isEditable:v},a.CssClassApplier=a.ClassApplier=F,a.createCssClassApplier=a.createClassApplier=G})},this),function(a,b){"use strict";var c=function(){var c=function(a){return a.replace(/^\s+|\s+$/g,"")},d=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},e=a.rangy||null,f=a.Undo||null,g=!e||!f,h=a.Key={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capsLock:20,escape:27,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindow:91,rightWindowKey:92,select:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numLock:144,scrollLock:145,semiColon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,singleQuote:222},i=function(b){var c,d,e,f=this,j=new i.Action,k=new i.Cache,l=new i.Cursor,m=new i.HtmlAssistant,n=new i.Utilities,o=new i.Selection,p={focus:function(b){b=b||a.event,i.activeElement=c},blur:function(b){b=b||a.event,i.activeElement===c&&(i.activeElement=null),m.placeholders()},down:function(b){b=b||a.event;var c=!0;if(229!==b.keyCode){if(n.isCommand(b,function(){k.cmd=!0},function(){k.cmd=!1}),n.isShift(b,function(){k.shift=!0},function(){k.shift=!1}),n.isModifier(b,function(a){if(k.cmd){if((r.mode===i.inlineMode||r.mode===i.partialMode)&&"paste"!==a)return void n.preventDefaultEvent(b);var d=typeof a,e=null;e="function"===d?a:p.command[a],c=e.call(f,b),c===!1&&(n.preventDefaultEvent(b),n.stopPropagation(b))}}),-1!==r.maxLength){var d=m.text().length,e=!1,g=a.getSelection();if(g&&(e=!g.isCollapsed),d>=r.maxLength&&!n.isSpecial(b)&&!n.isNavigational(b)&&!e)return n.preventDefaultEvent(b)}switch(b.keyCode){case h.enter:p.enterKey(b);break;case h.backspace:case h["delete"]:p.backspaceOrDeleteKey(b)}return c}},up:function(b){b=b||a.event,n.isCommand(b,function(){k.cmd=!1},function(){k.cmd=!0}),m.clean(),m.placeholders();var c;if(null!==r.keyContext&&(c=r.keyContext[b.keyCode])){var d=l.parent();d&&c.call(f,b,d)}j.preserveElementFocus()},command:{bold:function(a){n.preventDefaultEvent(a),new i.Element(f,"bold").setClean(!1).invoke(r.beforeInvokeElement)},underline:function(a){n.preventDefaultEvent(a),new i.Element(f,"underline").setClean(!1).invoke(r.beforeInvokeElement)},italicize:function(a){n.preventDefaultEvent(a),new i.Element(f,"italic").setClean(!1).invoke(r.beforeInvokeElement)},quote:function(){},paste:function(){if(f.makeUndoable(),r.pasteAsText){var a=n.selection.saveSelection();n.pasteHook(function(b){n.selection.restoreSelection(a),b=b.replace(/\n/g,"<br>"),new i.Html(f,b).setClean(!1).insert(r.beforeInsertHtml,!0),m.clean(),m.placeholders()})}else m.clean(),m.placeholders()}},enterKey:function(a){if(r.mode===i.inlineMode)return n.preventDefaultEvent(a);if(!k.shift){var b,d,e,f=m.atCaret()||{},g=c.children,h=f===c.lastChild?c.lastChild:null;h&&h!==c.firstChild&&r.autoHR&&"partial"!==r.mode&&r.tags.horizontalRule&&(n.preventDefaultEvent(a),b=""===m.text(h)&&h.nodeName.toLowerCase()===r.tags.paragraph,b&&g.length>=2&&(d=g[g.length-2],d.nodeName.toLowerCase()===r.tags.horizontalRule&&(b=!1)),b&&(m.addTag(r.tags.horizontalRule,!1,!0,f),f=f.nextSibling),null!==(e=m.addTag(r.tags.paragraph,!0,null,f))&&(e.innerHTML="",l.set(0,e)))}return!0},backspaceOrDeleteKey:function(){if(null!==c.lastChild){var a=c.lastChild,b=a.previousSibling;a&&r.tags.horizontalRule&&a.nodeName.toLocaleLowerCase()===r.tags.horizontalRule?c.removeChild(a):a&&b&&n.html.text(a).length<1&&b.nodeName.toLowerCase()===r.tags.horizontalRule&&a.nodeName.toLowerCase()===r.tags.paragraph&&(c.removeChild(a),c.removeChild(b))}}},q={element:null,modifier:"auto",placeholder:"",autofocus:!1,autoHR:!0,mode:i.richMode,maxLength:-1,modifiers:{b:"bold",i:"italicize",u:"underline",v:"paste"},tags:{"break":"br",horizontalRule:"hr",paragraph:"p",outerLevel:["pre","blockquote","figure"],innerLevel:["a","b","u","i","img","strong"]},cssClasses:{editor:"Medium",pasteHook:"Medium-paste-hook",placeholder:"Medium-placeholder",clear:"Medium-clear"},attributes:{remove:["style","class"]},pasteAsText:!0,beforeInvokeElement:function(){},beforeInsertHtml:function(){},beforeAddTag:function(){},keyContext:null,pasteEventHandler:function(b){b=b||a.event,f.makeUndoable();
var d,e=f.value().length;if(r.pasteAsText){n.preventDefaultEvent(b);var g=n.selection.saveSelection(),h=prompt(i.Messages.pastHere)||"";if(h.length>0)return c.focus(),i.activeElement=c,n.selection.restoreSelection(g),h=m.encodeHtml(h),d=h.length+e,r.maxLength>0&&d>r.maxLength&&(h=h.substring(0,r.maxLength-e)),r.mode!==i.inlineMode&&(h=h.replace(/\n/g,"<br>")),new i.Html(f,h).setClean(!1).insert(r.beforeInsertHtml,!0),m.clean(),m.placeholders(),!1}else setTimeout(function(){m.clean(),m.placeholders()},20)}},r=n.deepExtend(q,b),s={};for(e in q)"object"!=typeof q[e]&&q.hasOwnProperty(e)&&r.element.getAttribute("data-medium-"+h)&&(d=r.element.getAttribute("data-medium-"+h),("false"===d.toLowerCase()||"true"===d.toLowerCase())&&(d="true"===d.toLowerCase()),r[e]=d);if(r.modifiers)for(e in r.modifiers)"undefined"!=typeof h[e]&&(r.modifiers[h[e]]=r.modifiers[e]);if(r.keyContext)for(e in r.keyContext)"undefined"!=typeof h[e]&&(r.keyContext[h[e]]=r.keyContext[e]);c=r.element,c.contentEditable=!0,c.className+=" "+r.cssClasses.editor+(" "+r.cssClasses.editor+"-"+r.mode),r.tags=r.tags||{},r.tags.outerLevel&&(r.tags.outerLevel=r.tags.outerLevel.concat([r.tags.paragraph,r.tags.horizontalRule])),this.settings=r,this.element=c,this.intercept=p,this.action=j,this.cache=k,this.cursor=l,this.html=m,this.utils=n,this.selection=o,s.element=c,s.medium=this,s.settings=r,s.action=j,s.cache=k,s.cursor=l,s.html=m,s.intercept=p,s.utils=n,s.selection=o,j.setBridge(s),k.setBridge(s),l.setBridge(s),m.setBridge(s),n.setBridge(s),o.setBridge(s),m.clean(),m.placeholders(),j.preserveElementFocus(),j.listen(),g?this.makeUndoable=function(){}:(this.dirty=!1,this.undoable=new i.Undoable(this),this.undo=this.undoable.undo,this.redo=this.undoable.redo,this.makeUndoable=this.undoable.makeUndoable),c.medium=this,k.initialized=!0};return i.prototype={insertHtml:function(a,b){var c=new i.Html(this,a).insert(this.settings.beforeInsertHtml);return this.utils.triggerEvent(this.element,"change"),b&&b.apply(c),this},invokeElement:function(a,b){var c=this.settings,b=b||{},e=b.remove||[];switch(c.mode){case i.inlineMode:case i.partialMode:return this}return e.length>0&&(d(c,"class")||e.push("class")),new i.Element(this,a,b).invoke(this.settings.beforeInvokeElement),this.utils.triggerEvent(this.element,"change"),this},behavior:function(){return g?"wild":"domesticated"},value:function(a){return"undefined"==typeof a?this.element.innerHTML:(this.element.innerHTML=a,this.html.clean(),this.html.placeholders(),this)},focus:function(){var a=this.element;return a.focus(),this},select:function(){var c,d,e=this.element;return e.focus(),b.body.createTextRange?(c=b.body.createTextRange(),c.moveToElementText(e),c.select()):a.getSelection&&(d=a.getSelection(),c=b.createRange(),c.selectNodeContents(e),d.removeAllRanges(),d.addRange(c)),this},isActive:function(){return i.activeElement===this.element},destroy:function(){var a=this.element,b=this.intercept,d=this.settings,e=this.placeholder||null;null!==e&&e.setup&&(e.parentNode.removeChild(e),delete a.placeHolderActive),a.removeAttribute("contenteditable"),a.className=c(a.className.replace(d.cssClasses.editor,"").replace(d.cssClasses.clear,"").replace(d.cssClasses.editor+"-"+d.mode,"")),this.utils.removeEvent(a,"keyup",b.up).removeEvent(a,"keydown",b.down).removeEvent(a,"focus",b.focus).removeEvent(a,"blur",b.focus).removeEvent(a,"paste",d.pasteEventHandler)},clear:function(){this.element.innerHTML="",this.html.placeholders()}},i.Element=function(a,b,c){if(this.medium=a,this.element=a.settings.element,g)this.tagName=b;else switch(b.toLowerCase()){case"bold":this.tagName="b";break;case"italic":this.tagName="i";break;case"underline":this.tagName="u";break;default:this.tagName=b}this.attributes=c||{},this.clean=!0},i.Html=function(a,b){this.medium=a,this.element=a.settings.element,this.html=b,this.clean=!0},i.Injector=function(){},g?(i.Element.prototype={invoke:function(a){i.activeElement===this.element&&(a&&a.apply(this),b.execCommand(this.tagName,!1))},setClean:function(){return this}},i.Injector.prototype={inject:function(a,b){return this.insertHTML(a,b),null}},i.Undoable=function(){}):(e.rangePrototype.insertNodeAtEnd=function(a){var b=this.cloneRange();b.collapse(!1),b.insertNode(a),b.detach(),this.setEndAfter(a)},i.Element.prototype={invoke:function(b){if(i.activeElement===this.element){b&&b.apply(this);var c,d,f=this.attributes,g=this.tagName.toLowerCase();void 0!==f.className?(d=(f.className.split[" "]||[f.className]).shift(),delete f.className):d="lasso-"+g,c=e.createClassApplier(d,{elementTagName:g,elementAttributes:this.attributes}),this.medium.makeUndoable(),c.toggleSelection(a),this.clean&&(this.medium.html.clean(),this.medium.html.placeholders())}},setClean:function(a){return this.clean=a,this}},i.Injector.prototype={inject:function(a){var c,d=!1;if("string"==typeof a){var e=b.createElement("div");e.innerHTML=a,c=e.childNodes,d=!0}else c=a;this.insertHTML('<span id="wedge"></span>');var f=b.getElementById("wedge"),g=f.parentNode,h=0;if(f.removeAttribute("id"),d)for(;h<c.length;)g.insertBefore(c[h],f);else g.insertBefore(c,f);return g.removeChild(f),f=null,c}},i.Undoable=function(a){var b,c=this,d=a.settings.element,e=a.utils,f=e.addEvent,g=d.innerHTML,i=new Undo.Stack,j=Undo.Command.extend({constructor:function(a,b){this.oldValue=a,this.newValue=b},execute:function(){},undo:function(){d.innerHTML=this.oldValue,a.canUndo=i.canUndo(),a.canRedo=i.canRedo(),a.dirty=i.dirty()},redo:function(){d.innerHTML=this.newValue,a.canUndo=i.canUndo(),a.canRedo=i.canRedo(),a.dirty=i.dirty()}}),k=function(){var b=d.innerHTML;b!=g&&(c.movingThroughStack||(i.execute(new j(g,b)),g=b,a.dirty=i.dirty()),e.triggerEvent(a.settings.element,"change"))};this.medium=a,this.timer=b,this.stack=i,this.makeUndoable=k,this.EditCommand=j,this.movingThroughStack=!1,f(d,"keyup",function(a){return a.ctrlKey||a.keyCode===h.z?void e.preventDefaultEvent(a):(clearTimeout(b),void(b=setTimeout(function(){k()},250)))}),f(d,"keydown",function(a){return a.ctrlKey&&a.keyCode===h.z?(e.preventDefaultEvent(a),c.movingThroughStack=!0,void(a.shiftKey?i.canRedo()&&i.redo():i.canUndo()&&i.undo())):(c.movingThroughStack=!1,!0)})}),i.Injector.prototype.insertHTML=function(c,d){var e,f;if(a.getSelection){if(e=a.getSelection(),e.getRangeAt&&e.rangeCount){f=e.getRangeAt(0),f.deleteContents();var g=b.createElement("div");g.innerHTML=c;for(var h,i,j=b.createDocumentFragment();h=g.firstChild;)i=j.appendChild(h);var k=j.firstChild;f.insertNode(j),i&&(f=f.cloneRange(),f.setStartAfter(i),d?f.setStartBefore(k):f.collapse(!0),e.removeAllRanges(),e.addRange(f))}}else if((e=b.selection)&&"Control"!=e.type){var l=e.createRange();l.collapse(!0),e.createRange().pasteHTML(c),d&&(f=e.createRange(),f.setEndPoint("StartToStart",l),f.select())}},i.Html.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},insert:function(a,b){if(i.activeElement===this.element){a&&a.apply(this);var c=this.injector.inject(this.html,b);return this.clean&&(this.medium.html.clean(),this.medium.html.placeholders()),this.medium.makeUndoable(),c}return null},injector:new i.Injector,setClean:function(a){return this.clean=a,this}},i.Utilities=function(){},i.Utilities.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},isCommand:function(a,b,c){var d=this.settings;return"ctrl"===d.modifier&&a.ctrlKey||"cmd"===d.modifier&&a.metaKey||"auto"===d.modifier&&(a.ctrlKey||a.metaKey)?b.call():c.call()},isShift:function(a,b,c){return a.shiftKey?b.call():c.call()},isModifier:function(a,b){var c=this.settings.modifiers[a.keyCode];return c?b.call(null,c):!1},special:function(){var a={};return a[h.backspace]=!0,a[h.shift]=!0,a[h.ctrl]=!0,a[h.alt]=!0,a[h["delete"]]=!0,a[h.cmd]=!0,a}(),isSpecial:function(a){return this.cache.cmd?!0:"undefined"!=typeof this.special[a.keyCode]},navigational:function(){var a={};return a[h.upArrow]=!0,a[h.downArrow]=!0,a[h.leftArrow]=!0,a[h.rightArrow]=!0,a}(),isNavigational:function(a){return"undefined"!=typeof this.navigational[a.keyCode]},addEvent:function(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c,this},removeEvent:function(a,b,c){return a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null,this},preventDefaultEvent:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stopPropagation:function(a){a=a||window.event,a.cancelBubble=!0,void 0!==a.stopPropagation&&a.stopPropagation()},triggerEvent:function(a,c){var d;return b.createEvent?(d=b.createEvent("HTMLEvents"),d.initEvent(c,!0,!0),d.eventName=c,a.dispatchEvent(d)):(d=b.createEventObject(),a.fireEvent("on"+c,d)),this},deepExtend:function(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},this.deepExtend(a[c],b[c])):a[c]=b[c];return a},pasteHook:function(a){var c,d,e,f=b.createElement("textarea"),h=this.element,i=this.settings,j=this.medium,k=this.html;f.className=i.cssClasses.pasteHook,h.parentNode.appendChild(f),f.focus(),g||j.makeUndoable(),setTimeout(function(){h.focus(),i.maxLength>0&&(c=k.text(h),d=c.length,e=d+f.value.length,e>d&&(f.value=f.value.substring(0,i.maxLength-d))),a(f.value),k.deleteNode(f)},2)},setupContents:function(){var a,c=this.element,d=c.children,e=c.childNodes;!this.settings.tags.paragraph||d.length>0||this.settings.mode===i.inlineMode||(e.length>0?(a=b.createElement(this.settings.tags.paragraph),c.innerHTML.match("^[&]nbsp[;]")&&(c.innerHTML=c.innerHTML.substring(6,c.innerHTML.length-1)),a.innerHTML=c.innerHTML,c.innerHTML="",c.appendChild(a),this.cursor.set(a.innerHTML.length,a)):(a=b.createElement(this.settings.tags.paragraph),a.innerHTML="&nbsp;",c.appendChild(a)))},traverseAll:function(a,b,c){var d,e=a.childNodes,f=e.length,g=0,c=c||1;if(b=b||{},f>0)for(;f>g;g++){switch(d=e[g],d.nodeType){case 1:this.traverseAll(d,b,c+1),void 0!==b.element&&b.element(d,g,c,a);break;case 3:void 0!==b.fragment&&b.fragment(d,g,c,a)}f=e.length,d===a.lastChild&&(g=f)}}},i.Selection=function(){},i.Selection.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},saveSelection:function(){if(a.getSelection){var c=a.getSelection();if(c.rangeCount>0)return c.getRangeAt(0)}else if(b.selection&&b.selection.createRange)return b.selection.createRange();return null},restoreSelection:function(c){if(c)if(a.getSelection){var d=a.getSelection();d.removeAllRanges(),d.addRange(c)}else b.selection&&c.select&&c.select()}},i.Cursor=function(){},i.Cursor.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},set:function(c,d){var e,f=this.html;if(b.createRange){var g=a.getSelection(),h=f.lastChild(),i=f.text(h).length-1,j=d?d:h,k="undefined"!=typeof c&&null!==c?c:i;e=b.createRange(),e.setStart(j,k),e.collapse(!0),g.removeAllRanges(),g.addRange(e)}else e=b.body.createTextRange(),e.moveToElementText(d),e.collapse(!1),e.select()},parent:function(){var c,d=null;return a.getSelection?(c=a.getSelection().getRangeAt(0),d=c.commonAncestorContainer,d=1===d.nodeType?d:d.parentNode):b.selection&&(d=b.selection.createRange().parentElement()),"SPAN"==d.tagName&&(d=d.parentNode),d},caretToBeginning:function(a){this.set(0,a)},caretToEnd:function(a){this.set(this.html.text(a).length,a)}},i.HtmlAssistant=function(){},i.HtmlAssistant.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},encodeHtml:function(a){return b.createElement("a").appendChild(b.createTextNode(a)).parentNode.innerHTML},text:function(a,b){if(a=a||this.settings.element,b)a.textContent&&"undefined"!=typeof a.textContent?a.textContent=b:a.innerText=b;else{if(a.innerText)return c(a.innerText);if(a.textContent)return c(a.textContent);if(a.data)return c(a.data)}return""},changeTag:function(a,c){var d,e,f=b.createElement(c);for(d=a.firstChild;d;)e=d.nextSibling,f.appendChild(d),d=e;return a.parentNode.insertBefore(f,a),a.parentNode.removeChild(a),f},deleteNode:function(a){a.parentNode.removeChild(a)},placeholders:function(){if(a.getComputedStyle){var d=this.settings,e=this.medium.placeholder||(this.medium.placeholder=b.createElement("div")),f=d.element,g=e.style,h=a.getComputedStyle(f,null),j=function(a){return h.getPropertyValue(a)},k=this.utils,l=k.html.text(f),m=this.cursor,n=f.children.length;if(f.placeholder=e,l.length<1&&2>n){if(f.placeHolderActive)return;f.innerHTML.match("<"+d.tags.paragraph)||(f.innerHTML=""),d.placeholder.length>0&&(e.setup||(e.setup=!0,g.background=j("background"),g.backgroundColor=j("background-color"),g.fontSize=j("font-size"),g.color=h.color,g.marginTop=j("margin-top"),g.marginBottom=j("margin-bottom"),g.marginLeft=j("margin-left"),g.marginRight=j("margin-right"),g.paddingTop=j("padding-top"),g.paddingBottom=j("padding-bottom"),g.paddingLeft=j("padding-left"),g.paddingRight=j("padding-right"),g.borderTopWidth=j("border-top-width"),g.borderTopColor=j("border-top-color"),g.borderTopStyle=j("border-top-style"),g.borderBottomWidth=j("border-bottom-width"),g.borderBottomColor=j("border-bottom-color"),g.borderBottomStyle=j("border-bottom-style"),g.borderLeftWidth=j("border-left-width"),g.borderLeftColor=j("border-left-color"),g.borderLeftStyle=j("border-left-style"),g.borderRightWidth=j("border-right-width"),g.borderRightColor=j("border-right-color"),g.borderRightStyle=j("border-right-style"),e.className=d.cssClasses.placeholder+" "+d.cssClasses.placeholder+"-"+d.mode,e.innerHTML="<div>"+d.placeholder+"</div>",f.parentNode.insertBefore(e,f)),f.className+=" "+d.cssClasses.clear,g.display="",g.minHeight=f.clientHeight+"px",g.minWidth=f.clientWidth+"px",d.mode!==i.inlineMode&&(k.setupContents(),0===n&&f.firstChild&&m.set(0,f.firstChild))),f.placeHolderActive=!0}else f.placeHolderActive&&(f.placeHolderActive=!1,g.display="none",f.className=c(f.className.replace(d.cssClasses.clear,"")),k.setupContents())}},clean:function(b){var c,d,e,f=this.settings,g=f.cssClasses.placeholder,h=(f.attributes||{}).remove||[],i=f.tags||{},j=i.outerLevel||null,k=i.innerLevel||null,l={},m={},n=(i.paragraph||"").toUpperCase(),o=this.html;if(b=b||f.element,null!==j)for(e=0;e<j.length;e++)l[j[e].toUpperCase()]=!0;if(null!==k)for(e=0;e<k.length;e++)m[k[e].toUpperCase()]=!0;this.utils.traverseAll(b,{element:function(b,f,i,p){var q=b.nodeName,r=!0;for(e=0;e<h.length;e++)c=h[e],b.hasAttribute(c)&&b.getAttribute(c)!==g&&b.removeAttribute(c);if((null!==j||null!==k)&&(1===i&&void 0!==l[q]?r=!1:i>1&&void 0!==m[q]&&(r=!1),r))if("block"===a.getComputedStyle(b,null).getPropertyValue("display")){if(n.length>0&&n!==q&&o.changeTag(b,n),i>1)for(;p.childNodes.length>f;)p.parentNode.insertBefore(p.lastChild,p.nextSibling)}else switch(q){case"BR":if(b===b.parentNode.lastChild){if(b===b.parentNode.firstChild)break;d=document.createTextNode(""),d.innerHTML="&nbsp",p.insertBefore(d,b);break}default:for(;null!==b.firstChild;)p.insertBefore(b.firstChild,b);o.deleteNode(b)}}})},lastChild:function(){return this.element.lastChild},addTag:function(a,c,d,e){if(!this.settings.beforeAddTag(a,c,d,e)){var f,g=b.createElement(a);return"undefined"!=typeof d&&d===!1&&(g.contentEditable=!1),0==g.innerHTML.length&&(g.innerHTML=" "),e&&e.nextSibling?(e.parentNode.insertBefore(g,e.nextSibling),f=e.nextSibling):(this.settings.element.appendChild(g),f=this.html.lastChild()),c&&(this.cache.focusedElement=f,this.cursor.set(0,f)),g}return null},baseAtCaret:function(){if(!this.medium.isActive())return null;var b=a.getSelection?a.getSelection():document.selection;if(b.rangeCount){var c=b.getRangeAt(0),d=c.endContainer;switch(d.nodeType){case 3:if(d.data&&d.data.length!=c.endOffset)return!1}return d}return null},atCaret:function(){var a=this.baseAtCaret()||{},b=this.element;if(a===!1)return null;for(;a&&a.parentNode!==b;)a=a.parentNode;return a&&1==a.nodeType?a:null}},i.Action=function(){},i.Action.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]},listen:function(){var a=this.element,b=this.intercept;this.utils.addEvent(a,"keyup",b.up).addEvent(a,"keydown",b.down).addEvent(a,"focus",b.focus).addEvent(a,"blur",b.blur).addEvent(a,"paste",this.settings.pasteEventHandler)},preserveElementFocus:function(){var c=a.getSelection?a.getSelection().anchorNode:b.activeElement;if(c){var d,e=this.medium.cache,f=this.settings,g=c.parentNode,h=f.element.children,i=g!==e.focusedElement,j=0;for(g===f.element&&(g=c),d=0;d<h.length;d++)if(g===h[d]){j=d;break}i&&(e.focusedElement=g,e.focusedElementIndex=j)}}},i.Cache=function(){this.initialized=!1,this.cmd=!1,this.focusedElement=null},i.Cache.prototype={setBridge:function(a){for(var b in a)this[b]=a[b]}},i.inlineMode="inline",i.partialMode="partial",i.richMode="rich",i.Messages={pastHere:"Paste Here"},i}();"function"==typeof define&&define.amd?define(function(){return c}):"undefined"!=typeof module&&module.exports?module.exports=c:"undefined"!=typeof this&&(this.Medium=c)}.call(this,window,document),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";function b(a){return"string"==typeof a?parseInt(a,10):~~a}var c={wheelSpeed:1,wheelPropagation:!1,swipePropagation:!0,minScrollbarLength:null,maxScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1},d=0,e=function(){var a=d++;return function(b){var c=".perfect-scrollbar-"+a;return"undefined"==typeof b?c:b+c}},f="WebkitAppearance"in document.documentElement.style;a.fn.perfectScrollbar=function(d,g){return this.each(function(){function h(a,c){var d=a+c,e=C-K;L=0>d?0:d>e?e:d;var f=b(L*(E-C)/(C-K));z.scrollTop(f)}function i(a,c){var d=a+c,e=B-G;H=0>d?0:d>e?e:d;var f=b(H*(D-B)/(B-G));z.scrollLeft(f)}function j(a){return y.minScrollbarLength&&(a=Math.max(a,y.minScrollbarLength)),y.maxScrollbarLength&&(a=Math.min(a,y.maxScrollbarLength)),a}function k(){var a={width:I};a.left=N?z.scrollLeft()+B-D:z.scrollLeft(),T?a.bottom=S-z.scrollTop():a.top=U+z.scrollTop(),Q.css(a);var b={top:z.scrollTop(),height:M};$?b.right=N?D-z.scrollLeft()-Z-Y.outerWidth():Z-z.scrollLeft():b.left=N?z.scrollLeft()+2*B-D-_-Y.outerWidth():_+z.scrollLeft(),X.css(b),R.css({left:H,width:G-V}),Y.css({top:L,height:K-ab})}function l(){z.removeClass("ps-active-x"),z.removeClass("ps-active-y"),B=y.includePadding?z.innerWidth():z.width(),C=y.includePadding?z.innerHeight():z.height(),D=z.prop("scrollWidth"),E=z.prop("scrollHeight"),!y.suppressScrollX&&B+y.scrollXMarginOffset<D?(F=!0,I=B-W,G=j(b(I*B/D)),H=b(z.scrollLeft()*(I-G)/(D-B))):(F=!1,G=0,H=0,z.scrollLeft(0)),!y.suppressScrollY&&C+y.scrollYMarginOffset<E?(J=!0,M=C-bb,K=j(b(M*C/E)),L=b(z.scrollTop()*(M-K)/(E-C))):(J=!1,K=0,L=0,z.scrollTop(0)),H>=I-G&&(H=I-G),L>=M-K&&(L=M-K),k(),F&&z.addClass("ps-active-x"),J&&z.addClass("ps-active-y")}function m(){var b,c,d=function(a){i(b,a.pageX-c),l(),a.stopPropagation(),a.preventDefault()},e=function(){Q.removeClass("in-scrolling"),a(P).unbind(O("mousemove"),d)};R.bind(O("mousedown"),function(f){c=f.pageX,b=R.position().left,Q.addClass("in-scrolling"),a(P).bind(O("mousemove"),d),a(P).one(O("mouseup"),e),f.stopPropagation(),f.preventDefault()}),b=c=null}function n(){var b,c,d=function(a){h(b,a.pageY-c),l(),a.stopPropagation(),a.preventDefault()},e=function(){X.removeClass("in-scrolling"),a(P).unbind(O("mousemove"),d)};Y.bind(O("mousedown"),function(f){c=f.pageY,b=Y.position().top,X.addClass("in-scrolling"),a(P).bind(O("mousemove"),d),a(P).one(O("mouseup"),e),f.stopPropagation(),f.preventDefault()}),b=c=null}function o(a,b){var c=z.scrollTop();if(0===a){if(!J)return!1;if(0===c&&b>0||c>=E-C&&0>b)return!y.wheelPropagation}var d=z.scrollLeft();if(0===b){if(!F)return!1;if(0===d&&0>a||d>=D-B&&a>0)return!y.wheelPropagation}return!0}function p(a,b){var c=z.scrollTop(),d=z.scrollLeft(),e=Math.abs(a),f=Math.abs(b);if(f>e){if(0>b&&c===E-C||b>0&&0===c)return!y.swipePropagation}else if(e>f&&(0>a&&d===D-B||a>0&&0===d))return!y.swipePropagation;return!0}function q(){function a(a){var b=a.originalEvent.deltaX,c=-1*a.originalEvent.deltaY;return("undefined"==typeof b||"undefined"==typeof c)&&(b=-1*a.originalEvent.wheelDeltaX/6,c=a.originalEvent.wheelDeltaY/6),a.originalEvent.deltaMode&&1===a.originalEvent.deltaMode&&(b*=10,c*=10),b!==b&&c!==c&&(b=0,c=a.originalEvent.wheelDelta),[b,c]}function b(b){if(f||!(z.find("select:focus").length>0)){var d=a(b),e=d[0],g=d[1];c=!1,y.useBothWheelAxes?J&&!F?(z.scrollTop(g?z.scrollTop()-g*y.wheelSpeed:z.scrollTop()+e*y.wheelSpeed),c=!0):F&&!J&&(z.scrollLeft(e?z.scrollLeft()+e*y.wheelSpeed:z.scrollLeft()-g*y.wheelSpeed),c=!0):(z.scrollTop(z.scrollTop()-g*y.wheelSpeed),z.scrollLeft(z.scrollLeft()+e*y.wheelSpeed)),l(),c=c||o(e,g),c&&(b.stopPropagation(),b.preventDefault())}}var c=!1;"undefined"!=typeof window.onwheel?z.bind(O("wheel"),b):"undefined"!=typeof window.onmousewheel&&z.bind(O("mousewheel"),b)}function r(){var b=!1;z.bind(O("mouseenter"),function(){b=!0}),z.bind(O("mouseleave"),function(){b=!1});var c=!1;a(P).bind(O("keydown"),function(d){if((!d.isDefaultPrevented||!d.isDefaultPrevented())&&b){for(var e=document.activeElement?document.activeElement:P.activeElement;e.shadowRoot;)e=e.shadowRoot.activeElement;if(!a(e).is(":input,[contenteditable]")){var f=0,g=0;switch(d.which){case 37:f=-30;break;case 38:g=30;break;case 39:f=30;break;case 40:g=-30;break;case 33:g=90;break;case 32:case 34:g=-90;break;case 35:g=d.ctrlKey?-E:-C;break;case 36:g=d.ctrlKey?z.scrollTop():C;break;default:return}z.scrollTop(z.scrollTop()-g),z.scrollLeft(z.scrollLeft()+f),c=o(f,g),c&&d.preventDefault()}}})}function s(){function a(a){a.stopPropagation()}Y.bind(O("click"),a),X.bind(O("click"),function(a){var c=b(K/2),d=a.pageY-X.offset().top-c,e=C-K,f=d/e;0>f?f=0:f>1&&(f=1),z.scrollTop((E-C)*f)}),R.bind(O("click"),a),Q.bind(O("click"),function(a){var c=b(G/2),d=a.pageX-Q.offset().left-c,e=B-G,f=d/e;0>f?f=0:f>1&&(f=1),z.scrollLeft((D-B)*f)})}function t(){function b(){var a=window.getSelection?window.getSelection():document.getSlection?document.getSlection():{rangeCount:0};return 0===a.rangeCount?null:a.getRangeAt(0).commonAncestorContainer}function c(){e||(e=setInterval(function(){return A()?(z.scrollTop(z.scrollTop()+f.top),z.scrollLeft(z.scrollLeft()+f.left),void l()):void clearInterval(e)},50))}function d(){e&&(clearInterval(e),e=null),Q.removeClass("in-scrolling"),X.removeClass("in-scrolling")}var e=null,f={top:0,left:0},g=!1;a(P).bind(O("selectionchange"),function(){a.contains(z[0],b())?g=!0:(g=!1,d())}),a(window).bind(O("mouseup"),function(){g&&(g=!1,d())}),a(window).bind(O("mousemove"),function(a){if(g){var b={x:a.pageX,y:a.pageY},e=z.offset(),h={left:e.left,right:e.left+z.outerWidth(),top:e.top,bottom:e.top+z.outerHeight()};b.x<h.left+3?(f.left=-5,Q.addClass("in-scrolling")):b.x>h.right-3?(f.left=5,Q.addClass("in-scrolling")):f.left=0,b.y<h.top+3?(f.top=h.top+3-b.y<5?-5:-20,X.addClass("in-scrolling")):b.y>h.bottom-3?(f.top=b.y-h.bottom+3<5?5:20,X.addClass("in-scrolling")):f.top=0,0===f.top&&0===f.left?d():c()}})}function u(b,c){function d(a,b){z.scrollTop(z.scrollTop()-b),z.scrollLeft(z.scrollLeft()-a),l()}function e(){r=!0}function f(){r=!1}function g(a){return a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:a.originalEvent}function h(a){var b=a.originalEvent;return b.targetTouches&&1===b.targetTouches.length?!0:b.pointerType&&"mouse"!==b.pointerType&&b.pointerType!==b.MSPOINTER_TYPE_MOUSE?!0:!1}function i(a){if(h(a)){s=!0;var b=g(a);m.pageX=b.pageX,m.pageY=b.pageY,n=(new Date).getTime(),null!==q&&clearInterval(q),a.stopPropagation()}}function j(a){if(!r&&s&&h(a)){var b=g(a),c={pageX:b.pageX,pageY:b.pageY},e=c.pageX-m.pageX,f=c.pageY-m.pageY;d(e,f),m=c;var i=(new Date).getTime(),j=i-n;j>0&&(o.x=e/j,o.y=f/j,n=i),p(e,f)&&(a.stopPropagation(),a.preventDefault())}}function k(){!r&&s&&(s=!1,clearInterval(q),q=setInterval(function(){return A()?Math.abs(o.x)<.01&&Math.abs(o.y)<.01?void clearInterval(q):(d(30*o.x,30*o.y),o.x*=.8,void(o.y*=.8)):void clearInterval(q)},10))}var m={},n=0,o={},q=null,r=!1,s=!1;b&&(a(window).bind(O("touchstart"),e),a(window).bind(O("touchend"),f),z.bind(O("touchstart"),i),z.bind(O("touchmove"),j),z.bind(O("touchend"),k)),c&&(window.PointerEvent?(a(window).bind(O("pointerdown"),e),a(window).bind(O("pointerup"),f),z.bind(O("pointerdown"),i),z.bind(O("pointermove"),j),z.bind(O("pointerup"),k)):window.MSPointerEvent&&(a(window).bind(O("MSPointerDown"),e),a(window).bind(O("MSPointerUp"),f),z.bind(O("MSPointerDown"),i),z.bind(O("MSPointerMove"),j),z.bind(O("MSPointerUp"),k)))}function v(){z.bind(O("scroll"),function(){l()})}function w(){z.unbind(O()),a(window).unbind(O()),a(P).unbind(O()),z.data("perfect-scrollbar",null),z.data("perfect-scrollbar-update",null),z.data("perfect-scrollbar-destroy",null),R.remove(),Y.remove(),Q.remove(),X.remove(),z=Q=X=R=Y=F=J=B=C=D=E=G=H=S=T=U=K=L=Z=$=_=N=O=null}function x(){l(),v(),m(),n(),s(),t(),q(),(cb||db)&&u(cb,db),y.useKeyboard&&r(),z.data("perfect-scrollbar",z),z.data("perfect-scrollbar-update",l),z.data("perfect-scrollbar-destroy",w)}var y=a.extend(!0,{},c),z=a(this),A=function(){return!!z};if("object"==typeof d?a.extend(!0,y,d):g=d,"update"===g)return z.data("perfect-scrollbar-update")&&z.data("perfect-scrollbar-update")(),z;if("destroy"===g)return z.data("perfect-scrollbar-destroy")&&z.data("perfect-scrollbar-destroy")(),z;if(z.data("perfect-scrollbar"))return z.data("perfect-scrollbar");z.addClass("ps-container");var B,C,D,E,F,G,H,I,J,K,L,M,N="rtl"===z.css("direction"),O=e(),P=this.ownerDocument||document,Q=a("<div class='ps-scrollbar-x-rail'>").appendTo(z),R=a("<div class='ps-scrollbar-x'>").appendTo(Q),S=b(Q.css("bottom")),T=S===S,U=T?null:b(Q.css("top")),V=b(Q.css("borderLeftWidth"))+b(Q.css("borderRightWidth")),W=b(Q.css("marginLeft"))+b(Q.css("marginRight")),X=a("<div class='ps-scrollbar-y-rail'>").appendTo(z),Y=a("<div class='ps-scrollbar-y'>").appendTo(X),Z=b(X.css("right")),$=Z===Z,_=$?null:b(X.css("left")),ab=b(X.css("borderTopWidth"))+b(X.css("borderBottomWidth")),bb=b(X.css("marginTop"))+b(X.css("marginBottom")),cb="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,db=null!==window.navigator.msMaxTouchPoints;return x(),z})}}),function(a,b){function c(){function c(b){var c=b||a.event,d=c.keyCode||c.which;if(-1!==[9,13,32,27].indexOf(d)){for(var e=c.target||c.srcElement,f=-1,g=0;g<y.length;g++)if(e===y[g]){f=g;break}9===d?(e=-1===f?w:f===y.length-1?y[0]:y[f+1],I(c),e.focus(),h(e,l.confirmButtonColor)):(e=13===d||32===d?-1===f?w:void 0:27!==d||x.hidden||"none"===x.style.display?void 0:x,void 0!==e&&H(e,c))}}function g(b){var c=b||a.event,d=c.target||c.srcElement,e=c.relatedTarget,f=v(p,"visible");if(f){var g=-1;if(null!==e){for(var h=0;h<y.length;h++)if(e===y[h]){g=h;break}-1===g&&d.focus()}else o=d}}if(void 0===arguments[0])return a.console.error("sweetAlert expects at least 1 attribute!"),!1;var l=f({},s);switch(typeof arguments[0]){case"string":l.title=arguments[0],l.text=arguments[1]||"",l.type=arguments[2]||"";break;case"object":if(void 0===arguments[0].title)return a.console.error('Missing "title" argument!'),!1;l.title=arguments[0].title,l.text=arguments[0].text||s.text,l.type=arguments[0].type||s.type,l.customClass=arguments[0].customClass||l.customClass,l.allowOutsideClick=arguments[0].allowOutsideClick||s.allowOutsideClick,l.showCancelButton=void 0!==arguments[0].showCancelButton?arguments[0].showCancelButton:s.showCancelButton,l.closeOnConfirm=void 0!==arguments[0].closeOnConfirm?arguments[0].closeOnConfirm:s.closeOnConfirm,l.closeOnCancel=void 0!==arguments[0].closeOnCancel?arguments[0].closeOnCancel:s.closeOnCancel,l.timer=arguments[0].timer||s.timer,l.confirmButtonText=s.showCancelButton?"Confirm":s.confirmButtonText,l.confirmButtonText=arguments[0].confirmButtonText||s.confirmButtonText,l.confirmButtonColor=arguments[0].confirmButtonColor||s.confirmButtonColor,l.cancelButtonText=arguments[0].cancelButtonText||s.cancelButtonText,l.imageUrl=arguments[0].imageUrl||s.imageUrl,l.imageSize=arguments[0].imageSize||s.imageSize,l.doneFunction=arguments[1]||null;break;default:return a.console.error('Unexpected type of argument! Expected "string" or "object", got '+typeof arguments[0]),!1}d(l),k(),i();for(var p=t(),q=function(b){var c=b||a.event,d=c.target||c.srcElement,f="confirm"===d.className,g=v(p,"visible"),h=l.doneFunction&&"true"===p.getAttribute("data-has-done-function");switch(c.type){case"mouseover":f&&(d.style.backgroundColor=e(l.confirmButtonColor,-.04));break;case"mouseout":f&&(d.style.backgroundColor=l.confirmButtonColor);break;case"mousedown":f&&(d.style.backgroundColor=e(l.confirmButtonColor,-.14));break;case"mouseup":f&&(d.style.backgroundColor=e(l.confirmButtonColor,-.04));break;case"focus":var i=p.querySelector("button.confirm"),k=p.querySelector("button.cancel");f?k.style.boxShadow="none":i.style.boxShadow="none";break;case"click":if(f&&h&&g)l.doneFunction(!0),l.closeOnConfirm&&j();else if(h&&g){var m=String(l.doneFunction).replace(/\s/g,""),n="function("===m.substring(0,9)&&")"!==m.substring(9,10);n&&l.doneFunction(!1),l.closeOnCancel&&j()}else j()}},r=p.querySelectorAll("button"),u=0;u<r.length;u++)r[u].onclick=q,r[u].onmouseover=q,r[u].onmouseout=q,r[u].onmousedown=q,r[u].onfocus=q;m=b.onclick,b.onclick=function(b){var c=b||a.event,d=c.target||c.srcElement,e=p===d,f=D(p,d),g=v(p,"visible"),h="true"===p.getAttribute("data-allow-ouside-click");!e&&!f&&g&&h&&j()};var w=p.querySelector("button.confirm"),x=p.querySelector("button.cancel"),y=p.querySelectorAll("button:not([type=hidden])");n=a.onkeydown,a.onkeydown=c,w.onblur=g,x.onblur=g,a.onfocus=function(){a.setTimeout(function(){void 0!==o&&(o.focus(),o=void 0)},0)}}function d(b){var c=t(),d=c.querySelector("h2"),e=c.querySelector("p"),f=c.querySelector("button.cancel"),g=c.querySelector("button.confirm");if(d.innerHTML=y(b.title).split("\n").join("<br>"),e.innerHTML=y(b.text||"").split("\n").join("<br>"),b.text&&A(e),b.customClass&&w(c,b.customClass),C(c.querySelectorAll(".icon")),b.type){for(var i=!1,j=0;j<r.length;j++)if(b.type===r[j]){i=!0;break}if(!i)return a.console.error("Unknown alert type: "+b.type),!1;var k=c.querySelector(".icon."+b.type);switch(A(k),b.type){case"success":w(k,"animate"),w(k.querySelector(".tip"),"animateSuccessTip"),w(k.querySelector(".long"),"animateSuccessLong");break;case"error":w(k,"animateErrorIcon"),w(k.querySelector(".x-mark"),"animateXMark");break;case"warning":w(k,"pulseWarning"),w(k.querySelector(".body"),"pulseWarningIns"),w(k.querySelector(".dot"),"pulseWarningIns")}}if(b.imageUrl){var l=c.querySelector(".icon.custom");l.style.backgroundImage="url("+b.imageUrl+")",A(l);var m=80,n=80;if(b.imageSize){var o=b.imageSize.split("x")[0],p=b.imageSize.split("x")[1];o&&p?(m=o,n=p,l.css({width:o+"px",height:p+"px"})):a.console.error("Parameter imageSize expects value with format WIDTHxHEIGHT, got "+b.imageSize)}l.setAttribute("style",l.getAttribute("style")+"width:"+m+"px; height:"+n+"px")}c.setAttribute("data-has-cancel-button",b.showCancelButton),b.showCancelButton?f.style.display="inline-block":C(f),b.cancelButtonText&&(f.innerHTML=y(b.cancelButtonText)),b.confirmButtonText&&(g.innerHTML=y(b.confirmButtonText)),g.style.backgroundColor=b.confirmButtonColor,h(g,b.confirmButtonColor),c.setAttribute("data-allow-ouside-click",b.allowOutsideClick);var q=b.doneFunction?!0:!1;c.setAttribute("data-has-done-function",q),c.setAttribute("data-timer",b.timer)}function e(a,b){a=String(a).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),b=b||0;var c,d,e="#";for(d=0;3>d;d++)c=parseInt(a.substr(2*d,2),16),c=Math.round(Math.min(Math.max(0,c+c*b),255)).toString(16),e+=("00"+c).substr(c.length);return e}function f(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function g(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?parseInt(b[1],16)+", "+parseInt(b[2],16)+", "+parseInt(b[3],16):null}function h(a,b){var c=g(b);a.style.boxShadow="0 0 2px rgba("+c+", 0.8), inset 0 0 0 1px rgba(0, 0, 0, 0.05)"}function i(){var a=t();F(u(),10),A(a),w(a,"showSweetAlert"),x(a,"hideSweetAlert"),l=b.activeElement;
var c=a.querySelector("button.confirm");c.focus(),setTimeout(function(){w(a,"visible")},500);var d=a.getAttribute("data-timer");"null"!==d&&""!==d&&(a.timeout=setTimeout(function(){j()},d))}function j(){var c=t();G(u(),5),G(c,5),x(c,"showSweetAlert"),w(c,"hideSweetAlert"),x(c,"visible");var d=c.querySelector(".icon.success");x(d,"animate"),x(d.querySelector(".tip"),"animateSuccessTip"),x(d.querySelector(".long"),"animateSuccessLong");var e=c.querySelector(".icon.error");x(e,"animateErrorIcon"),x(e.querySelector(".x-mark"),"animateXMark");var f=c.querySelector(".icon.warning");x(f,"pulseWarning"),x(f.querySelector(".body"),"pulseWarningIns"),x(f.querySelector(".dot"),"pulseWarningIns"),a.onkeydown=n,b.onclick=m,l&&l.focus(),o=void 0,clearTimeout(c.timeout)}function k(){var a=t();a.style.marginTop=E(t())}var l,m,n,o,p=".sweet-alert",q=".sweet-overlay",r=["error","warning","info","success"],s={title:"",text:"",type:null,allowOutsideClick:!1,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",confirmButtonColor:"#AEDEF4",cancelButtonText:"Cancel",imageUrl:null,imageSize:null,timer:null},t=function(){return b.querySelector(p)},u=function(){return b.querySelector(q)},v=function(a,b){return new RegExp(" "+b+" ").test(" "+a.className+" ")},w=function(a,b){v(a,b)||(a.className+=" "+b)},x=function(a,b){var c=" "+a.className.replace(/[\t\r\n]/g," ")+" ";if(v(a,b)){for(;c.indexOf(" "+b+" ")>=0;)c=c.replace(" "+b+" "," ");a.className=c.replace(/^\s+|\s+$/g,"")}},y=function(a){var c=b.createElement("div");return c.appendChild(b.createTextNode(a)),c.innerHTML},z=function(a){a.style.opacity="",a.style.display="block"},A=function(a){if(a&&!a.length)return z(a);for(var b=0;b<a.length;++b)z(a[b])},B=function(a){a.style.opacity="",a.style.display="none"},C=function(a){if(a&&!a.length)return B(a);for(var b=0;b<a.length;++b)B(a[b])},D=function(a,b){for(var c=b.parentNode;null!==c;){if(c===a)return!0;c=c.parentNode}return!1},E=function(a){a.style.left="-9999px",a.style.display="block";var b,c=a.clientHeight;return b="undefined"!=typeof getComputedStyle?parseInt(getComputedStyle(a).getPropertyValue("padding"),10):parseInt(a.currentStyle.padding),a.style.left="",a.style.display="none","-"+parseInt(c/2+b)+"px"},F=function(a,b){if(+a.style.opacity<1){b=b||16,a.style.opacity=0,a.style.display="block";var c=+new Date,d=function(){a.style.opacity=+a.style.opacity+(new Date-c)/100,c=+new Date,+a.style.opacity<1&&setTimeout(d,b)};d()}a.style.display="block"},G=function(a,b){b=b||16,a.style.opacity=1;var c=+new Date,d=function(){a.style.opacity=+a.style.opacity-(new Date-c)/100,c=+new Date,+a.style.opacity>0?setTimeout(d,b):a.style.display="none"};d()},H=function(c){if(MouseEvent){var d=new MouseEvent("click",{view:a,bubbles:!1,cancelable:!0});c.dispatchEvent(d)}else if(b.createEvent){var e=b.createEvent("MouseEvents");e.initEvent("click",!1,!1),c.dispatchEvent(e)}else b.createEventObject?c.fireEvent("onclick"):"function"==typeof c.onclick&&c.onclick()},I=function(b){"function"==typeof b.stopPropagation?(b.stopPropagation(),b.preventDefault()):a.event&&a.event.hasOwnProperty("cancelBubble")&&(a.event.cancelBubble=!0)};a.sweetAlertInitialize=function(){var a='<div class="sweet-overlay" tabIndex="-1"></div><div class="sweet-alert" tabIndex="-1"><div class="icon error"><span class="x-mark"><span class="line left"></span><span class="line right"></span></span></div><div class="icon warning"> <span class="body"></span> <span class="dot"></span> </div> <div class="icon info"></div> <div class="icon success"> <span class="line tip"></span> <span class="line long"></span> <div class="placeholder"></div> <div class="fix"></div> </div> <div class="icon custom"></div> <h2>Title</h2><p>Text</p><button class="cancel" tabIndex="2">Cancel</button><button class="confirm" tabIndex="1">OK</button></div>',c=b.createElement("div");c.innerHTML=a,b.body.appendChild(c)},a.sweetAlert=a.swal=function(){var a=arguments;if(null!==t())c.apply(this,a);else var b=setInterval(function(){null!==t()&&(clearInterval(b),c.apply(this,a))},100)},a.swal.setDefaults=function(a){if(!a)throw new Error("userParams is required");if("object"!=typeof a)throw new Error("userParams has to be a object");f(s,a)},function(){"complete"===b.readyState||"interactive"===b.readyState&&b.body?a.sweetAlertInitialize():b.addEventListener?b.addEventListener("DOMContentLoaded",function(){b.removeEventListener("DOMContentLoaded",arguments.callee,!1),a.sweetAlertInitialize()},!1):b.attachEvent&&b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&(b.detachEvent("onreadystatechange",arguments.callee),a.sweetAlertInitialize())})}()}(window,document),function(a,b,c,d){function e(b,c){this.options=a.extend(!0,{},f,c),this.input=b,this.$input=a(b),this._defaults=f,this._name="geocomplete",this.init()}var f={bounds:!0,country:null,map:!1,details:!1,detailsAttribute:"name",autoselect:!0,location:!1,mapOptions:{zoom:14,scrollwheel:!1,mapTypeId:"roadmap"},markerOptions:{draggable:!1},maxZoom:16,types:["geocode"],blur:!1},g="street_address route intersection political country administrative_area_level_1 administrative_area_level_2 administrative_area_level_3 colloquial_area locality sublocality neighborhood premise subpremise postal_code natural_feature airport park point_of_interest post_box street_number floor room lat lng viewport location formatted_address location_type bounds".split(" "),h="id place_id url website vicinity reference name rating international_phone_number icon formatted_phone_number".split(" ");a.extend(e.prototype,{init:function(){this.initMap(),this.initMarker(),this.initGeocoder(),this.initDetails(),this.initLocation()},initMap:function(){if(this.options.map){if("function"==typeof this.options.map.setCenter)return void(this.map=this.options.map);this.map=new google.maps.Map(a(this.options.map)[0],this.options.mapOptions),google.maps.event.addListener(this.map,"click",a.proxy(this.mapClicked,this)),google.maps.event.addListener(this.map,"zoom_changed",a.proxy(this.mapZoomed,this))}},initMarker:function(){if(this.map){var b=a.extend(this.options.markerOptions,{map:this.map});b.disabled||(this.marker=new google.maps.Marker(b),google.maps.event.addListener(this.marker,"dragend",a.proxy(this.markerDragged,this)))}},initGeocoder:function(){var b={types:this.options.types,bounds:this.options.bounds===!0?null:this.options.bounds,componentRestrictions:this.options.componentRestrictions};this.options.country&&(b.componentRestrictions={country:this.options.country}),this.autocomplete=new google.maps.places.Autocomplete(this.input,b),this.geocoder=new google.maps.Geocoder,this.map&&this.options.bounds===!0&&this.autocomplete.bindTo("bounds",this.map),google.maps.event.addListener(this.autocomplete,"place_changed",a.proxy(this.placeChanged,this)),this.$input.keypress(function(a){return 13===a.keyCode?!1:void 0}),this.$input.bind("geocode",a.proxy(function(){this.find()},this)),this.options.blur===!0&&this.$input.blur(a.proxy(function(){this.find()},this))},initDetails:function(){function b(a){e[a]=c.find("["+d+"="+a+"]")}if(this.options.details){var c=a(this.options.details),d=this.options.detailsAttribute,e={};a.each(g,function(a,c){b(c),b(c+"_short")}),a.each(h,function(a,c){b(c)}),this.$details=c,this.details=e}},initLocation:function(){var a,b=this.options.location;if(b){if("string"==typeof b)return void this.find(b);b instanceof Array&&(a=new google.maps.LatLng(b[0],b[1])),b instanceof google.maps.LatLng&&(a=b),a&&(this.map&&this.map.setCenter(a),this.marker&&this.marker.setPosition(a))}},find:function(a){this.geocode({address:a||this.$input.val()})},geocode:function(b){this.options.bounds&&!b.bounds&&(b.bounds=this.options.bounds===!0?this.map&&this.map.getBounds():this.options.bounds),this.options.country&&(b.region=this.options.country),this.geocoder.geocode(b,a.proxy(this.handleGeocode,this))},selectFirstResult:function(){var b="";a(".pac-item-selected")[0]&&(b="-selected");var c=a(".pac-container .pac-item"+b+":first span:nth-child(2)").text(),d=a(".pac-container .pac-item"+b+":first span:nth-child(3)").text(),e=c;return d&&(e+=" - "+d),this.$input.val(e),e},handleGeocode:function(a,b){if(b===google.maps.GeocoderStatus.OK){var c=a[0];this.$input.val(c.formatted_address),this.update(c),a.length>1&&this.trigger("geocode:multiple",a)}else this.trigger("geocode:error",b)},trigger:function(a,b){this.$input.trigger(a,[b])},center:function(a){a.viewport?(this.map.fitBounds(a.viewport),this.map.getZoom()>this.options.maxZoom&&this.map.setZoom(this.options.maxZoom)):(this.map.setZoom(this.options.maxZoom),this.map.setCenter(a.location)),this.marker&&(this.marker.setPosition(a.location),this.marker.setAnimation(this.options.markerOptions.animation))},update:function(a){this.map&&this.center(a.geometry),this.$details&&this.fillDetails(a),this.trigger("geocode:result",a)},fillDetails:function(b){var c={},d=b.geometry,e=d.viewport,f=d.bounds;a.each(b.address_components,function(b,d){d.types[0];a.each(d.types,function(a,b){c[b]=d.long_name,c[b+"_short"]=d.short_name})}),a.each(h,function(a,d){c[d]=b[d]}),a.extend(c,{formatted_address:b.formatted_address,location_type:d.location_type||"PLACES",viewport:e,bounds:f,location:d.location,lat:d.location.lat(),lng:d.location.lng()}),a.each(this.details,a.proxy(function(a,b){var d=c[a];this.setDetail(b,d)},this)),this.data=c},setDetail:function(a,b){b===d?b="":"function"==typeof b.toUrlValue&&(b=b.toUrlValue()),a.is(":input")?a.val(b):a.text(b)},markerDragged:function(a){this.trigger("geocode:dragged",a.latLng)},mapClicked:function(a){this.trigger("geocode:click",a.latLng)},mapZoomed:function(){this.trigger("geocode:zoom",this.map.getZoom())},resetMarker:function(){this.marker.setPosition(this.data.location),this.setDetail(this.details.lat,this.data.location.lat()),this.setDetail(this.details.lng,this.data.location.lng())},placeChanged:function(){var a=this.autocomplete.getPlace();if(a&&a.geometry)this.update(a);else if(this.options.autoselect){var b=this.selectFirstResult();this.find(b)}}}),a.fn.geocomplete=function(b){var c="plugin_geocomplete";if("string"==typeof b){var d=a(this).data(c)||a(this).geocomplete().data(c),f=d[b];return"function"==typeof f?(f.apply(d,Array.prototype.slice.call(arguments,1)),a(this)):(2==arguments.length&&(f=arguments[1]),f)}return this.each(function(){var d=a.data(this,c);d||(d=new e(this,b),a.data(this,c,d))})}}(jQuery,window,document),function(a,b){if(!a)return b;var c=function(){this.el=b,this.items=b,this.sizes=[],this.max=[0,0],this.current=0,this.interval=b,this.opts={speed:500,delay:3e3,complete:b,keys:!b,dots:b,fluid:b};var c=this;this.init=function(b,c){return this.el=b,this.ul=b.children("ul"),this.max=[b.outerWidth(),b.outerHeight()],this.items=this.ul.children("li").each(this.calculate),this.opts=a.extend(this.opts,c),this.setup(),this},this.calculate=function(b){var d=a(this),e=d.outerWidth(),f=d.outerHeight();c.sizes[b]=[e,f],e>c.max[0]&&(c.max[0]=e),f>c.max[1]&&(c.max[1]=f)},this.setup=function(){if(this.el.css({overflow:"hidden",width:c.max[0],height:this.items.first().outerHeight()}),this.ul.css({width:100*this.items.length+"%",position:"relative"}),this.items.css("width",100/this.items.length+"%"),this.opts.delay!==b&&(this.start(),this.el.hover(this.stop,this.start)),this.opts.keys&&a(document).keydown(this.keys),this.opts.dots&&this.dots(),this.opts.fluid){var d=function(){c.el.css("width",Math.min(Math.round(c.el.outerWidth()/c.el.parent().outerWidth()*100),100)+"%")};d(),a(window).resize(d)}this.opts.arrows&&this.el.parent().append('<p class="arrows"><span class="prev">â†</span><span class="next">â†’</span></p>').find(".arrows span").click(function(){a.isFunction(c[this.className])&&c[this.className]()}),a.event.swipe&&this.el.on("swipeleft",c.prev).on("swiperight",c.next)},this.move=function(b,d){this.items.eq(b).length||(b=0),0>b&&(b=this.items.length-1);var e=this.items.eq(b),f={height:e.outerHeight()},g=d?5:this.opts.speed;this.ul.is(":animated")||(c.el.find(".dot:eq("+b+")").addClass("active").siblings().removeClass("active"),this.el.animate(f,g)&&this.ul.animate(a.extend({left:"-"+b+"00%"},f),g,function(){c.current=b,a.isFunction(c.opts.complete)&&!d&&c.opts.complete(c.el)}))},this.start=function(){c.interval=setInterval(function(){c.move(c.current+1)},c.opts.delay)},this.stop=function(){return c.interval=clearInterval(c.interval),c},this.keys=function(b){var d=b.which,e={37:c.prev,39:c.next,27:c.stop};a.isFunction(e[d])&&e[d]()},this.next=function(){return c.stop().move(c.current+1)},this.prev=function(){return c.stop().move(c.current-1)},this.dots=function(){var b='<ol class="dots">';a.each(this.items,function(a){b+='<li class="dot'+(1>a?" active":"")+'">'+(a+1)+"</li>"}),b+="</ol>",this.el.addClass("has-dots").append(b).find(".dot").click(function(){c.move(a(this).index())})}};a.fn.unslider=function(b){var d=this.length;return this.each(function(e){var f=a(this),g=(new c).init(f,b);f.data("unslider"+(d>1?"-"+(e+1):""),g)})}}(window.jQuery,!1),function(a){function b(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,d=a.ui.mouse.prototype,e=d._mouseInit,f=d._mouseDestroy;d._touchStart=function(a){var d=this;!c&&d._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,d._touchMoved=!1,b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))},d._touchMove=function(a){c&&(this._touchMoved=!0,b(a,"mousemove"))},d._touchEnd=function(a){c&&(b(a,"mouseup"),b(a,"mouseout"),this._touchMoved||b(a,"click"),c=!1)},d._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),e.call(b)},d._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),f.call(b)}}}(jQuery),jQuery(document).ready(function(a){function b(a){if(a)if(window.getSelection){var b=window.getSelection();b.removeAllRanges(),b.addRange(a)}else document.selection&&a.select&&a.select()}var c=lasso_editor.editor,d=lasso_editor.strings,e=lasso_editor.settingsLink,f=lasso_editor.article_object,g=lasso_editor.toolbar,h=lasso_editor.toolbarHeadings,i=lasso_editor.component_sidebar,j=(lasso_editor.postid,lasso_editor.component_modal,lasso_editor.components),k=lasso_editor.featImgClass,l=(lasso_editor.featImgNonce,lasso_editor.titleClass),m=lasso_editor.featImgControls,n=lasso_editor.wpImgEdit,o=lasso_editor.handle,p=(lasso_editor.mapFormFooter,lasso_editor.mapLocations),q=lasso_editor.mapZoom,r=lasso_editor.mapStart,s=lasso_editor.objectsNoSave,t=lasso_editor.supportedNoSave;0==f.length&&swal({title:d.warning,type:"info",text:d.missingClass,showCancelButton:!0,cancelButtonText:d.cancelText,confirmButtonColor:"#007aab",confirmButtonText:d.missingConfirm,closeOnConfirm:!1},function(){location.replace(e)}),a("#lasso--edit").click(function(d){function e(){a("body").removeClass("lasso-sidebar-open lasso-editing"),a(".lasso--toolbar_wrap, #lasso--sidebar, #lasso--featImgControls, #lasso--wpimg-edit, #lasso--exit").fadeOut().remove(),a("#lasso--edit").css("opacity",1),a(".lasso--controls__right").css("opacity",0),a(f).attr("id",""),a(".lasso--wpimg__wrap").each(function(){a(this).children().unwrap()}),a("#lasso--map-form").each(function(){var b=a(this);b.find(".lasso-component--controls, .lasso--map-form__footer ").remove(),b.children().unwrap()}),a(l).attr("contenteditable",!1),articleMedium.destroy()}d.preventDefault(),a("body").toggleClass("lasso-editing"),a(f).attr("id",c),a(g).hide().appendTo("body").fadeIn(300),a(".lasso--controls__right").css("opacity",1),a("#"+c).attr("contenteditable",!0),a("body").append(i),a(k).length>0&&a(k).append(m),a(l).length>0&&a(l).attr("contenteditable",!0),a(".scroll-nav__section").each(function(){a(this).children().unwrap()}),a(".lasso--controls__right ").prepend('<a title="Exit Editor" id="lasso--exit" href="#"></a>'),a(".aesop-component").each(function(){if(!a(".lasso-component--toolbar").length>0)if(a(this).hasClass("aesop-map-component")){var b=a(this);b.wrap('<div id="lasso--map-form" class="aesop-component aesop-map-component lasso--map-drag-holder" data-component-type="map" >').before(o)}else a(this).append(o)}),a("[class*='wp-image-']").each(function(){var b=a(this);!a(".lasso--wpimg-edit").length>0&&(b.parent().hasClass("wp-caption")?b.parent().addClass("lasso--wpimg__wrap"):b.wrap('<div data-component-type="wpimg" class="lasso--wpimg__wrap lasso-component">'),b.parent().prepend(n))}),a(".lasso-component:not(.lasso--wpimg__wrap)").each(function(){a(this);!a(".lasso-component--toolbar").length>0&&a(this).append(o)}),a(s).remove(),a(t).remove(),article=document.getElementById(c),articleMedium=new Medium({element:article,mode:Medium.richMode,attributes:null,tags:null,placeholder:lasso_editor.strings.justWrite,pasteAsText:!0,cssClasses:{editor:"lasso-editor",pasteHook:"lasso-editor-paste-hook",placeholder:"lasso-editor-placeholder",clear:"lasso-editor-clear"}}),document.execCommand("defaultParagraphSeparator",!1,"p"),article.highlight=function(){return document.activeElement===article?!1:void articleMedium.select()},document.getElementById("lasso-toolbar--bold").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("b"),!1},document.getElementById("lasso-toolbar--underline").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("u"),!1},document.getElementById("lasso-toolbar--italic").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("i"),!1},h&&(document.getElementById("lasso-toolbar--h2").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("h2"),!1},document.getElementById("lasso-toolbar--h3").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("h3"),!1}),document.getElementById("lasso-toolbar--strike").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("strike"),!1},document.getElementById("lasso-toolbar--link__create").onmousedown=function(){b(window.selRange),articleMedium.insertHtml('<a class="lasso-link" href="'+a("#lasso-toolbar--link__inner").text()+'">'+window.selRange+"</a>");var c=window.selRange.startContainer.parentNode,d=c.localName;if("a"==d){var e=a(window.selRange.startContainer.parentNode);e.replaceWith(e[0].innerHTML)}return window.selRange=null,a("#lasso-toolbar--link").removeClass("link--drop-up"),!1},document.getElementById("lasso-toolbar--html__insert").onmousedown=function(){b(window.selRange);var c,d=window.selRange.startContainer;if(c=d.localName,"p"==c){var e=a(d),f=a("#lasso-toolbar--html__inner").text();f=a(f),f.insertAfter(e),e.remove()}else if(d=d.parentNode,c=d.localName,"p"==c){var e=a(d),f=a("#lasso-toolbar--html__inner").text();f=a(f),f.insertAfter(e)}else articleMedium.insertHtml(a("#lasso-toolbar--html__inner").text());return window.selRange=null,a("#lasso-toolbar--html").removeClass("html--drop-up"),!1},a(document).keyup(function(a){27==a.keyCode&&e()}),a("#lasso--exit").live("click",function(a){a.preventDefault(),e()}),a(document).keydown(function(b){return"115"!=b.which&&"83"!=b.which||!b.ctrlKey&&!b.metaKey?!0:(b.preventDefault(),a(".lasso-editing #lasso--save").trigger("click"),!1)});var u=function(){!a(".aesop-timeline").length>0&&a("body").append('<div class="aesop-timeline"></div>').addClass("has-timeline"),!a(".aesop-timeline .scroll-nav").length>0&&(a(".aesop-entry-content").scrollNav({sections:".aesop-timeline-stop",arrowKeys:!0,insertTarget:".aesop-timeline",insertLocation:"appendTo",showTopLink:!1,showHeadline:!1,scrollOffset:0}),a(".aesop-timeline-stop").each(function(){var b=a(this).attr("data-title");a(this).text(b).append(o)}))},v=function(){a(".aesop-video-component").fitVids()},w=r?r:[29.76,-95.38],x=q?q:12,y=lasso_editor.mapTileProvider,z=function(){function a(a,b){var c=m(a,b);jQuery('input[name="ase-map-component-start-point"]').remove(),jQuery(".lasso--map-form__footer").append('<input type="hidden" name="ase-map-component-start-point" data-ase="map" value="'+c+'">'),jQuery("#lasso-map-address").val(a+", "+b)}function b(a){jQuery('input[name="ase-map-component-zoom"]').remove(),jQuery(".lasso--map-form__footer").append('<input type="hidden" name="ase-map-component-zoom" data-ase="map" value="'+a+'">')}function c(a){k(a.target)}function d(b){var c=b.target.getCenter();a(f(c.lat),f(c.lng))}function e(a){b(a.target.getZoom())}function f(a){return Math.round(100*a)/100}function g(a){var b,d={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[a.latlng.lat,a.latlng.lng]}};L.geoJson(d,{pointToLayer:function(){return b=L.marker(a.latlng,{title:"Resource Location",alt:"Resource Location",riseOnHover:!0,draggable:!0}).bindPopup("			            	<input type='text' name='ase_marker_text[]' value='Location Title'>			            	<a class='marker-update-button dashicons dashicons-yes'/></a>			            	<a class='marker-delete-button dashicons dashicons-trash'/></a>			            	"),b.on("popupopen",h),b.on("dragend",c),b}}).addTo(q),j(b._leaflet_id,l(a.latlng.lat,a.latlng.lng,"Location Title"))}function h(){var a=this;jQuery(".marker-delete-button:visible").click(function(){jQuery('input[data-marker="'+a._leaflet_id+'"]').remove(),q.removeLayer(a)}),jQuery(".marker-update-button:visible").click(function(b){var c=b.target.previousElementSibling.value,d=l(a._latlng.lat,a._latlng.lng,c);jQuery('input[data-marker="'+a._leaflet_id+'"]').val(d),a.options.title=c,a.closePopup(),a.bindPopup("				            	<input type='text' name='ase_marker_text[]' value='"+c+"'>				            	<a class='marker-update-button dashicons dashicons-yes'/></a>				            	<a class='marker-delete-button dashicons dashicons-trash'/></a>				            	")})}function i(a,b){return marker=L.marker(a,{title:b,alt:b,riseOnHover:!0,draggable:!0}).bindPopup("	            	<input type='text' name='ase_marker_text[]' value='"+b+"'>	            	<a class='marker-update-button dashicons dashicons-yes'/></a>	            	<a class='marker-delete-button dashicons dashicons-trash'/></a>	            	"),marker.on("popupopen",h),marker.on("dragend",c),marker}function j(a,b){jQuery(".lasso--map-form__footer").append('<input type="hidden" name="ase-map-component-locations[]" data-ase="map" data-marker="'+a+'" value="'+b+'">')}function k(a){var b=l(a._latlng.lat,a._latlng.lng,a.options.title);jQuery('input[data-marker="'+a._leaflet_id+'"]').val(b)}function l(a,b,c){return encodeURIComponent(JSON.stringify({lat:a,lng:b,title:c}))}function m(a,b){return encodeURIComponent(JSON.stringify({lat:a,lng:b}))}var n=w.lat?w.lat:29.76,o=w.lng?w.lng:-95.38,q=L.map("aesop-map-component",{scrollWheelZoom:!1,zoom:x,center:[n,o]});a(w[0],w[1]),jQuery("#lasso-map-address").geocomplete().bind("geocode:result",function(b,c){var d=c.geometry.location.k,e=c.geometry.location.B;q.panTo(new L.LatLng(d,e)),a(d,e)}),L.tileLayer(y,{maxZoom:x}).addTo(q),p.forEach(function(a){i([a.lat,a.lng],a.title).addTo(q),j(marker._leaflet_id,l(a.lat,a.lng,a.title))}),q.on("click",g),q.on("dragend",d),q.on("zoomend",e)};a("#"+c).sortable({opacity:.65,placeholder:"lasso-drop-zone",handle:".lasso-drag",cursor:"move",tolerance:"pointer",refreshPositions:!0,helper:function(b,c){var d=c.context,e=a(d).attr("data-component-type");return a('<div class="lasso-drag-holder lasso-toolbar--component__'+e+'"></div>')},beforeStop:function(a,b){draggedItem=b.item},receive:function(){a("#lasso-toolbar--components").removeClass("toolbar--drop-up");var b=draggedItem.context,c=a(b).attr("data-type");"draggable"==origin&&(a(b).replaceWith("wpimg"==c?a(j[c].content).prepend(n):a(j[c].content).prepend(o).attr({"data-component-type":c})),"map"==c&&z(),"timeline_stop"==c&&u(),"video"==c&&v())}}),a("#lasso-toolbar--components__list li").draggable({axis:"y",helper:"clone",cursor:"move",connectToSortable:"#"+c,start:function(b){origin="draggable";var c=b.currentTarget,d=a(c).attr("data-type");a(this).addClass(d)}})})}),function(a){a(document).ready(function(){var b=function(){a("body").removeClass("lasso-modal-open"),a("#lasso--post-settings__modal, #lasso--modal__overlay").remove()};a("#lasso--post-settings").live("click",function(b){b.preventDefault(),a("body").toggleClass("lasso-modal-open"),a("body").append(lasso_editor.component_modal);var c=function(a){var b;return 100==a?b="draft":200==a?b="publish":"draft"==a?b=100:"publish"==a&&(b=200),b};a("#lasso--slider").slider({value:c(lasso_editor.post_status),min:100,max:200,step:100,animate:"fast",slide:function(b,d){a('input[name="status"]').val(c(d.value)),a(".lasso--postsettings__footer").slideDown(),100==d.value?a(".story-status").removeClass("story-status-publish").addClass("story-status-draft"):200==d.value&&a(".story-status").removeClass("story-status-draft").addClass("story-status-publish")}}),a('input[name="status"]').val(c(a("#lasso--slider").slider("value"))),a(".lasso--modal__trigger-footer").on("keyup",function(){a(".lasso--postsettings__footer").slideDown()}),modalResizer()}),a("#lasso--modal__close, #lasso--modal__overlay, .lasso--postsettings-cancel").live("click",function(a){a.preventDefault(),b()}),a(document).keyup(function(a){27==a.keyCode&&b()});a("#lasso--postsettings__form").live("submit",function(b){b.preventDefault();var c=a(this);a(this).find('input[type="submit"]').val(lasso_editor.strings.saving);var d=c.serialize();a.post(lasso_editor.ajaxurl,d,function(b){1==b.success?(a('input[type="submit"]').addClass("saved"),a('input[type="submit"]').val(lasso_editor.strings.saved),location.reload(),window.location.replace(lasso_editor.permalink)):alert("error")})})})}(jQuery),function(a){a(document).ready(function(){var b=function(){a("body").removeClass("lasso-sidebar-open")};a("body").on("click","#"+lasso_editor.editor,function(){b()});var c,d=function(){var b=a("#lasso--component__settings");b.height(a(window).height()),a(window).resize(function(){b.height(a(window).height())})};a("#lasso-component--settings__trigger").live("click",function(){{var b=a("#lasso--component__settings");a(this)}if(c=a(this).parent().parent().hasClass("aesop-map-component")?a(this).parent().parent().find(".aesop-component"):a(this).closest(".aesop-component"),window.component=c,h=c.data(),a("body").toggleClass("lasso-sidebar-open"),b.find('input[name="unique"]').val(h.unique),d(),b.html(lasso_editor.component_options[h.componentType]),b.find(".component_type").val(h.componentType),a(".lasso-buttoninsert-wrap").fadeIn(600),b.perfectScrollbar("destroy"),b.perfectScrollbar(),b.find(".lasso-option").each(function(){var b=a(this).data("option"),c=a(this).find(".lasso-generator-attr");if("gallery-type"==b){var d=function(b){"grid"==b?(a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--grid").fadeIn()):a(".ase-gallery-opts--grid").fadeOut(),"thumbnail"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--thumb").fadeIn()):a(".ase-gallery-opts--thumb").fadeOut(),"photoset"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--photoset").fadeIn()):a(".ase-gallery-opts--photoset").fadeOut()};a(c).each(function(){a(this).val()==h.galleryType&&(a(this).parent().addClass("selected"),a(this).prop("checked",!0),d(a(this).val()),a("#ase_gallery_type").val(a(this).val()))})}else a(c[0]).val(h[b])}),a(document).on("click","#lasso-upload-img",function(b){b.preventDefault(),className=b.currentTarget.parentElement.className;var d=a('input[name="component_type"]').val();"undefined"!=typeof lasso_file_frame&&lasso_file_frame.close(),lasso_file_frame=wp.media.frames.file_frame=wp.media({title:"Select Image",button:{text:"Insert Image"},multiple:!1}),lasso_file_frame.on("select",function(){var b=lasso_file_frame.state().get("selection").first().toJSON();a(".lasso-generator-attr-media_upload").attr("value",b.url),"parallax"==d?c.find(".aesop-parallax-sc-img").attr("src",b.url):"quote"==d?c.css({"background-image":"url("+b.url+")"}):"image"==d?c.find(".aesop-image-component-image > img").attr("src",b.url):"character"==d?c.find(".aesop-character-avatar").attr("src",b.url):"chapter"==d&&c.find(".aesop-article-chapter").css({"background-image":"url("+b.url+")"})}),lasso_file_frame.open()}),a(this).parent().parent().hasClass("empty-gallery")&&b.addClass("gallery-no-images"),a(this).parent().parent().hasClass("aesop-gallery-component")){var e=(a(this),lasso_editor.ajaxurl),f=(a("#lasso--component-settings-form.gallery"),lasso_editor.getGallImgNonce),g=h.id,h={action:"process_gallery_get-images",post_id:g,nonce:f};a.post(e,h,function(b){a("#lasso--gallery__images").html(b.data.html);var c=a("#ase-gallery-images");c.ready(function(){c.sortable({containment:"parent",cursor:"move",opacity:.8,placeholder:"ase-gallery-drop-zone",forcePlaceholderSize:!0,update:function(){var b=a(this).sortable("toArray");a("#ase_gallery_ids").val(b)},create:function(){var b=a(this).sortable("toArray");a("#ase_gallery_ids").val(b)}})})})}}),a("#lasso--sidebar__close").live("click",function(c){c.preventDefault(),b(),a("#lasso--component__settings").perfectScrollbar("destroy")})})}(jQuery),function(a){a(document).ready(function(){a("#lasso-component--settings__trigger").live("click",function(){var b=a("#lasso--component__settings");b.find("#lasso-generator-attr-background").live("change",function(){component.css({"background-color":a(this).val()})}),b.find("#lasso-generator-attr-text").live("change",function(){component.css({color:a(this).val()})}),b.find("#lasso-generator-attr-quote").on("keyup",function(){component.find("blockquote span").text(a(this).val())}),b.find("#lasso-generator-attr-cite").on("keyup",function(){var b=component.find("blockquote cite");0==b.length?component.find("blockquote").append('<cite class="aesop-quote-component-cite">'+a(this).val()+"</cite>"):component.find("blockquote cite").text(a(this).val())}),b.find(".lasso-quote-width > #lasso-generator-attr-width").on("keyup",function(){component.css("width",a(this).val())}),b.find(".lasso-quote-type #lasso-generator-attr-type").on("change",function(){var b=a(this).val();"pull"==b&&component.css("background-color","transparent"),component.removeClass("aesop-quote-type-block aesop-quote-type-pull"),component.addClass("aesop-quote-type-"+a(this).val()+" ")}),b.find(".lasso-quote-align #lasso-generator-attr-align").on("change",function(){var b=a(this).val();"left"==b?(component.removeClass("aesop-component-align-right aesop-component-align-center"),component.find("blockquote").removeClass("aesop-component-align-right aesop-component-align-center")):"right"==b?(component.removeClass("aesop-component-align-left aesop-component-align-center"),component.find("blockquote").removeClass("aesop-component-align-left aesop-component-align-center")):"center"==b&&(component.removeClass("aesop-component-align-left aesop-component-align-right"),component.find("blockquote").removeClass("aesop-component-align-left aesop-component-align-right")),component.addClass("aesop-component-align-"+a(this).val()+" "),component.find("blockquote").addClass("aesop-component-align-"+a(this).val()+" ")}),b.find(".lasso-parallax-caption > #lasso-generator-attr-caption").on("keyup",function(){var b=component.find(".aesop-parallax-sc-caption-wrap");0==b.length?component.find("img").after('<figcaption class="aesop-parallax-sc-caption-wrap bottom-left">'+a(this).val()+"</figcaption>"):component.find(".aesop-parallax-sc-caption-wrap").text(a(this).val())}),b.find(".lasso-parallax-captionposition > #lasso-generator-attr-captionposition").on("change",function(){var b=a(this).val();"bottom-left"==b?component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-right top-left top-right"):"bottom-right"==b?component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-left top-left top-right"):"top-left"==b?component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-right top-right bottom-left"):"top-right"==b&&component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-right bottom-left top-left"),component.find(".aesop-parallax-sc-caption-wrap").addClass(b)
}),b.find(".lasso-image-caption > #lasso-generator-attr-caption").on("keyup",function(){var b=component.find(".aesop-image-component-caption");0==b.length?component.find("img").after('<p class="aesop-image-component-caption">'+a(this).val()+"</p>"):component.find(".aesop-image-component-caption").text(a(this).val())}),b.find(".lasso-image-imgwidth > #lasso-generator-attr-imgwidth").on("keyup",function(){component.find(".aesop-image-component-image").css("max-width",a(this).val())}),b.find(".lasso-image-align > #lasso-generator-attr-align").on("change",function(){var b=a(this).val();"left"==b?component.find(".aesop-image-component-image").removeClass("aesop-component-align-right aesop-component-align-center"):"right"==b?component.find(".aesop-image-component-image").removeClass("aesop-component-align-left aesop-component-align-center"):"center"==b&&component.find(".aesop-image-component-image").removeClass("aesop-component-align-left aesop-component-align-right"),component.find(".aesop-image-component-image").addClass("aesop-component-align-"+a(this).val()+" ")}),b.find(".lasso-image-captionposition > #lasso-generator-attr-captionposition").on("change",function(){var b=a(this).val();"left"==b?component.find(".aesop-image-component-image").removeClass("aesop-image-component-caption-right aesop-image-component-caption-center"):"right"==b?component.find(".aesop-image-component-image").removeClass("aesop-image-component-caption-left aesop-image-component-caption-center"):"center"==b&&component.find(".aesop-image-component-image").removeClass("aesop-image-component-caption-left aesop-image-component-caption-right"),component.find(".lasso-image-component-image").addClass("lasso-image-component-caption-"+b+" ")}),b.find(".lasso-image-offset > #lasso-generator-attr-offset").on("keyup",function(){a(this).val();component.find(".aesop-image-component-image").hasClass("aesop-component-align-left")?component.find(".aesop-image-component-image").css("margin-left",a(this).val()):component.find(".aesop-image-component-image").css("margin-right",a(this).val())}),b.find(".lasso-character-name > #lasso-generator-attr-name").on("keyup",function(){component.find(".aesop-character-title").text(a(this).val())}),b.find(".lasso-character-caption > #lasso-generator-attr-caption").on("keyup",function(){component.find(".aesop-character-cap").text(a(this).val())}),b.find(".lasso-character-align > #lasso-generator-attr-align").on("change",function(){var b=a(this).val();"left"==b?component.removeClass("aesop-component-align-right aesop-component-align-center"):"center"==b&&component.removeClass("aesop-component-align-left aesop-component-align-right"),component.addClass("aesop-component-align-"+a(this).val()+" ")}),b.find(".lasso-chapter-title > #lasso-generator-attr-title").on("keyup",function(){component.find(".aesop-cover-title span").text(a(this).val())}),b.find(".lasso-chapter-subtitle > #lasso-generator-attr-subtitle").on("keyup",function(){component.find(".aesop-cover-title small").text(a(this).val())}),b.find(".lasso-video-id > #lasso-generator-attr-id").on("change blur",function(){src=a(this).val(),iSrc=component.find(".aesop-video-container"),iSrc.hasClass("vimeo")?component.find("iframe").attr("src","//player.vimeo.com/video/"+src+" "):iSrc.hasClass("youtube")&&component.find("iframe").attr("src","//www.youtube.com/embed/"+src+"?rel=0&wmode=transparent")}),b.find(".lasso-video-width > #lasso-generator-attr-width").on("keyup",function(){component.find(".aesop-video-container").css("max-width",a(this).val())}),b.find(".lasso-content-background > #lasso-generator-attr-background").live("change",function(){component.find(".aesop-content-comp-wrap").css({"background-color":a(this).val()})}),b.find(".lasso-content-color > #lasso-generator-attr-color").live("change",function(){component.find(".aesop-content-comp-wrap").css({color:a(this).val()})}),b.find(".lasso-content-height > #lasso-generator-attr-height").live("keyup",function(){val=a(this).val(),component.find(".aesop-content-comp-wrap").css({"min-height":a(this).val()})}),b.find(".lasso-content-columns > #lasso-generator-attr-columns").live("change",function(){val=a(this).val(),"1"==val?component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-2 aesop-content-comp-columns-3 aesop-content-comp-columns-4").addClass("aesop-content-comp-columns-1"):"2"==val?component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-1 aesop-content-comp-columns-3 aesop-content-comp-columns-4").addClass("aesop-content-comp-columns-2"):"3"==val?component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-1 aesop-content-comp-columns-2 aesop-content-comp-columns-4").addClass("aesop-content-comp-columns-3"):"4"==val&&component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-1 aesop-content-comp-columns-2 aesop-content-comp-columns-3").addClass("aesop-content-comp-columns-4")})})})}(jQuery),jQuery(function(a){function b(){if(window.getSelection){if(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount)return sel.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null}function c(a){a&&(window.getSelection?(sel=window.getSelection(),sel.removeAllRanges(),sel.addRange(a)):document.selection&&a.select&&a.select())}var d=function(){return 600<=a(window).width()?!0:!1},e=function(){return d()?"up":"down"};a(document).on("click","#lasso-toolbar--components",function(){a(this).toggleClass("toolbar--drop-"+e()),a("#lasso-toolbar--html").removeClass("html--drop-"+e()),a("#lasso-toolbar--link").removeClass("link--drop-"+e());var b=a(this).find("ul"),c=a(b).height(),f=15;1==d()&&a(b).css({dropUp:c,top:-(c+f)})}),a("#lasso-toolbar--html").live("mousedown",function(){if(!a(this).hasClass("html--drop-"+e())){var c=document.getElementById(lasso_editor.editor);window.selRange=b(),("undefined"==typeof window.selRange||null==window.selRange)&&(c.highlight(),window.selRange=b())}}),a("#lasso-toolbar--html__inner").live("focusout",function(){c(window.selRange)}),a("#lasso-toolbar--html__inner").live("focus",function(){0!=a(b().commonAncestorContainer).parents("#lasso--content").length&&(window.selRange=b())}),a(document).on("click","#lasso-toolbar--html",function(){a(this).toggleClass("html--drop-"+e()),a("#lasso-toolbar--components").removeClass("toolbar--drop-"+e()),a("#lasso-toolbar--link").removeClass("link--drop-"+e()),a("#lasso-toolbar--html__wrap").live("click",function(){return!1}),a(this).find("#lasso-toolbar--html__inner").focus()}),a(".lasso-toolbar--html__cancel").live("click",function(){a(this).closest("li").removeClass("html--drop-"+e())});var f=function(b){return a("#lasso-toolbar--html__inner").text(b)};a("#lasso-html--h2").live("click",function(a){a.preventDefault(),f("<h2>H2 Heading</h2>")}),a("#lasso-html--h3").live("click",function(a){a.preventDefault(),f("<h3>H3 Heading</h3>")}),a("#lasso-html--ul").live("click",function(a){a.preventDefault(),f("<ul><li>Item</li></ul>")}),a("#lasso-html--ol").live("click",function(a){a.preventDefault(),f("<ol><li>Item</li></ol>")}),a("#lasso-toolbar--link").live("mousedown",function(){if(!a(this).hasClass("link--drop-up")){var c=document.getElementById(lasso_editor.editor);window.selRange=b(),("undefined"==typeof window.selRange||null==window.selRange)&&(c.highlight(),window.selRange=b())}}),a("#lasso-toolbar--link__inner").live("focusout",function(){c(window.selRange)}),a("#lasso-toolbar--link__inner").live("focus",function(){0!=a(b().commonAncestorContainer).parents("#lasso--content").length&&(window.selRange=b())}),a(document).on("click","#lasso-toolbar--link",function(){a(this).toggleClass("link--drop-"+e()),a("#lasso-toolbar--components").removeClass("toolbar--drop-"+e()),a("#lasso-toolbar--html").removeClass("html--drop-"+e()),a("#lasso-toolbar--link__wrap").live("click",function(){return!1}),a(this).find("#lasso-toolbar--link__inner").focus()}),a(".lasso-editing .lasso-link").live("click",function(b){b.preventDefault(),a("#lasso-toolbar--link__wrap").live("click",function(){return!1});var c=a(this).attr("href");a("#lasso-toolbar--link").addClass("link--drop-"+e()),a("#lasso-toolbar--link__inner").text(c)}),a(".lasso-delete").live("click",function(b){b.preventDefault();var c=a(this);swal({title:"Delete this component?",type:"warning",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){c.closest(".aesop-component").remove(),c.closest(".lasso-component").remove()})}),a(".lasso-clone").live("click",function(b){var c=a(this);b.preventDefault(),c.closest(".aesop-component").clone().insertAfter(a(this).parent().parent()).hide().fadeIn(),c.closest(".lasso-component").clone().insertAfter(a(this).parent().parent()).hide().fadeIn()})}),jQuery(document).ready(function(a){var b=lasso_editor.ajaxurl,c=a(".lasso--controls__right a"),d=lasso_editor.editor,e=lasso_editor.postid,f=a("#"+d).html(),g="You have unsaved changes!";a("#"+d).live("change",function(){var b=a(this),c=b.html();f!==c&&localStorage.setItem("lasso_backup_"+e,c)}),window.onbeforeunload=function(){return localStorage.getItem("lasso_backup_"+e)&&lasso_editor.userCanEdit?g:void 0},a(".lasso--controls__right a:not(#lasso--exit)").live("click",function(e){function f(b){for(var c=a(b),d="",e=0;e<c.length;e++){var f=a(c[e]);if(f.hasClass("aesop-component")){var g=f.data(),h="";if(g.hasOwnProperty("componentType")){for(var i in g)g.hasOwnProperty(i)&&"componentType"!=i&&(h+=" "+i+'="'+g[i]+'"');var j="[aesop_"+g.componentType+h+"]",k=f.find(".aesop-component-content-data");0!=k.length&&(j+=k[0].innerHTML+"[/aesop_"+g.componentType+"]"),d+=j}}else d+=3==f.context.nodeType?c[e].data:c[e].outerHTML}return d}function g(){a.post(b,k,function(b){1==b.success?(a(c).removeClass("being-saved").addClass("lasso--saved"),h.hasClass("lasso-publish-post")&&h.remove(),setTimeout(function(){a(c).removeClass("lasso--saved"),h.hasClass("lasso-publish-post")&&location.reload()},1200),localStorage.removeItem("lasso_backup_"+j)):a(c).removeClass("being-saved").addClass("lasso--error")})}e.preventDefault();var h=a(this);a(".lasso--wpimg__wrap").each(function(){a(this).hasClass("wp-caption")||a(this).children().unwrap(),a(".lasso-component--controls").remove()}),a(".lasso-component").each(function(){a(".lasso-component--controls").remove()}),a("#lasso--map-form").each(function(){var b=a(this);b.find(".lasso-component--controls, .lasso--map-form__footer ").remove(),b.children().unwrap()}),a(".scroll-nav__section").each(function(){a(this).children().unwrap()});var i=a("#"+d).html(),j=h.closest("#lasso--controls").data("post-id");a(this).addClass("being-saved");var k={action:h.hasClass("lasso-publish-post")?"process_save_publish-content":"process_save_content",author:lasso_editor.author,content:h.hasClass("shortcodify-enabled")?f(i):i,post_id:j,nonce:lasso_editor.nonce};h.hasClass("lasso-publish-post")?swal({title:lasso_editor.strings.publishPost,type:"info",text:!1,showCancelButton:!0,confirmButtonColor:"#5bc0de",confirmButtonText:lasso_editor.strings.publishYes,closeOnConfirm:!0},function(){lasso_editor.can_publish_posts&&g()}):lasso_editor.can_publish_posts&&g()})}),function(a){"use strict";function b(){var b=f.sortable("toArray");a("#ase_gallery_ids").val(b)}function c(c,d){var e="<li id='"+c+"' class='ase-gallery-image'><i class='dashicons dashicons-no-alt'></i><i title='Edit Image Caption' class='dashicons dashicons-edit'></i><img src='"+d+"'></li>";a("#ase-gallery-images").append(e),f.sortable("refresh"),b()}function d(c,d,e){var g="<li id='"+c+"' class='ase-gallery-image'><i class='dashicons dashicons-no-alt'></i><i title='Edit Image Caption' class='dashicons dashicons-edit'></i><img src='"+d+"'></li>";a(e).replaceWith(g),f.sortable("refresh"),b()}a("#lasso--gallery__create").live("click",function(b){b.preventDefault(),a(this).closest("form").addClass("creating-gallery"),a(".ase-gallery-opts--create-gallery").fadeIn(),a(".ase-gallery-opts--edit-gallery").fadeOut(1),a("#ase-gallery-images li").remove(),a(".ase-gallery-opts--edit-gallery").text(lasso_editor.strings.addNewGallery),a(".ase-gallery-opts--edit-gallery .lasso-option-desc").text("Select new images to create a gallery with.")});var e,f=a("#ase-gallery-images");a(document).on("click","#lasso--gallery__selectImages",function(b){return b.preventDefault(),e?void e.open():(e=wp.media.frames.file_frame=wp.media({title:lasso_editor.strings.chooseImages,button:{text:lasso_editor.strings.addImages},multiple:!0}),e.on("select",function(){var b=e.state().get("selection");if(b){b.each(function(a){var b=a.id,d=a.attributes.sizes.thumbnail.url;c(b,d)});var d=b.map(function(a){var a=a.toJSON();return a.id}).join(",");a("#ase_gallery_ids").val(d),a(".has-galleries > #lasso--gallery__save").fadeIn(),a("#lasso--gallery__selectImages").remove()}}),void e.open())}),a(".lasso-gallery-id #lasso-generator-attr-id").live("change",function(){var b={action:"process_gallery_swap",gallery_id:a(this).val(),nonce:lasso_editor.swapGallNonce};a.post(lasso_editor.ajaxurl,b,function(b){1==b.success&&a(".aesop-gallery-component").replaceWith(b.data.gallery)})}),a(document).on("click",".ase-gallery-image > i.dashicons-no-alt",function(){a(this).parent().remove(),f.sortable("refresh"),b()});var g=!1;a(document).on("click","#ase-gallery-add-image",function(b){b.preventDefault();if(g=a(this),wp.media.frames.ase_frame)return void wp.media.frames.ase_frame.open();wp.media.frames.ase_frame=wp.media({title:lasso_editor.strings.selectGallery,multiple:!0,library:{type:"image"},button:{text:lasso_editor.strings.useSelectedImages}});var d=function(){var a=wp.media.frames.ase_frame.state().get("selection");a&&a.each(function(a){var b=a.id,d=a.attributes.sizes.thumbnail.url;c(b,d)})};wp.media.frames.ase_frame.on("select",d),wp.media.frames.ase_frame.open()});var h=function(){var b;a(document).on("click",".ase-gallery-image > i.dashicons-edit",function(c){c.preventDefault();if(b=a(this),wp.media.frames.ase_edit_frame)return void wp.media.frames.ase_edit_frame.open();wp.media.frames.ase_edit_frame=wp.media({title:lasso_editor.strings.editImage,multiple:!1,library:{type:"image"},button:{text:lasso_editor.strings.updateSelectedImg}});var e=function(){var a=wp.media.frames.ase_edit_frame.state().get("selection");a&&a.each(function(a){var c=a.id,e=a.attributes.sizes.thumbnail.url;d(c,e,b.parent())})};wp.media.frames.ase_edit_frame.on("select",e),wp.media.frames.ase_edit_frame.on("open",function(){var a=wp.media.frames.ase_edit_frame.state().get("selection"),c=wp.media.attachment(b.parent().attr("id"));c.fetch(),a.add(c?[c]:[])}),wp.media.frames.ase_edit_frame.open()})};h(),b()}(jQuery),function(a){a(document).ready(function(a){var b=function(b){"grid"==b?(a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--grid").fadeIn()):a(".ase-gallery-opts--grid").fadeOut(),"thumbnail"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--photoset").fadeOut(),a(".ase-gallery-opts--thumb").fadeIn()):a(".ase-gallery-opts--thumb").fadeOut(),"photoset"==b?(a(".ase-gallery-opts--grid").fadeOut(),a(".ase-gallery-opts--thumb").fadeOut(),a(".ase-gallery-opts--photoset").fadeIn()):a(".ase-gallery-opts--photoset").fadeOut()};a(".ase-gallery-type-radio").each(function(){if(a(this).is(":checked")){a(this).parent().addClass("selected");var c=a(this).val();b(c)}}),a(".ase-gallery-layout-label").live("click",function(){a(".ase-gallery-layout-label").removeClass("selected"),a(this).addClass("selected");var c=a(this).find("input").val();b(c),a("#ase_gallery_type").val(c)})})}(jQuery),function(a){a("#lasso--map-form").live("submit",function(b){b.preventDefault();var c=a(this);a(this).find('input[type="submit"]').val("Saving...").addClass("being-saved");var d=c.serialize();a.post(lasso_editor.ajaxurl,d,function(a){1==a.success?(c.find('input[type="submit"]').val("Saved"),c.removeClass("being-saved").addClass("lasso--saved"),setTimeout(function(){c.find('input[type="submit"]').val("Save Locations").removeClass("lasso-saved")},1200)):c.removeClass("being-saved").addClass("lasso--error")})})}(jQuery),function(a){"use strict";a("#lasso--featImgSave a").live("click",function(b){b.preventDefault();var c=a(this),d={action:"process_upload-image_upload",postid:lasso_editor.postid,image_id:c.data("featimg-id"),nonce:lasso_editor.featImgNonce};a.post(lasso_editor.ajaxurl,d,function(b){1==b&&a("#lasso--featImgSave").css("opacity",0)})});var b,c;a(document).on("click","#lasso--featImgUpload > a",function(d){return d.preventDefault(),c=d.currentTarget.parentElement.className,b?void b.open():(b=wp.media.frames.file_frame=wp.media({title:lasso_editor.strings.chooseImage,button:{text:lasso_editor.strings.updateImage},multiple:!1}),b.on("select",function(){var c=b.state().get("selection").first().toJSON();a("body").addClass("lasso--post-thumb-applied"),a("article").removeClass("no-post-thumbnail").addClass("has-post-thumbnail"),a("#lasso--featImgSave a").attr("data-featimg-id",c.id),a(lasso_editor.featImgClass).css({"background-image":"url("+c.url+")"}),a("#lasso--featImgSave a").trigger("click"),a(".no-post-cover-note").remove()}),void b.open())}),a(document).on("click","#lasso--featImgDelete > a",function(b){b.preventDefault();var c=a(this),d={action:"process_upload-image_delete",postid:lasso_editor.postid,nonce:lasso_editor.featImgNonce};swal({title:"Delete image?",type:"warning",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){a.post(lasso_editor.ajaxurl,d,function(b){1==b.success&&(a("body").addClass("lasso--post-thumb-removed"),a("article").removeClass("has-post-thumbnail").addClass("no-post-thumbnail"),a("#lasso--featImgDelete").addClass("lasso--featImg--controlHidden"),c.closest("ul").removeClass("lasso--featImg--has-thumb"),a(lasso_editor.featImgClass).css({"background-image":"url()"}))})})})}(jQuery),function(a){a("#lasso--component-settings-form").live("submit",function(b){b.preventDefault();var c=window.component,d=c.data(),e=a("#lasso-generator-insert"),f=a("#lasso--component-settings-form"),g=a(this);e.val(lasso_editor.strings.saving),g.find(".lasso-generator-attr").each(function(){var b=a(this).closest(".lasso-option").data("option");""!==a(this).val()&&(c.attr("data-"+b,a(this).val()),c.data(b,a(this).val()))});var h=function(a){return delete a.sortableItem,a},i=function(b,c,d){var g=function(a){e.addClass("saved"),e.val(1==a?lasso_editor.strings.galleryCreated:lasso_editor.strings.saved)};1==b?setTimeout(function(){g()},500):1==d?(f.addClass("hide-all-fields").prepend('<div id="lasso--pagerefresh">Gallery Created! Save your post and refresh the page to access this new gallery.</div>'),setTimeout(function(){g(!0)},500)):g(),setTimeout(function(){a("body").removeClass("lasso-sidebar-open")},c)};if("gallery"==d.componentType){var j={action:f.hasClass("creating-gallery")?"process_gallery_create":"process_gallery_update",postid:lasso_editor.postid,unique:d.unique,fields:h(d),gallery_type:a("#ase_gallery_type").val(),gallery_ids:a("#ase_gallery_ids").val(),nonce:a("#lasso-generator-nonce").val()};a.post(lasso_editor.ajaxurl,j,function(a){"gallery-created"==a.data.message?i(!1,4e3,!0):"gallery-updated"==a.data.message?(i(!1,4e3),f.before(lasso_editor.refreshRequired)):alert("error")})}else i(!0,1200)})}(jQuery),function(a){a(document).ready(function(){var b=function(){a("body").removeClass("lasso-modal-open"),a(".lasso--modal, #lasso--modal__overlay").remove()};a("#lasso--post-new").live("click",function(b){b.preventDefault(),a("body").toggleClass("lasso-modal-open"),a("body").append(lasso_editor.newPostModal);var c=a(".url-helper"),d=c.outerWidth(),e=a('input[name="story_title"]'),f=342;e.css({width:f-d}),a(".lasso--modal__trigger-footer").on("keyup",function(){a(".lasso--postsettings__footer").slideDown()}),modalResizer()}),a("#lasso--modal__close, #lasso--modal__overlay, .lasso--postsettings-cancel").live("click",function(a){a.preventDefault(),b()}),a(document).keyup(function(a){27==a.keyCode&&b()});a("#lasso--postnew__form").live("submit",function(b){b.preventDefault();var c=a(this);a(this).find('input[type="submit"]').val(lasso_editor.strings.adding);var d=c.serialize();a.post(lasso_editor.ajaxurl,d,function(b){1==b.success?(a('input[type="submit"]').addClass("saved"),a('input[type="submit"]').val(lasso_editor.strings.added),window.location.replace(b.data.postlink)):alert("error")})})})}(jQuery),function(a){a(document).ready(function(){a(lasso_editor.titleClass).on("blur",function(){var b=a(this),c={action:"process_title-update_post",postid:lasso_editor.postid,title:a.trim(b.text()),nonce:lasso_editor.titleNonce};a.post(lasso_editor.ajaxurl,c,function(a){if(1==a.success){var c="lasso-title-saved";b.addClass(c),setTimeout(function(){b.removeClass(c)},500)}})})})}(jQuery),function(a){a(document).ready(function(){var b,c;a(document).on("click","#lasso--wpimg-edit",function(d){d.preventDefault();var e=a(this),f=a(this).parent().next("img").attr("class").match(/\d+/);c=d.currentTarget.parentElement.className,b=wp.media.frames.ase_edit_frame=wp.media({title:lasso_editor.strings.selectImage,button:{text:lasso_editor.strings.insertImage},multiple:!1}),b.on("open",function(){var a=b.state().get("selection"),c=wp.media.attachment(f);c.fetch(),a.add(c?[c]:[])}),b.on("select",function(){var c=b.state().get("selection").first().toJSON(),d=void 0===c.sizes.large?c.sizes.full.url:c.sizes.large.url;a(e).parent().next("img").attr({src:d,alt:c.alt,"class":"aligncenter size-large wp-image-"+c.id})}),b.open()})})}(jQuery),function(){jQuery(document).ready(function(a){modalResizer=function(){var b=a(".lasso--modal"),c=b.height(),d=a(window).height(),e=a(".lasso--modal").hasClass("lasso--tour__modal")?0:30;b.css({top:(d-c-e)/2})},modalResizer(),jQuery(window).resize(function(){modalResizer()})})}(jQuery),function(a,b,c,d){function e(){a("#lasso--loading").remove()}function f(b){"posts"==b?(b=j,capable=lasso_editor.edit_others_posts):"pages"==b&&(b=k,capable=lasso_editor.edit_others_pages),b.fetch(q).done(function(){b.length>0&&(a(m).append(p),g(b),a("#lasso--load-more").trigger("click")),e()})}function g(b){a(m).on("click","#lasso--load-more",function(c){c.preventDefault(),a("#lasso--load-more").hide();var f=a('<div data-page-num="'+b.state.currentPage+'" class="lasso--object-batch"></div>');b.each(function(a){f.append(i({post:a.attributes,settings:d}))}),a(m).append(f),b.hasMore()&&b.more().done(function(){e(),a(p).appendTo(a(m)).show()})})}var h=a("#lasso-tmpl--post"),i=c.template(h.html()),j=new wp.api.collections.Posts,k=new wp.api.collections.Pages,l=a("#lasso--post-all"),m="#lasso--post-list",n=a("body"),o='<div id="lasso--loading" class="lasso--loading"><div class="lasso--loader"></div></div>',p='<a href="#" id="lasso--load-more">Load More</a>',q={data:{page:d.page||2,filter:{post_status:["publish","draft","pending"]}}};l.live("click",function(b){b.preventDefault(),n.toggleClass("lasso-modal-open"),n.append(lasso_editor.allPostModal),f("posts"),a(m).perfectScrollbar({suppressScrollX:!0})}),a(".lasso--show-objects").live("click",function(b){b.preventDefault(),a(".lasso--show-objects").removeClass("active"),a(this).addClass("active"),a("#lasso--post-list > li").remove(),a(m).prepend(o),f(a(this).data("post-type"))}),a("#lasso--post__delete").live("click",function(b){b.preventDefault();var c=a(this);swal({title:lasso_editor.strings.deletePost,type:"error",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:lasso_editor.strings.deleteYes,closeOnConfirm:!0},function(){var b={action:"process_delete_post",postid:c.closest("a").data("postid"),nonce:lasso_editor.deletePost};a.post(lasso_editor.ajaxurl,b,function(a){1==a.success&&c.closest("li").fadeOut().remove()})})})}(jQuery,Backbone,_,WP_API_Settings),function(a){a(document).ready(function(){destroyModal=function(){a("body").removeClass("lasso-modal-open"),a("#lasso--tour__modal,#lasso--tour__modal ~ #lasso--modal__overlay").remove()},a('#lasso--tour__modal input[type="submit"]').live("click",function(b){b.preventDefault();a(this);if(a("#hide_tour").is(":checked")){var c={action:"process_tour_hide",nonce:a(this).data("nonce")};a.post(lasso_editor.ajaxurl,c,function(a){1==a.success&&destroyModal()})}else destroyModal()})})}(jQuery);