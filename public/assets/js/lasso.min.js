(function(){function e(e,t){var n,o;for(n in t)o=t[n],void 0!==o&&(e[n]=o);return e}var t,n=function(){},o=function(t,o){var i;return i=o&&o.hasOwnProperty("constructor")?o.constructor:function(){return t.apply(this,arguments)},n.prototype=t.prototype,i.prototype=new n,o&&e(i.prototype,o),i.prototype.constructor=i,i.__super__=t.prototype,i};t="undefined"!=typeof exports?exports:this.Undo={},t.Stack=function(){this.commands=[],this.stackPosition=-1,this.savePosition=-1},e(t.Stack.prototype,{execute:function(e){this._clearRedo(),e.execute(),this.commands.push(e),this.stackPosition++,this.changed()},undo:function(){this.commands[this.stackPosition].undo(),this.stackPosition--,this.changed()},canUndo:function(){return this.stackPosition>=0},redo:function(){this.stackPosition++,this.commands[this.stackPosition].redo(),this.changed()},canRedo:function(){return this.stackPosition<this.commands.length-1},save:function(){this.savePosition=this.stackPosition,this.changed()},dirty:function(){return this.stackPosition!=this.savePosition},_clearRedo:function(){this.commands=this.commands.slice(0,this.stackPosition+1)},changed:function(){}}),t.Command=function(e){this.name=e};var i=new Error("override me!");e(t.Command.prototype,{execute:function(){throw i},undo:function(){throw i},redo:function(){this.execute()}}),t.Command.extend=function(e){var n=o(this,e);return n.extend=t.Command.extend,n}}).call(this),function(e,t){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module&&"object"==typeof exports?module.exports=e():t.rangy=e()}(function(){function e(e,t){var n=typeof e[t];return n==y||!(n!=v||!e[t])||"unknown"==n}function t(e,t){return!(typeof e[t]!=v||!e[t])}function n(e,t){return typeof e[t]!=b}function o(e){return function(t,n){for(var o=n.length;o--;)if(!e(t,n[o]))return!1;return!0}}function i(e){return e&&R(e,E)&&N(e,_)}function a(e){return t(e,"body")?e.body:e.getElementsByTagName("body")[0]}function s(t){typeof console!=b&&e(console,"log")&&console.log(t)}function r(e,t){S&&t?alert(e):s(e)}function l(e){O.initialized=!0,O.supported=!1,r("Rangy is not supported in this environment. Reason: "+e,O.config.alertOnFail)}function c(e){r("Rangy warning: "+e,O.config.alertOnWarn)}function d(e){return e.message||e.description||String(e)}function u(){if(S&&!O.initialized){var t,n=!1,o=!1;e(document,"createRange")&&(t=document.createRange(),R(t,w)&&N(t,C)&&(n=!0));var r=a(document);if(!r||"body"!=r.nodeName.toLowerCase())return void l("No body element found");if(r&&e(r,"createTextRange")&&(t=r.createTextRange(),i(t)&&(o=!0)),!n&&!o)return void l("Neither Range nor TextRange are available");O.initialized=!0,O.features={implementsDomRange:n,implementsTextRange:o};var c,u;for(var f in x)(c=x[f])instanceof p&&c.init(c,O);for(var h=0,m=I.length;m>h;++h)try{I[h](O)}catch(g){u="Rangy init listener threw an exception. Continuing. Detail: "+d(g),s(u)}}}function f(e){e=e||window,u();for(var t=0,n=D.length;n>t;++t)D[t](e)}function p(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function h(e,t,n){var o=new p(e,t,function(t){if(!t.initialized){t.initialized=!0;try{n(O,t),t.supported=!0}catch(o){var i="Module '"+e+"' failed to load: "+d(o);s(i)}}});return x[e]=o,o}function m(){}function g(){}var v="object",y="function",b="undefined",C=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],w=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],_=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],E=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],R=o(e),T=o(t),N=o(n),x={},S=typeof window!=b&&typeof document!=b,k={isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:R,areHostObjects:T,areHostProperties:N,isTextRange:i,getBody:a},O={version:"1.3.0-alpha.20140827",initialized:!1,isBrowser:S,supported:!0,util:k,features:{},modules:x,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==b?!0:rangyAutoInitialize}};O.fail=l,O.warn=c;var A;({}).hasOwnProperty?(k.extend=A=function(e,t,n){var o,i;for(var a in t)t.hasOwnProperty(a)&&(o=e[a],i=t[a],n&&null!==o&&"object"==typeof o&&null!==i&&"object"==typeof i&&A(o,i,!0),e[a]=i);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},k.createOptions=function(e,t){var n={};return A(n,t),e&&A(n,e,!0),n}):l("hasOwnProperty not supported"),S||l("Rangy can only run in a browser"),function(){var e;if(S){var t=document.createElement("div");t.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(t.childNodes,0)[0].nodeType&&(e=function(e){return n.call(e,0)})}catch(o){}}e||(e=function(e){for(var t=[],n=0,o=e.length;o>n;++n)t[n]=e[n];return t}),k.toArray=e}();var L;S&&(e(document,"addEventListener")?L=function(e,t,n){e.addEventListener(t,n,!1)}:e(document,"attachEvent")?L=function(e,t,n){e.attachEvent("on"+t,n)}:l("Document does not have required addEventListener or attachEvent method"),k.addListener=L);var I=[];O.init=u,O.addInitListener=function(e){O.initialized?e(O):I.push(e)};var D=[];O.addShimListener=function(e){D.push(e)},S&&(O.shim=O.createMissingNativeApi=f),p.prototype={init:function(){for(var e,t,n=this.dependencies||[],o=0,i=n.length;i>o;++o){if(t=n[o],e=x[t],!(e&&e instanceof p))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},warn:function(e){O.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){O.warn("DEPRECATED: "+e+" in module "+this.name+"is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},O.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var o=h(e,n,t);O.initialized&&O.supported&&o.init()},O.createCoreModule=function(e,t,n){h(e,t,n)},O.RangePrototype=m,O.rangePrototype=new m,O.selectionPrototype=new g,O.createCoreModule("DomUtil",[],function(e,t){function n(e){var t;return typeof e.namespaceURI==k||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function o(e){var t=e.parentNode;return 1==t.nodeType?t:null}function i(e){for(var t=0;e=e.previousSibling;)++t;return t}function a(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function s(e,t){var n,o=[];for(n=e;n;n=n.parentNode)o.push(n);for(n=t;n;n=n.parentNode)if(I(o,n))return n;return null}function r(e,t,n){for(var o=n?t:t.parentNode;o;){if(o===e)return!0;o=o.parentNode}return!1}function l(e,t){return r(e,t,!0)}function c(e,t,n){for(var o,i=n?e:e.parentNode;i;){if(o=i.parentNode,o===t)return i;i=o}return null}function d(e){var t=e.nodeType;return 3==t||4==t||8==t}function u(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function f(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function p(e,t,n){var o=e.cloneNode(!1);if(o.deleteData(0,t),e.deleteData(t,e.length-t),f(o,e),n)for(var a,s=0;a=n[s++];)a.node==e&&a.offset>t?(a.node=o,a.offset-=t):a.node==e.parentNode&&a.offset>i(e)&&++a.offset;return o}function h(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=k)return e.ownerDocument;if(typeof e.document!=k)return e.document;if(e.parentNode)return h(e.parentNode);throw t.createError("getDocument: no document found for node")}function m(e){var n=h(e);if(typeof n.defaultView!=k)return n.defaultView;if(typeof n.parentWindow!=k)return n.parentWindow;throw t.createError("Cannot get a window object for node")}function g(e){if(typeof e.contentDocument!=k)return e.contentDocument;if(typeof e.contentWindow!=k)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function v(e){if(typeof e.contentWindow!=k)return e.contentWindow;if(typeof e.contentDocument!=k)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function y(e){return e&&O.isHostMethod(e,"setTimeout")&&O.isHostObject(e,"document")}function b(e,t,n){var o;if(e?O.isHostProperty(e,"nodeType")?o=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?g(e):h(e):y(e)&&(o=e.document):o=document,!o)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return o}function C(e){for(var t;t=e.parentNode;)e=t;return e}function w(e,n,o,a){var r,l,d,u,f;if(e==o)return n===a?0:a>n?-1:1;if(r=c(o,e,!0))return n<=i(r)?-1:1;if(r=c(e,o,!0))return i(r)<a?-1:1;if(l=s(e,o),!l)throw new Error("comparePoints error: nodes have no common ancestor");if(d=e===l?l:c(e,l,!0),u=o===l?l:c(o,l,!0),d===u)throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(f=l.firstChild;f;){if(f===d)return-1;if(f===u)return 1;f=f.nextSibling}}function _(e){var t;try{return t=e.parentNode,!1}catch(n){return!0}}function E(e){if(!e)return"[No node]";if(D&&_(e))return"[Broken node]";if(d(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+i(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function R(e){for(var t,n=h(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function T(e){this.root=e,this._next=e}function N(e){return new T(e)}function x(e,t){this.node=e,this.offset=t}function S(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var k="undefined",O=e.util;O.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),O.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var A=document.createElement("div");O.areHostMethods(A,["insertBefore","appendChild","cloneNode"]||!O.areHostObjects(A,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),O.isHostProperty(A,"innerHTML")||t.fail("Element is missing innerHTML property");var L=document.createTextNode("test");O.areHostMethods(L,["splitText","deleteData","insertData","appendData","cloneNode"]||!O.areHostObjects(A,["previousSibling","nextSibling","childNodes","parentNode"])||!O.areHostProperties(L,["data"]))||t.fail("Incomplete Text Node implementation");var I=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},D=!1;!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br>",D=_(n),e.features.crashyTextNodes=D}();var P;typeof window.getComputedStyle!=k?P=function(e,t){return m(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=k?P=function(e,t){return e.currentStyle[t]}:t.fail("No means of obtaining computed style properties found"),T.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},x.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+E(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},S.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},S.prototype.toString=function(){return this.message},e.dom={arrayContains:I,isHtmlNamespace:n,parentElement:o,getNodeIndex:i,getNodeLength:a,getCommonAncestor:s,isAncestorOf:r,isOrIsAncestorOf:l,getClosestAncestorIn:c,isCharacterDataNode:d,isTextOrCommentNode:u,insertAfter:f,splitDataNode:p,getDocument:h,getWindow:m,getIframeWindow:v,getIframeDocument:g,getBody:O.getBody,isWindow:y,getContentDocument:b,getRootContainer:C,comparePoints:w,isBrokenNode:_,inspectNode:E,getComputedStyleProperty:P,fragmentFromNodeChildren:R,createIterator:N,DomPosition:x},e.DOMException=S}),O.createCoreModule("DomRange",["DomUtil"],function(e,t){function n(e,t){return 3!=e.nodeType&&(z(e,t.startContainer)||z(e,t.endContainer))}function o(e){return e.document||q(e.startContainer)}function i(e){return new B(e.parentNode,W(e))}function a(e){return new B(e.parentNode,W(e)+1)}function s(e,t,n){var o=11==e.nodeType?e.firstChild:e;return j(t)?n==t.length?P.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:U(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),o}function r(e,t,n){if(T(e),T(t),o(t)!=o(e))throw new H("WRONG_DOCUMENT_ERR");var i=F(e.startContainer,e.startOffset,t.endContainer,t.endOffset),a=F(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?0>=i&&a>=0:0>i&&a>0}function l(e){for(var t,n,i,a=o(e.range).createDocumentFragment();n=e.next();){if(t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(i=e.getSubtreeIterator(),n.appendChild(l(i)),i.detach()),10==n.nodeType)throw new H("HIERARCHY_REQUEST_ERR");a.appendChild(n)}return a}function c(e,t,n){var o,i;n=n||{stop:!1};for(var a,s;a=e.next();)if(e.isPartiallySelectedSubtree()){if(t(a)===!1)return void(n.stop=!0);if(s=e.getSubtreeIterator(),c(s,t,n),s.detach(),n.stop)return}else for(o=P.createIterator(a);i=o.next();)if(t(i)===!1)return void(n.stop=!0)}function d(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),d(t),t.detach()):e.remove()}function u(e){for(var t,n,i=o(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(u(n)),n.detach()):e.remove(),10==t.nodeType)throw new H("HIERARCHY_REQUEST_ERR");i.appendChild(t)}return i}function f(e,t,n){var o,i=!(!t||!t.length),a=!!n;i&&(o=new RegExp("^("+t.join("|")+")$"));var s=[];return c(new h(e,!1),function(t){if((!i||o.test(t.nodeType))&&(!a||n(t))){var r=e.startContainer;if(t!=r||!j(r)||e.startOffset!=r.length){var l=e.endContainer;t==l&&j(l)&&0==e.endOffset||s.push(t)}}}),s}function p(e){var t="undefined"==typeof e.getName?"Range":e.getName();return"["+t+"("+P.inspectNode(e.startContainer)+":"+e.startOffset+", "+P.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function h(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&j(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||j(this.sc)?Q(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||j(this.ec)?Q(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function m(e){return function(t,n){for(var o,i=n?t:t.parentNode;i;){if(o=i.nodeType,Y(e,o))return i;i=i.parentNode}return null}}function g(e,t){if(oe(e,t))throw new H("INVALID_NODE_TYPE_ERR")}function v(e,t){if(!Y(t,e.nodeType))throw new H("INVALID_NODE_TYPE_ERR")}function y(e,t){if(0>t||t>(j(e)?e.length:e.childNodes.length))throw new H("INDEX_SIZE_ERR")}function b(e,t){if(te(e,!0)!==te(t,!0))throw new H("WRONG_DOCUMENT_ERR")}function C(e){if(ne(e,!0))throw new H("NO_MODIFICATION_ALLOWED_ERR")}function w(e,t){if(!e)throw new H(t)}function _(e){return X&&P.isBrokenNode(e)||!Y(G,e.nodeType)&&!te(e,!0)}function E(e,t){return t<=(j(e)?e.length:e.childNodes.length)}function R(e){return!!e.startContainer&&!!e.endContainer&&!_(e.startContainer)&&!_(e.endContainer)&&E(e.startContainer,e.startOffset)&&E(e.endContainer,e.endOffset)}function T(e){if(!R(e))throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function N(e,t){T(e);var n=e.startContainer,o=e.startOffset,i=e.endContainer,a=e.endOffset,s=n===i;j(i)&&a>0&&a<i.length&&U(i,a,t),j(n)&&o>0&&o<n.length&&(n=U(n,o,t),s?(a-=o,i=n):i==n.parentNode&&a>=W(n)&&a++,o=0),e.setStartAndEnd(n,o,i,a)}function x(e){T(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}function S(e){e.START_TO_START=ce,e.START_TO_END=de,e.END_TO_END=ue,e.END_TO_START=fe,e.NODE_BEFORE=pe,e.NODE_AFTER=he,e.NODE_BEFORE_AND_AFTER=me,e.NODE_INSIDE=ge}function k(e){S(e),S(e.prototype)}function O(e,t){return function(){T(this);var n,o,i=this.startContainer,s=this.startOffset,r=this.commonAncestorContainer,l=new h(this,!0);i!==r&&(n=Q(i,r,!0),o=a(n),i=o.node,s=o.offset),c(l,C),l.reset();var d=e(l);return l.detach(),t(this,i,s,i,s),d}}function A(t,o){function s(e,t){return function(n){v(n,$),v(K(n),G);var o=(e?i:a)(n);(t?r:l)(this,o.node,o.offset)}}function r(e,t,n){var i=e.endContainer,a=e.endOffset;(t!==e.startContainer||n!==e.startOffset)&&((K(t)!=K(i)||1==F(t,n,i,a))&&(i=t,a=n),o(e,t,n,i,a))}function l(e,t,n){var i=e.startContainer,a=e.startOffset;(t!==e.endContainer||n!==e.endOffset)&&((K(t)!=K(i)||-1==F(t,n,i,a))&&(i=t,a=n),o(e,i,a,t,n))}var c=function(){};c.prototype=e.rangePrototype,t.prototype=new c,M.extend(t.prototype,{setStart:function(e,t){g(e,!0),y(e,t),r(this,e,t)},setEnd:function(e,t){g(e,!0),y(e,t),l(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],n=e[1],i=t,a=n;switch(e.length){case 3:a=e[2];break;case 4:i=e[2],a=e[3]}o(this,t,n,i,a)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:s(!0,!0),setStartAfter:s(!1,!0),setEndBefore:s(!0,!1),setEndAfter:s(!1,!1),collapse:function(e){T(this),e?o(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):o(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){g(e,!0),o(this,e,0,e,V(e))},selectNode:function(e){g(e,!1),v(e,$);var t=i(e),n=a(e);o(this,t.node,t.offset,n.node,n.offset)},extractContents:O(u,o),deleteContents:O(d,o),canSurroundContents:function(){T(this),C(this.startContainer),C(this.endContainer);var e=new h(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},splitBoundaries:function(){N(this)},splitBoundariesPreservingPositions:function(e){N(this,e)},normalizeBoundaries:function(){T(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,a=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,i=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},s=function(o){var a=o.previousSibling;if(a&&a.nodeType==o.nodeType){e=o;var s=o.length;if(t=a.length,o.insertData(0,a.data),a.parentNode.removeChild(a),e==n)i+=t,n=e;else if(n==o.parentNode){var r=W(o);i==r?(n=o,i=s):i>r&&i--}}},r=!0;if(j(n))n.length==i&&a(n);else{if(i>0){var l=n.childNodes[i-1];l&&j(l)&&a(l)}r=!this.collapsed}if(r){if(j(e))0==t&&s(e);else if(t<e.childNodes.length){var c=e.childNodes[t];c&&j(c)&&s(c)}}else e=n,t=i;o(this,e,t,n,i)},collapseToPoint:function(e,t){g(e,!0),y(e,t),this.setStartAndEnd(e,t)}}),k(t)}function L(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:P.getCommonAncestor(e.startContainer,e.endContainer)}function I(e,t,n,o,i){e.startContainer=t,e.startOffset=n,e.endContainer=o,e.endOffset=i,e.document=P.getDocument(t),L(e)}function D(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,L(this)}var P=e.dom,M=e.util,B=P.DomPosition,H=e.DOMException,j=P.isCharacterDataNode,W=P.getNodeIndex,z=P.isOrIsAncestorOf,q=P.getDocument,F=P.comparePoints,U=P.splitDataNode,Q=P.getClosestAncestorIn,V=P.getNodeLength,Y=P.arrayContains,K=P.getRootContainer,X=e.features.crashyTextNodes;h.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,j(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!j(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(e=n===this.sc?this.so:0,t=n===this.ec?this.eo:n.length,e!=t&&n.deleteData(e,t-e))},isPartiallySelectedSubtree:function(){var e=this._current;return n(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse(!1);else{e=new D(o(this.range));var t=this._current,n=t,i=0,a=t,s=V(t);z(t,this.sc)&&(n=this.sc,i=this.so),z(t,this.ec)&&(a=this.ec,s=this.eo),I(e,n,i,a,s)}return new h(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var $=[1,3,4,5,7,8,10],G=[2,9,11],Z=[5,6,10,12],J=[1,3,4,5,7,8,10,11],ee=[1,3,4,5,7,8],te=m([9,11]),ne=m(Z),oe=m([6,10,12]),ie=document.createElement("style"),ae=!1;try{ie.innerHTML="<b>x</b>",ae=3==ie.firstChild.nodeType}catch(se){}e.features.htmlParsingConforms=ae;var re=ae?function(e){var t=this.startContainer,n=q(t);if(!t)throw new H("INVALID_STATE_ERR");var o=null;return 1==t.nodeType?o=t:j(t)&&(o=P.parentElement(t)),o=null===o||"HTML"==o.nodeName&&P.isHtmlNamespace(q(o).documentElement)&&P.isHtmlNamespace(o)?n.createElement("body"):o.cloneNode(!1),o.innerHTML=e,P.fragmentFromNodeChildren(o)}:function(e){var t=o(this),n=t.createElement("body");return n.innerHTML=e,P.fragmentFromNodeChildren(n)},le=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ce=0,de=1,ue=2,fe=3,pe=0,he=1,me=2,ge=3;M.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){T(this),b(this.startContainer,t.startContainer);var n,o,i,a,s=e==fe||e==ce?"start":"end",r=e==de||e==ce?"start":"end";return n=this[s+"Container"],o=this[s+"Offset"],i=t[r+"Container"],a=t[r+"Offset"],F(n,o,i,a)},insertNode:function(e){if(T(this),v(e,J),C(this.startContainer),z(e,this.startContainer))throw new H("HIERARCHY_REQUEST_ERR");var t=s(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){T(this);var e,t;if(this.collapsed)return o(this).createDocumentFragment();if(this.startContainer===this.endContainer&&j(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=o(this).createDocumentFragment(),t.appendChild(e),t;var n=new h(this,!0);return e=l(n),n.detach(),e},canSurroundContents:function(){T(this),C(this.startContainer),C(this.endContainer);var e=new h(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},surroundContents:function(e){if(v(e,ee),!this.canSurroundContents())throw new H("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);s(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){T(this);for(var e,t=new D(o(this)),n=le.length;n--;)e=le[n],t[e]=this[e];return t},toString:function(){T(this);var e=this.startContainer;if(e===this.endContainer&&j(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new h(this,!0);return c(n,function(e){(3==e.nodeType||4==e.nodeType)&&t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){T(this);var t=e.parentNode,n=W(e);if(!t)throw new H("NOT_FOUND_ERR");var o=this.comparePoint(t,n),i=this.comparePoint(t,n+1);return 0>o?i>0?me:pe:i>0?he:ge},comparePoint:function(e,t){return T(this),w(e,"HIERARCHY_REQUEST_ERR"),b(e,this.startContainer),F(e,t,this.startContainer,this.startOffset)<0?-1:F(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:re,toHtml:function(){return x(this)},intersectsNode:function(e,t){if(T(this),w(e,"NOT_FOUND_ERR"),q(e)!==o(this))return!1;var n=e.parentNode,i=W(e);w(n,"NOT_FOUND_ERR");var a=F(n,i,this.endContainer,this.endOffset),s=F(n,i+1,this.startContainer,this.startOffset);return t?0>=a&&s>=0:0>a&&s>0},isPointInRange:function(e,t){return T(this),w(e,"HIERARCHY_REQUEST_ERR"),b(e,this.startContainer),F(e,t,this.startContainer,this.startOffset)>=0&&F(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return r(this,e,!1)},intersectsOrTouchesRange:function(e){return r(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=F(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=F(this.endContainer,this.endOffset,e.endContainer,e.endOffset),o=this.cloneRange();return-1==t&&o.setStart(e.startContainer,e.startOffset),1==n&&o.setEnd(e.endContainer,e.endOffset),o}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==F(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==F(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new H("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ge},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,V(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var o=n.pop();return t.setEnd(o,o.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return T(this),f(this,e,t)},getDocument:function(){return o(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var n=o(this),i=e.createRange(n);t=t||P.getBody(n),i.selectNodeContents(t);var a=this.intersection(i),s=0,r=0;return a&&(i.setEnd(a.startContainer,a.startOffset),s=i.toString().length,r=s+a.toString().length),{start:s,end:r,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var o,i,a,s,r=[t],l=!1,c=!1;!c&&(o=r.pop());)if(3==o.nodeType)i=n+o.length,!l&&e.start>=n&&e.start<=i&&(this.setStart(o,e.start-n),l=!0),l&&e.end>=n&&e.end<=i&&(this.setEnd(o,e.end-n),c=!0),n=i;else for(s=o.childNodes,a=s.length;a--;)r.push(s[a])},getName:function(){return"DomRange"},equals:function(e){return D.rangesEqual(this,e)},isValid:function(){return R(this)},inspect:function(){return p(this)},detach:function(){}}),A(D,I),M.extend(D,{rangeProperties:le,RangeIterator:h,copyComparisonConstants:k,createPrototypeRange:A,inspect:p,toHtml:x,getRangeDocument:o,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=D}),O.createCoreModule("WrappedRange",["DomRange"],function(e,t){var n,o,i=e.dom,a=e.util,s=i.DomPosition,r=e.DomRange,l=i.getBody,c=i.getContentDocument,d=i.isCharacterDataNode;if(e.features.implementsDomRange&&!function(){function o(e){for(var t,n=f.length;n--;)t=f[n],e[t]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function s(e,t,n,o,i){var a=e.startContainer!==t||e.startOffset!=n,s=e.endContainer!==o||e.endOffset!=i,r=!e.equals(e.nativeRange);(a||s||r)&&(e.setEnd(o,i),e.setStart(t,n))}var d,u,f=r.rangeProperties;n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,o(this)},r.createPrototypeRange(n,s),d=n.prototype,d.selectNode=function(e){this.nativeRange.selectNode(e),o(this)},d.cloneContents=function(){return this.nativeRange.cloneContents()},d.surroundContents=function(e){this.nativeRange.surroundContents(e),o(this)},d.collapse=function(e){this.nativeRange.collapse(e),o(this)},d.cloneRange=function(){return new n(this.nativeRange.cloneRange())},d.refresh=function(){o(this)},d.toString=function(){return this.nativeRange.toString()};var p=document.createTextNode("test");l(document).appendChild(p);var h=document.createRange();h.setStart(p,0),h.setEnd(p,0);try{h.setStart(p,1),d.setStart=function(e,t){this.nativeRange.setStart(e,t),o(this)},d.setEnd=function(e,t){this.nativeRange.setEnd(e,t),o(this)},u=function(e){return function(t){this.nativeRange[e](t),o(this)}}}catch(m){d.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}o(this)},d.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}o(this)},u=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(i){this.nativeRange[t](n),this.nativeRange[e](n)}o(this)}}}d.setStartBefore=u("setStartBefore","setEndBefore"),d.setStartAfter=u("setStartAfter","setEndAfter"),d.setEndBefore=u("setEndBefore","setStartBefore"),d.setEndAfter=u("setEndAfter","setStartAfter"),d.selectNodeContents=function(e){this.setStartAndEnd(e,0,i.getNodeLength(e))},h.selectNodeContents(p),h.setEnd(p,3);var g=document.createRange();g.selectNodeContents(p),g.setEnd(p,4),g.setStart(p,2),-1==h.compareBoundaryPoints(h.START_TO_END,g)&&1==h.compareBoundaryPoints(h.END_TO_START,g)?d.compareBoundaryPoints=function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:d.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var v=document.createElement("div");v.innerHTML="123";var y=v.firstChild,b=l(document);b.appendChild(v),h.setStart(y,1),h.setEnd(y,2),h.deleteContents(),"13"==y.data&&(d.deleteContents=function(){this.nativeRange.deleteContents(),o(this)},d.extractContents=function(){var e=this.nativeRange.extractContents();return o(this),e}),b.removeChild(v),b=null,a.isHostMethod(h,"createContextualFragment")&&(d.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),l(document).removeChild(p),d.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return e=c(e,t,"createNativeRange"),e.createRange()}}(),e.features.implementsTextRange){var u=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var o=n.parentElement();n=e.duplicate(),n.collapse(!1);var a=n.parentElement(),s=o==a?o:i.getCommonAncestor(o,a);return s==t?s:i.getCommonAncestor(t,s)},f=function(e){return 0==e.compareEndPoints("StartToEnd",e)},p=function(e,t,n,o,a){var r=e.duplicate();r.collapse(n);var l=r.parentElement();if(i.isOrIsAncestorOf(t,l)||(l=t),!l.canHaveHTML){var c=new s(l.parentNode,i.getNodeIndex(l));return{boundaryPosition:c,nodeInfo:{nodeIndex:c.offset,containerElement:c.node}}}var u=i.getDocument(l).createElement("span");u.parentNode&&u.parentNode.removeChild(u);for(var f,p,h,m,g,v=n?"StartToStart":"StartToEnd",y=a&&a.containerElement==l?a.nodeIndex:0,b=l.childNodes.length,C=b,w=C;;){if(w==b?l.appendChild(u):l.insertBefore(u,l.childNodes[w]),r.moveToElementText(u),f=r.compareEndPoints(v,e),0==f||y==C)break;if(-1==f){if(C==y+1)break;y=w}else C=C==y+1?y:w;w=Math.floor((y+C)/2),l.removeChild(u)}if(g=u.nextSibling,-1==f&&g&&d(g)){r.setEndPoint(n?"EndToStart":"EndToEnd",e);var _;if(/[\r\n]/.test(g.data)){var E=r.duplicate(),R=E.text.replace(/\r\n/g,"\r").length;for(_=E.moveStart("character",R);-1==(f=E.compareEndPoints("StartToEnd",E));)_++,E.moveStart("character",1)}else _=r.text.length;m=new s(g,_)}else p=(o||!n)&&u.previousSibling,h=(o||n)&&u.nextSibling,m=h&&d(h)?new s(h,0):p&&d(p)?new s(p,p.data.length):new s(l,i.getNodeIndex(u));
return u.parentNode.removeChild(u),{boundaryPosition:m,nodeInfo:{nodeIndex:w,containerElement:l}}},h=function(e,t){var n,o,a,s,r=e.offset,c=i.getDocument(e.node),u=l(c).createTextRange(),f=d(e.node);return f?(n=e.node,o=n.parentNode):(s=e.node.childNodes,n=r<s.length?s[r]:null,o=e.node),a=c.createElement("span"),a.innerHTML="&#feff;",n?o.insertBefore(a,n):o.appendChild(a),u.moveToElementText(a),u.collapse(!t),o.removeChild(a),f&&u[t?"moveStart":"moveEnd"]("character",r),u};o=function(e){this.textRange=e,this.refresh()},o.prototype=new r(document),o.prototype.refresh=function(){var e,t,n,o=u(this.textRange);f(this.textRange)?t=e=p(this.textRange,o,!0,!0).boundaryPosition:(n=p(this.textRange,o,!0,!1),e=n.boundaryPosition,t=p(this.textRange,o,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},o.prototype.getName=function(){return"WrappedTextRange"},r.copyComparisonConstants(o);var m=function(e){if(e.collapsed)return h(new s(e.startContainer,e.startOffset),!0);var t=h(new s(e.startContainer,e.startOffset),!0),n=h(new s(e.endContainer,e.endOffset),!1),o=l(r.getRangeDocument(e)).createTextRange();return o.setEndPoint("StartToStart",t),o.setEndPoint("EndToEnd",n),o};if(o.rangeToTextRange=m,o.prototype.toTextRange=function(){return m(this)},e.WrappedTextRange=o,!e.features.implementsDomRange||e.config.preferTextRange){var g=function(e){return e("return this;")()}(Function);"undefined"==typeof g.Range&&(g.Range=o),e.createNativeRange=function(e){return e=c(e,t,"createNativeRange"),l(e).createTextRange()},e.WrappedRange=o}}e.createRange=function(n){return n=c(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=c(e,t,"createRangyRange"),new r(e)},e.createIframeRange=function(n){return t.deprecationNotice("createIframeRange()","createRange(iframeEl)"),e.createRange(n)},e.createIframeRangyRange=function(n){return t.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),e.createRangyRange(n)},e.addShimListener(function(t){var n=t.document;"undefined"==typeof n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null})}),O.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(e,t){function n(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function o(e,n){if(e){if(S.isWindow(e))return e;if(e instanceof v)return e.win;var o=S.getContentDocument(e,t,n);return S.getWindow(o)}return window}function i(e){return o(e,"getWinSelection").getSelection()}function a(e){return o(e,"getDocSelection").document.selection}function s(e){var t=!1;return e.anchorNode&&(t=1==S.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}function r(e,t,n){var o=n?"end":"start",i=n?"start":"end";e.anchorNode=t[o+"Container"],e.anchorOffset=t[o+"Offset"],e.focusNode=t[i+"Container"],e.focusOffset=t[i+"Offset"]}function l(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function c(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function d(t){var n;return t instanceof A?(n=e.createNativeRange(t.getDocument()),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof L?n=t.nativeRange:P.implementsDomRange&&t instanceof S.getWindow(t.startContainer).Range&&(n=t),n}function u(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;n>t;++t)if(!S.isAncestorOf(e[0],e[t]))return!1;return!0}function f(e){var n=e.getNodes();if(!u(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function p(e){return!!e&&"undefined"!=typeof e.text}function h(e,t){var n=new L(t);e._ranges=[n],r(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function m(t){if(t._ranges.length=0,"None"==t.docSelection.type)c(t);else{var n=t.docSelection.createRange();if(p(n))h(t,n);else{t.rangeCount=n.length;for(var o,i=B(n.item(0)),a=0;a<t.rangeCount;++a)o=e.createRange(i),o.selectNode(n.item(a)),t._ranges.push(o);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,r(t,t._ranges[t.rangeCount-1],!1)}}}function g(e,n){for(var o=e.docSelection.createRange(),i=f(n),a=B(o.item(0)),s=H(a).createControlRange(),r=0,l=o.length;l>r;++r)s.add(o.item(r));try{s.add(i)}catch(c){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}s.select(),m(e)}function v(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function y(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}function b(e,t){for(var n,o,i=te.length;i--;)if(n=te[i],o=n.selection,"deleteAll"==t)y(o);else if(n.win==e)return"delete"==t?(te.splice(i,1),!0):o;return"deleteAll"==t&&(te.length=0),null}function C(e,n){for(var o,i=B(n[0].startContainer),a=H(i).createControlRange(),s=0,r=n.length;r>s;++s){o=f(n[s]);try{a.add(o)}catch(l){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}a.select(),m(e)}function w(e,t){if(e.win.document!=B(t))throw new I("WRONG_DOCUMENT_ERR")}function _(t){return function(n,o){var i;this.rangeCount?(i=this.getRangeAt(0),i["set"+(t?"Start":"End")](n,o)):(i=e.createRange(this.win.document),i.setStartAndEnd(n,o)),this.setSingleRange(i,this.isBackward())}}function E(e){var t=[],n=new D(e.anchorNode,e.anchorOffset),o=new D(e.focusNode,e.focusOffset),i="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var a=0,s=e.rangeCount;s>a;++a)t[a]=A.inspect(e.getRangeAt(a));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}e.config.checkSelectionRanges=!0;var R,T,N="boolean",x="number",S=e.dom,k=e.util,O=k.isHostMethod,A=e.DomRange,L=e.WrappedRange,I=e.DOMException,D=S.DomPosition,P=e.features,M="Control",B=S.getDocument,H=S.getBody,j=A.rangesEqual,W=O(window,"getSelection"),z=k.isHostObject(document,"selection");P.implementsWinGetSelection=W,P.implementsDocSelection=z;var q=z&&(!W||e.config.preferTextRange);q?(R=a,e.isSelectionValid=function(e){var t=o(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||B(n.createRange().parentElement())==t}):W?(R=i,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."),e.getNativeSelection=R;var F=R(),U=e.createNativeRange(document),Q=H(document),V=k.areHostProperties(F,["anchorNode","focusNode","anchorOffset","focusOffset"]);P.selectionHasAnchorAndFocus=V;var Y=O(F,"extend");P.selectionHasExtend=Y;var K=typeof F.rangeCount==x;P.selectionHasRangeCount=K;var X=!1,$=!0,G=Y?function(t,n){var o=A.getRangeDocument(n),i=e.createRange(o);i.collapseToPoint(n.endContainer,n.endOffset),t.addRange(d(i)),t.extend(n.startContainer,n.startOffset)}:null;k.areHostMethods(F,["addRange","getRangeAt","removeAllRanges"])&&typeof F.rangeCount==x&&P.implementsDomRange&&!function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,o=n>1,i=[],a=s(t),r=0;n>r;++r)i[r]=t.getRangeAt(r);var l=H(document),c=l.appendChild(document.createElement("div"));c.contentEditable="false";var d=c.appendChild(document.createTextNode("   ")),u=document.createRange();if(u.setStart(d,1),u.collapse(!0),t.addRange(u),$=1==t.rangeCount,t.removeAllRanges(),!o){var f=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(f&&parseInt(f[1])>=36)X=!1;else{var p=u.cloneRange();u.setStart(d,0),p.setEnd(d,3),p.setStart(d,2),t.addRange(u),t.addRange(p),X=2==t.rangeCount}}for(l.removeChild(c),t.removeAllRanges(),r=0;n>r;++r)0==r&&a?G?G(t,i[r]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(i[r])):t.addRange(i[r])}}(),P.selectionSupportsMultipleRanges=X,P.collapsedNonEditableSelectionsSupported=$;var Z,J=!1;Q&&O(Q,"createControlRange")&&(Z=Q.createControlRange(),k.areHostProperties(Z,["item","add"])&&(J=!0)),P.implementsControlRange=J,T=V?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var ee;O(F,"getRangeAt")?ee=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:V&&(ee=function(t){var n=B(t.anchorNode),o=e.createRange(n);return o.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),o.collapsed!==this.isCollapsed&&o.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),o}),v.prototype=e.selectionPrototype;var te=[],ne=function(e){if(e&&e instanceof v)return e.refresh(),e;e=o(e,"getNativeSelection");var t=b(e),n=R(e),i=z?a(e):null;return t?(t.nativeSelection=n,t.docSelection=i,t.refresh()):(t=new v(n,i,e),te.push({win:e,selection:t})),t};e.getSelection=ne,e.getIframeSelection=function(n){return t.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),e.getSelection(S.getIframeWindow(n))};var oe=v.prototype;if(!q&&V&&k.areHostMethods(F,["removeAllRanges","addRange"])){oe.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),c(this)};var ie=function(e,t){G(e.nativeSelection,t),e.refresh()};K?oe.addRange=function(t,o){if(J&&z&&this.docSelection.type==M)g(this,t);else if(n(o)&&Y)ie(this,t);else{var i;X?i=this.rangeCount:(this.removeAllRanges(),i=0);var a=d(t).cloneRange();try{this.nativeSelection.addRange(a)}catch(s){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==i+1){if(e.config.checkSelectionRanges){var l=ee(this.nativeSelection,this.rangeCount-1);l&&!j(l,t)&&(t=new L(l))}this._ranges[this.rangeCount-1]=t,r(this,t,re(this.nativeSelection)),this.isCollapsed=T(this)}else this.refresh()}}:oe.addRange=function(e,t){n(t)&&Y?ie(this,e):(this.nativeSelection.addRange(d(e)),this.refresh())},oe.setRanges=function(e){if(J&&z&&e.length>1)C(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;n>t;++t)this.addRange(e[t])}}}else{if(!(O(F,"empty")&&O(U,"select")&&J&&q))return t.fail("No means of selecting a Range or TextRange was found"),!1;oe.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=B(this.anchorNode);else if(this.docSelection.type==M){var t=this.docSelection.createRange();t.length&&(e=B(t.item(0)))}if(e){var n=H(e).createTextRange();n.select(),this.docSelection.empty()}}}catch(o){}c(this)},oe.addRange=function(t){this.docSelection.type==M?g(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,r(this,t,!1))},oe.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?C(this,e):t&&this.addRange(e[0])}}oe.getRangeAt=function(e){if(0>e||e>=this.rangeCount)throw new I("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()};var ae;if(q)ae=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=H(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==M?m(t):p(n)?h(t,n):c(t)};else if(O(F,"getRangeAt")&&typeof F.rangeCount==x)ae=function(t){if(J&&z&&t.docSelection.type==M)m(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,o=t.rangeCount;o>n;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));r(t,t._ranges[t.rangeCount-1],re(t.nativeSelection)),t.isCollapsed=T(t)}else c(t)};else{if(!V||typeof F.isCollapsed!=N||typeof U.collapsed!=N||!P.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;ae=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=ee(n,0),e._ranges=[t],e.rangeCount=1,l(e),e.isCollapsed=T(e)):c(e)}}oe.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(ae(this),e){var i=t.length;if(i!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;i--;)if(!j(t[i],this._ranges[i]))return!0;return!1}};var se=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var o=0,i=n.length;i>o;++o)j(t,n[o])||e.addRange(n[o]);e.rangeCount||c(e)};J&&z?oe.removeRange=function(e){if(this.docSelection.type==M){for(var t,n=this.docSelection.createRange(),o=f(e),i=B(n.item(0)),a=H(i).createControlRange(),s=!1,r=0,l=n.length;l>r;++r)t=n.item(r),t!==o||s?a.add(n.item(r)):s=!0;a.select(),m(this)}else se(this,e)}:oe.removeRange=function(e){se(this,e)};var re;!q&&V&&P.implementsDomRange?(re=s,oe.isBackward=function(){return re(this)}):re=oe.isBackward=function(){return!1},oe.isBackwards=oe.isBackward,oe.toString=function(){for(var e=[],t=0,n=this.rangeCount;n>t;++t)e[t]=""+this._ranges[t];return e.join("")},oe.collapse=function(t,n){w(this,t);var o=e.createRange(t);o.collapseToPoint(t,n),this.setSingleRange(o),this.isCollapsed=!0},oe.collapseToStart=function(){if(!this.rangeCount)throw new I("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},oe.collapseToEnd=function(){if(!this.rangeCount)throw new I("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},oe.selectAllChildren=function(t){w(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},oe.deleteFromDocument=function(){if(J&&z&&this.docSelection.type==M){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,i=n.length;i>o;++o)n[o].deleteContents();this.addRange(n[i-1])}}},oe.eachRange=function(e,t){for(var n=0,o=this._ranges.length;o>n;++n)if(e(this.getRangeAt(n)))return t},oe.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},oe.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},oe.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange(function(o){n.push(o[e].apply(o,t))}),n},oe.setStart=_(!0),oe.setEnd=_(!1),e.rangePrototype.select=function(e){ne(this.getDocument()).setSingleRange(this,e)},oe.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange(function(n){e(n),t.push(n)}),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},oe.containsNode=function(e,t){return this.eachRange(function(n){return n.containsNode(e,t)},!0)||!1},oe.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},oe.moveToBookmark=function(t){for(var n,o,i=[],a=0;n=t.rangeBookmarks[a++];)o=e.createRange(this.win),o.moveToBookmark(n),i.push(o);t.backward?this.setSingleRange(i[0],"backward"):this.setRanges(i)},oe.toHtml=function(){var e=[];return this.eachRange(function(t){e.push(A.toHtml(t))}),e.join("")},P.implementsTextRange&&(oe.getNativeTextRange=function(){var n;if(n=this.docSelection){var o=n.createRange();if(p(o))return o;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),oe.getName=function(){return"WrappedSelection"},oe.inspect=function(){return E(this)},oe.detach=function(){b(this.win,"delete"),y(this)},v.detachAll=function(){b(null,"deleteAll")},v.inspect=E,v.isDirectionBackward=n,e.Selection=v,e.selectionPrototype=oe,e.addShimListener(function(e){"undefined"==typeof e.getSelection&&(e.getSelection=function(){return ne(e)}),e=null})});var P=!1,M=function(e){P||(P=!0,!O.initialized&&O.config.autoInitialize&&u())};return S&&(/^(?:complete|interactive)$/.test(document.readyState)?M():(e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",M,!1),L(window,"load",M))),O},this),function(e,t){"function"==typeof define&&define.amd?define(["./rangy-core"],e):"undefined"!=typeof module&&"object"==typeof exports?module.exports=e(require("rangy")):e(t.rangy)}(function(e){e.createModule("ClassApplier",["WrappedSelection"],function(e,t){function n(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)return!1;return!0}function o(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function i(e,t){return e.className&&new RegExp("(?:^|\\s)"+t+"(?:\\s|$)").test(e.className)}function a(e,t){e.className?i(e,t)||(e.className+=" "+t):e.className=t}function s(e){return e&&e.split(/\s+/).sort().join(" ")}function r(e){return s(e.className)}function l(e,t){return r(e)==r(t)}function c(e,t,n,o,i){var a=e.node,s=e.offset,r=a,l=s;a==o&&s>i&&++l,a!=t||s!=n&&s!=n+1||(r=o,l+=i-n),a==t&&s>n+1&&--l,e.node=r,e.offset=l}function d(e,t,n){e.node==t&&e.offset>n&&--e.offset}function u(e,t,n,o){-1==n&&(n=t.childNodes.length);for(var i,a=e.parentNode,s=I.getNodeIndex(e),r=0;i=o[r++];)c(i,a,s,t,n);t.childNodes.length==n?t.appendChild(e):t.insertBefore(e,t.childNodes[n])}function f(e,t){for(var n,o=e.parentNode,i=I.getNodeIndex(e),a=0;n=t[a++];)d(n,o,i);e.parentNode.removeChild(e)}function p(e,t,n,o,i){for(var a,s=[];a=e.firstChild;)u(a,t,n++,i),s.push(a);return o&&f(e,i),s}function h(e,t){return p(e,e.parentNode,I.getNodeIndex(e),!0,t)}function m(e,t){var n=e.cloneRange();n.selectNodeContents(t);var o=n.intersection(e),i=o?o.toString():"";return""!=i}function g(e){for(var t,n=e.getNodes([3]),o=0;(t=n[o])&&!m(e,t);)++o;for(var i=n.length-1;(t=n[i])&&!m(e,t);)--i;return n.slice(o,i+1)}function v(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n,o,i,a=0,s=e.attributes.length;s>a;++a)if(n=e.attributes[a],i=n.name,"class"!=i){if(o=t.attributes.getNamedItem(i),null===n!=(null===o))return!1;if(n.specified!=o.specified)return!1;if(n.specified&&n.nodeValue!==o.nodeValue)return!1}return!0}function y(e,t){for(var n,o=0,i=e.attributes.length;i>o;++o)if(n=e.attributes[o].name,(!t||!P(t,n))&&e.attributes[o].specified&&"class"!=n)return!0;return!1}function b(e,t){return n(t,function(t,n){if("object"==typeof n){if(!b(e[t],n))return!1}else if(e[t]!==n)return!1})}function C(e){var t;return e&&1==e.nodeType&&((t=e.parentNode)&&9==t.nodeType&&"on"==t.designMode||W(e)&&!W(e.parentNode))}function w(e){return(W(e)||1!=e.nodeType&&W(e.parentNode))&&!C(e)}function _(e){return e&&1==e.nodeType&&!z.test(j(e,"display"))}function E(e){if(0==e.data.length)return!0;if(q.test(e.data))return!1;var t=j(e.parentNode,"whiteSpace");switch(t){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(e.data))return!1}return _(e.previousSibling)||_(e.nextSibling)}function R(e){var t,n,o=[];for(t=0;n=e[t++];)o.push(new D(n.startContainer,n.startOffset),new D(n.endContainer,n.endOffset));return o}function T(e,t){for(var n,o,i,a=0,s=e.length;s>a;++a)n=e[a],o=t[2*a],i=t[2*a+1],n.setStartAndEnd(o.node,o.offset,i.node,i.offset)}function N(e,t){return I.isCharacterDataNode(e)?0==t?!!e.previousSibling:t==e.length?!!e.nextSibling:!0:t>0&&t<e.childNodes.length}function x(e,n,o,i){var a,s,r=0==o;if(I.isAncestorOf(n,e))return e;if(I.isCharacterDataNode(n)){var l=I.getNodeIndex(n);if(0==o)o=l;else{if(o!=n.length)throw t.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+o+" in "+n.data);o=l+1}n=n.parentNode}if(N(n,o)){a=n.cloneNode(!1),s=n.parentNode,a.id&&a.removeAttribute("id");for(var c,d=0;c=n.childNodes[o];)u(c,a,d++,i);return u(a,s,I.getNodeIndex(n)+1,i),n==e?a:x(e,s,I.getNodeIndex(a),i)}if(e!=n){a=n.parentNode;var f=I.getNodeIndex(n);return r||f++,x(e,a,f,i)}return e}function S(e,t){return e.namespaceURI==t.namespaceURI&&e.tagName.toLowerCase()==t.tagName.toLowerCase()&&l(e,t)&&v(e,t)&&"inline"==j(e,"display")&&"inline"==j(t,"display")}function k(e){var t=e?"nextSibling":"previousSibling";return function(n,o){var i=n.parentNode,a=n[t];if(a){if(a&&3==a.nodeType)return a}else if(o&&(a=i[t],a&&1==a.nodeType&&S(i,a))){var s=a[e?"firstChild":"lastChild"];if(s&&3==s.nodeType)return s}return null}}function O(e){this.isElementMerge=1==e.nodeType,this.textNodes=[];var t=this.isElementMerge?e.lastChild:e;t&&(this.textNodes[0]=t)}function A(e,t,i){var a,s,r,l,c=this;c.cssClass=c.className=e;var d=null,u={};if("object"==typeof t&&null!==t){for(i=t.tagNames,d=t.elementProperties,u=t.elementAttributes,s=0;l=Q[s++];)t.hasOwnProperty(l)&&(c[l]=t[l]);a=t.normalize}else a=t;c.normalize="undefined"==typeof a?!0:a,c.attrExceptions=[];var f=document.createElement(c.elementTagName);c.elementProperties=c.copyPropertiesToElement(d,f,!0),n(u,function(e){c.attrExceptions.push(e)}),c.elementAttributes=u,c.elementSortedClassName=c.elementProperties.hasOwnProperty("className")?c.elementProperties.className:e,c.applyToAnyTagName=!1;var p=typeof i;if("string"==p)"*"==i?c.applyToAnyTagName=!0:c.tagNames=o(i.toLowerCase()).split(/\s*,\s*/);else if("object"==p&&"number"==typeof i.length)for(c.tagNames=[],s=0,r=i.length;r>s;++s)"*"==i[s]?c.applyToAnyTagName=!0:c.tagNames.push(i[s].toLowerCase());else c.tagNames=[c.elementTagName]}function L(e,t,n){return new A(e,t,n)}var I=e.dom,D=I.DomPosition,P=I.arrayContains,M=I.isHtmlNamespace,B="span",H=function(){function e(e,t,n){return t&&n?" ":""}return function(t,n){t.className&&(t.className=t.className.replace(new RegExp("(^|\\s)"+n+"(\\s|$)"),e))}}(),j=I.getComputedStyleProperty,W=function(){var e=document.createElement("div");return"boolean"==typeof e.isContentEditable?function(e){return e&&1==e.nodeType&&e.isContentEditable}:function(e){return e&&1==e.nodeType&&"false"!=e.contentEditable?"true"==e.contentEditable||W(e.parentNode):!1}}(),z=/^inline(-block|-table)?$/i,q=/[^\r\n\t\f \u200B]/,F=k(!1),U=k(!0);O.prototype={doMerge:function(e){var t=this.textNodes,n=t[0];if(t.length>1){for(var o,i,a,s,r=I.getNodeIndex(n),l=[],c=0,d=0,u=t.length;u>d;++d){if(o=t[d],i=o.parentNode,d>0&&(i.removeChild(o),i.hasChildNodes()||i.parentNode.removeChild(i),e))for(a=0;s=e[a++];)s.node==o&&(s.node=n,s.offset+=c),s.node==i&&s.offset>r&&(--s.offset,s.offset==r+1&&u-1>d&&(s.node=n,s.offset=c));l[d]=o.data,c+=o.data.length}n.data=l.join("")}return n.data},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){for(var e=[],t=0,n=this.textNodes.length;n>t;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}};var Q=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],V={};A.prototype={elementTagName:B,elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(e,t,n){var o,i,r,l,c,d,u={};for(var f in e)if(e.hasOwnProperty(f))if(l=e[f],c=t[f],"className"==f)a(t,l),a(t,this.className),t[f]=s(t[f]),n&&(u[f]=t[f]);else if("style"==f){i=c,n&&(u[f]=r={});for(o in e[f])i[o]=l[o],n&&(r[o]=i[o]);this.attrExceptions.push(f)}else t[f]=l,n&&(u[f]=t[f],d=V.hasOwnProperty(f)?V[f]:f,this.attrExceptions.push(d));return n?u:""},copyAttributesToElement:function(e,t){for(var n in e)e.hasOwnProperty(n)&&t.setAttribute(n,e[n])},hasClass:function(e){return 1==e.nodeType&&P(this.tagNames,e.tagName.toLowerCase())&&i(e,this.className)},getSelfOrAncestorWithClass:function(e){for(;e;){if(this.hasClass(e))return e;e=e.parentNode}return null},isModifiable:function(e){return!this.applyToEditableOnly||w(e)},isIgnorableWhiteSpaceNode:function(e){return this.ignoreWhiteSpace&&e&&3==e.nodeType&&E(e)},postApply:function(e,t,n,o){for(var i,a,s,r=e[0],l=e[e.length-1],c=[],d=r,u=l,f=0,p=l.length,h=0,m=e.length;m>h;++h)a=e[h],s=F(a,!o),s?(i||(i=new O(s),c.push(i)),i.textNodes.push(a),a===r&&(d=i.textNodes[0],f=d.length),a===l&&(u=i.textNodes[0],p=i.getLength())):i=null;var g=U(l,!o);if(g&&(i||(i=new O(l),c.push(i)),i.textNodes.push(g)),c.length){for(h=0,m=c.length;m>h;++h)c[h].doMerge(n);t.setStartAndEnd(d,f,u,p)}},createContainer:function(e){var t=e.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,t,!1),this.copyAttributesToElement(this.elementAttributes,t),a(t,this.className),this.onElementCreate&&this.onElementCreate(t,this),t},applyToTextNode:function(e,t){var n=e.parentNode;if(1==n.childNodes.length&&this.useExistingElements&&M(n)&&P(this.tagNames,n.tagName.toLowerCase())&&b(n,this.elementProperties))a(n,this.className);else{var o=this.createContainer(I.getDocument(e));e.parentNode.insertBefore(o,e),o.appendChild(e)}},isRemovable:function(e){return M(e)&&e.tagName.toLowerCase()==this.elementTagName&&r(e)==this.elementSortedClassName&&b(e,this.elementProperties)&&!y(e,this.attrExceptions)&&this.isModifiable(e)},isEmptyContainer:function(e){var t=e.childNodes.length;return 1==e.nodeType&&this.isRemovable(e)&&(0==t||1==t&&this.isEmptyContainer(e.firstChild))},removeEmptyContainers:function(e){for(var t,n=this,o=e.getNodes([1],function(e){return n.isEmptyContainer(e)}),i=[e],a=R(i),s=0;t=o[s++];)f(t,a);T(i,a)},undoToTextNode:function(e,t,n,o){if(!t.containsNode(n)){var i=t.cloneRange();i.selectNode(n),i.isPointInRange(t.endContainer,t.endOffset)&&(x(n,t.endContainer,t.endOffset,o),t.setEndAfter(n)),i.isPointInRange(t.startContainer,t.startOffset)&&(n=x(n,t.startContainer,t.startOffset,o))}this.isRemovable(n)?h(n,o):H(n,this.className)},applyToRange:function(e,t){t=t||[];var n=R(t||[]);e.splitBoundariesPreservingPositions(n),this.removeEmptyElements&&this.removeEmptyContainers(e);var o=g(e);if(o.length){for(var i,a=0;i=o[a++];)this.isIgnorableWhiteSpaceNode(i)||this.getSelfOrAncestorWithClass(i)||!this.isModifiable(i)||this.applyToTextNode(i,n);i=o[o.length-1],e.setStartAndEnd(o[0],0,i,i.length),this.normalize&&this.postApply(o,e,n,!1),T(t,n)}},applyToRanges:function(e){for(var t=e.length;t--;)this.applyToRange(e[t],e);return e},applyToSelection:function(t){var n=e.getSelection(t);n.setRanges(this.applyToRanges(n.getAllRanges()))},undoToRange:function(e,t){t=t||[];var n=R(t);e.splitBoundariesPreservingPositions(n),this.removeEmptyElements&&this.removeEmptyContainers(e,n);var o,i,a=g(e),s=a[a.length-1];if(a.length){for(var r=0,l=a.length;l>r;++r)o=a[r],i=this.getSelfOrAncestorWithClass(o),i&&this.isModifiable(o)&&this.undoToTextNode(o,e,i,n),e.setStartAndEnd(a[0],0,s,s.length);this.normalize&&this.postApply(a,e,n,!0),T(t,n)}},undoToRanges:function(e){for(var t=e.length;t--;)this.undoToRange(e[t],e);return e},undoToSelection:function(t){var n=e.getSelection(t),o=e.getSelection(t).getAllRanges();this.undoToRanges(o),n.setRanges(o)},isAppliedToRange:function(e){if(e.collapsed||""==e.toString())return!!this.getSelfOrAncestorWithClass(e.commonAncestorContainer);var t=e.getNodes([3]);if(t.length)for(var n,o=0;n=t[o++];)if(!this.isIgnorableWhiteSpaceNode(n)&&m(e,n)&&this.isModifiable(n)&&!this.getSelfOrAncestorWithClass(n))return!1;return!0},isAppliedToRanges:function(e){var t=e.length;if(0==t)return!1;for(;t--;)if(!this.isAppliedToRange(e[t]))return!1;return!0},isAppliedToSelection:function(t){var n=e.getSelection(t);return this.isAppliedToRanges(n.getAllRanges())},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)},toggleSelection:function(e){this.isAppliedToSelection(e)?this.undoToSelection(e):this.applyToSelection(e)},getElementsWithClassIntersectingRange:function(e){var t=[],n=this;return e.getNodes([3],function(e){var o=n.getSelfOrAncestorWithClass(e);o&&!P(t,o)&&t.push(o)}),t},detach:function(){}},A.util={hasClass:i,addClass:a,removeClass:H,hasSameClasses:l,replaceWithOwnChildren:h,elementsHaveSameNonClassAttributes:v,elementHasNonClassAttributes:y,splitNodeAt:x,isEditableElement:W,isEditingHost:C,isEditable:w},e.CssClassApplier=e.ClassApplier=A,e.createCssClassApplier=e.createClassApplier=L})},this),function(e,t){"use strict";var n=function(){var n=function(e){return e.replace(/^\s+|\s+$/g,"")},o=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},i=e.rangy||null,a=e.Undo||null,s=!i||!a,r=e.Key={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capsLock:20,escape:27,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindow:91,rightWindowKey:92,select:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numLock:144,scrollLock:145,semiColon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,singleQuote:222},l=function(t){var n,o,i,a=this,c=new l.Action,d=new l.Cache,u=new l.Cursor,f=new l.HtmlAssistant,p=new l.Utilities,h=new l.Selection,m={focus:function(t){t=t||e.event,l.activeElement=n},blur:function(t){t=t||e.event,l.activeElement===n&&(l.activeElement=null),f.placeholders()},down:function(t){t=t||e.event;var n=!0;if(229!==t.keyCode){if(p.isCommand(t,function(){d.cmd=!0},function(){d.cmd=!1}),p.isShift(t,function(){d.shift=!0},function(){d.shift=!1}),p.isModifier(t,function(e){if(d.cmd){if((v.mode===l.inlineMode||v.mode===l.partialMode)&&"paste"!==e)return void p.preventDefaultEvent(t);var o=typeof e,i=null;i="function"===o?e:m.command[e],n=i.call(a,t),n===!1&&(p.preventDefaultEvent(t),p.stopPropagation(t))}}),-1!==v.maxLength){var o=f.text().length,i=!1,s=e.getSelection();if(s&&(i=!s.isCollapsed),o>=v.maxLength&&!p.isSpecial(t)&&!p.isNavigational(t)&&!i)return p.preventDefaultEvent(t)}switch(t.keyCode){case r.enter:m.enterKey(t);break;case r.backspace:case r["delete"]:m.backspaceOrDeleteKey(t)}return n}},up:function(t){t=t||e.event,p.isCommand(t,function(){d.cmd=!1},function(){d.cmd=!0}),f.clean(),f.placeholders();var n;if(null!==v.keyContext&&(n=v.keyContext[t.keyCode])){var o=u.parent();o&&n.call(a,t,o)}c.preserveElementFocus()},command:{bold:function(e){p.preventDefaultEvent(e),new l.Element(a,"bold").setClean(!1).invoke(v.beforeInvokeElement)},underline:function(e){p.preventDefaultEvent(e),new l.Element(a,"underline").setClean(!1).invoke(v.beforeInvokeElement)},italicize:function(e){p.preventDefaultEvent(e),new l.Element(a,"italic").setClean(!1).invoke(v.beforeInvokeElement)},quote:function(e){},paste:function(e){if(a.makeUndoable(),v.pasteAsText){var t=p.selection.saveSelection();p.pasteHook(function(e){p.selection.restoreSelection(t),e=e.replace(/\n/g,"<br>"),new l.Html(a,e).setClean(!1).insert(v.beforeInsertHtml,!0),f.clean(),f.placeholders()})}else f.clean(),f.placeholders()}},enterKey:function(e){if(v.mode===l.inlineMode)return p.preventDefaultEvent(e);if(!d.shift){var t,o,i,a=f.atCaret()||{},s=n.children,r=a===n.lastChild?n.lastChild:null;r&&r!==n.firstChild&&v.autoHR&&"partial"!==v.mode&&v.tags.horizontalRule&&(p.preventDefaultEvent(e),t=""===f.text(r)&&r.nodeName.toLowerCase()===v.tags.paragraph,t&&s.length>=2&&(o=s[s.length-2],o.nodeName.toLowerCase()===v.tags.horizontalRule&&(t=!1)),t&&(f.addTag(v.tags.horizontalRule,!1,!0,a),a=a.nextSibling),null!==(i=f.addTag(v.tags.paragraph,!0,null,a))&&(i.innerHTML="",u.set(0,i)))}return!0},backspaceOrDeleteKey:function(e){if(null!==n.lastChild){var t=n.lastChild,o=t.previousSibling;t&&v.tags.horizontalRule&&t.nodeName.toLocaleLowerCase()===v.tags.horizontalRule?n.removeChild(t):t&&o&&p.html.text(t).length<1&&o.nodeName.toLowerCase()===v.tags.horizontalRule&&t.nodeName.toLowerCase()===v.tags.paragraph&&(n.removeChild(t),n.removeChild(o))}}},g={element:null,modifier:"auto",placeholder:"",autofocus:!1,autoHR:!0,mode:l.richMode,maxLength:-1,modifiers:{b:"bold",i:"italicize",u:"underline",v:"paste"},tags:{"break":"br",horizontalRule:"hr",paragraph:"p",outerLevel:["pre","blockquote","figure"],
innerLevel:["a","b","u","i","img","strong"]},cssClasses:{editor:"Medium",pasteHook:"Medium-paste-hook",placeholder:"Medium-placeholder",clear:"Medium-clear"},attributes:{remove:["style","class"]},pasteAsText:!0,beforeInvokeElement:function(){},beforeInsertHtml:function(){},beforeAddTag:function(e,t,n,o){},keyContext:null,pasteEventHandler:function(t){t=t||e.event,a.makeUndoable();var o,i=a.value().length;if(v.pasteAsText){p.preventDefaultEvent(t);var s=p.selection.saveSelection(),r=prompt(l.Messages.pastHere)||"";if(r.length>0)return n.focus(),l.activeElement=n,p.selection.restoreSelection(s),r=f.encodeHtml(r),o=r.length+i,v.maxLength>0&&o>v.maxLength&&(r=r.substring(0,v.maxLength-i)),v.mode!==l.inlineMode&&(r=r.replace(/\n/g,"<br>")),new l.Html(a,r).setClean(!1).insert(v.beforeInsertHtml,!0),f.clean(),f.placeholders(),!1}else setTimeout(function(){f.clean(),f.placeholders()},20)}},v=p.deepExtend(g,t),y={};for(i in g)"object"!=typeof g[i]&&g.hasOwnProperty(i)&&v.element.getAttribute("data-medium-"+r)&&(o=v.element.getAttribute("data-medium-"+r),("false"===o.toLowerCase()||"true"===o.toLowerCase())&&(o="true"===o.toLowerCase()),v[i]=o);if(v.modifiers)for(i in v.modifiers)"undefined"!=typeof r[i]&&(v.modifiers[r[i]]=v.modifiers[i]);if(v.keyContext)for(i in v.keyContext)"undefined"!=typeof r[i]&&(v.keyContext[r[i]]=v.keyContext[i]);n=v.element,n.contentEditable=!0,n.className+=" "+v.cssClasses.editor+(" "+v.cssClasses.editor+"-"+v.mode),v.tags=v.tags||{},v.tags.outerLevel&&(v.tags.outerLevel=v.tags.outerLevel.concat([v.tags.paragraph,v.tags.horizontalRule])),this.settings=v,this.element=n,this.intercept=m,this.action=c,this.cache=d,this.cursor=u,this.html=f,this.utils=p,this.selection=h,y.element=n,y.medium=this,y.settings=v,y.action=c,y.cache=d,y.cursor=u,y.html=f,y.intercept=m,y.utils=p,y.selection=h,c.setBridge(y),d.setBridge(y),u.setBridge(y),f.setBridge(y),p.setBridge(y),h.setBridge(y),f.clean(),f.placeholders(),c.preserveElementFocus(),c.listen(),s?this.makeUndoable=function(){}:(this.dirty=!1,this.undoable=new l.Undoable(this),this.undo=this.undoable.undo,this.redo=this.undoable.redo,this.makeUndoable=this.undoable.makeUndoable),n.medium=this,d.initialized=!0};return l.prototype={insertHtml:function(e,t){var n=new l.Html(this,e).insert(this.settings.beforeInsertHtml);return this.utils.triggerEvent(this.element,"change"),t&&t.apply(n),this},invokeElement:function(e,t){var n=this.settings,t=t||{},i=t.remove||[];switch(n.mode){case l.inlineMode:case l.partialMode:return this}return i.length>0&&(o(n,"class")||i.push("class")),new l.Element(this,e,t).invoke(this.settings.beforeInvokeElement),this.utils.triggerEvent(this.element,"change"),this},behavior:function(){return s?"wild":"domesticated"},value:function(e){return"undefined"==typeof e?this.element.innerHTML:(this.element.innerHTML=e,this.html.clean(),this.html.placeholders(),this)},focus:function(){var e=this.element;return e.focus(),this},select:function(){var n,o,i=this.element;return i.focus(),t.body.createTextRange?(n=t.body.createTextRange(),n.moveToElementText(i),n.select()):e.getSelection&&(o=e.getSelection(),n=t.createRange(),n.selectNodeContents(i),o.removeAllRanges(),o.addRange(n)),this},isActive:function(){return l.activeElement===this.element},destroy:function(){var e=this.element,t=this.intercept,o=this.settings,i=this.placeholder||null;null!==i&&i.setup&&(i.parentNode.removeChild(i),delete e.placeHolderActive),e.removeAttribute("contenteditable"),e.className=n(e.className.replace(o.cssClasses.editor,"").replace(o.cssClasses.clear,"").replace(o.cssClasses.editor+"-"+o.mode,"")),this.utils.removeEvent(e,"keyup",t.up).removeEvent(e,"keydown",t.down).removeEvent(e,"focus",t.focus).removeEvent(e,"blur",t.focus).removeEvent(e,"paste",o.pasteEventHandler)},clear:function(){this.element.innerHTML="",this.html.placeholders()}},l.Element=function(e,t,n){if(this.medium=e,this.element=e.settings.element,s)this.tagName=t;else switch(t.toLowerCase()){case"bold":this.tagName="b";break;case"italic":this.tagName="i";break;case"underline":this.tagName="u";break;default:this.tagName=t}this.attributes=n||{},this.clean=!0},l.Html=function(e,t){this.medium=e,this.element=e.settings.element,this.html=t,this.clean=!0},l.Injector=function(){},s?(l.Element.prototype={invoke:function(e){l.activeElement===this.element&&(e&&e.apply(this),t.execCommand(this.tagName,!1))},setClean:function(){return this}},l.Injector.prototype={inject:function(e,t){return this.insertHTML(e,t),null}},l.Undoable=function(){}):(i.rangePrototype.insertNodeAtEnd=function(e){var t=this.cloneRange();t.collapse(!1),t.insertNode(e),t.detach(),this.setEndAfter(e)},l.Element.prototype={invoke:function(t){if(l.activeElement===this.element){t&&t.apply(this);var n,o,a=this.attributes,s=this.tagName.toLowerCase();void 0!==a.className?(o=(a.className.split[" "]||[a.className]).shift(),delete a.className):o="lasso-"+s,n=i.createClassApplier(o,{elementTagName:s,elementAttributes:this.attributes}),this.medium.makeUndoable(),n.toggleSelection(e),this.clean&&(this.medium.html.clean(),this.medium.html.placeholders())}},setClean:function(e){return this.clean=e,this}},l.Injector.prototype={inject:function(e){var n,o=!1;if("string"==typeof e){var i=t.createElement("div");i.innerHTML=e,n=i.childNodes,o=!0}else n=e;this.insertHTML('<span id="wedge"></span>');var a=t.getElementById("wedge"),s=a.parentNode,r=0;if(a.removeAttribute("id"),o)for(;r<n.length;)s.insertBefore(n[r],a);else s.insertBefore(n,a);return s.removeChild(a),a=null,n}},l.Undoable=function(e){var t,n=this,o=e.settings.element,i=e.utils,a=i.addEvent,s=o.innerHTML,l=new Undo.Stack,c=Undo.Command.extend({constructor:function(e,t){this.oldValue=e,this.newValue=t},execute:function(){},undo:function(){o.innerHTML=this.oldValue,e.canUndo=l.canUndo(),e.canRedo=l.canRedo(),e.dirty=l.dirty()},redo:function(){o.innerHTML=this.newValue,e.canUndo=l.canUndo(),e.canRedo=l.canRedo(),e.dirty=l.dirty()}}),d=function(){var t=o.innerHTML;t!=s&&(n.movingThroughStack||(l.execute(new c(s,t)),s=t,e.dirty=l.dirty()),i.triggerEvent(e.settings.element,"change"))};this.medium=e,this.timer=t,this.stack=l,this.makeUndoable=d,this.EditCommand=c,this.movingThroughStack=!1,a(o,"keyup",function(e){return e.ctrlKey||e.keyCode===r.z?void i.preventDefaultEvent(e):(clearTimeout(t),void(t=setTimeout(function(){d()},250)))}),a(o,"keydown",function(e){return e.ctrlKey&&e.keyCode===r.z?(i.preventDefaultEvent(e),n.movingThroughStack=!0,void(e.shiftKey?l.canRedo()&&l.redo():l.canUndo()&&l.undo())):(n.movingThroughStack=!1,!0)})}),l.Injector.prototype.insertHTML=function(n,o){var i,a;if(e.getSelection){if(i=e.getSelection(),i.getRangeAt&&i.rangeCount){a=i.getRangeAt(0),a.deleteContents();var s=t.createElement("div");s.innerHTML=n;for(var r,l,c=t.createDocumentFragment();r=s.firstChild;)l=c.appendChild(r);var d=c.firstChild;a.insertNode(c),l&&(a=a.cloneRange(),a.setStartAfter(l),o?a.setStartBefore(d):a.collapse(!0),i.removeAllRanges(),i.addRange(a))}}else if((i=t.selection)&&"Control"!=i.type){var u=i.createRange();u.collapse(!0),i.createRange().pasteHTML(n),o&&(a=i.createRange(),a.setEndPoint("StartToStart",u),a.select())}},l.Html.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},insert:function(e,t){if(l.activeElement===this.element){e&&e.apply(this);var n=this.injector.inject(this.html,t);return this.clean&&(this.medium.html.clean(),this.medium.html.placeholders()),this.medium.makeUndoable(),n}return null},injector:new l.Injector,setClean:function(e){return this.clean=e,this}},l.Utilities=function(){},l.Utilities.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},isCommand:function(e,t,n){var o=this.settings;return"ctrl"===o.modifier&&e.ctrlKey||"cmd"===o.modifier&&e.metaKey||"auto"===o.modifier&&(e.ctrlKey||e.metaKey)?t.call():n.call()},isShift:function(e,t,n){return e.shiftKey?t.call():n.call()},isModifier:function(e,t){var n=this.settings.modifiers[e.keyCode];return n?t.call(null,n):!1},special:function(){var e={};return e[r.backspace]=!0,e[r.shift]=!0,e[r.ctrl]=!0,e[r.alt]=!0,e[r["delete"]]=!0,e[r.cmd]=!0,e}(),isSpecial:function(e){return this.cache.cmd?!0:"undefined"!=typeof this.special[e.keyCode]},navigational:function(){var e={};return e[r.upArrow]=!0,e[r.downArrow]=!0,e[r.leftArrow]=!0,e[r.rightArrow]=!0,e}(),isNavigational:function(e){return"undefined"!=typeof this.navigational[e.keyCode]},addEvent:function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n,this},removeEvent:function(e,t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null,this},preventDefaultEvent:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stopPropagation:function(e){e=e||window.event,e.cancelBubble=!0,void 0!==e.stopPropagation&&e.stopPropagation()},triggerEvent:function(e,n){var o;return t.createEvent?(o=t.createEvent("HTMLEvents"),o.initEvent(n,!0,!0),o.eventName=n,e.dispatchEvent(o)):(o=t.createEventObject(),e.fireEvent("on"+n,o)),this},deepExtend:function(e,t){for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},this.deepExtend(e[n],t[n])):e[n]=t[n];return e},pasteHook:function(e){var n,o,i,a=t.createElement("textarea"),r=this.element,l=this.settings,c=this.medium,d=this.html;a.className=l.cssClasses.pasteHook,r.parentNode.appendChild(a),a.focus(),s||c.makeUndoable(),setTimeout(function(){r.focus(),l.maxLength>0&&(n=d.text(r),o=n.length,i=o+a.value.length,i>o&&(a.value=a.value.substring(0,l.maxLength-o))),e(a.value),d.deleteNode(a)},2)},setupContents:function(){var e,n=this.element,o=n.children,i=n.childNodes;!this.settings.tags.paragraph||o.length>0||this.settings.mode===l.inlineMode||(i.length>0?(e=t.createElement(this.settings.tags.paragraph),n.innerHTML.match("^[&]nbsp[;]")&&(n.innerHTML=n.innerHTML.substring(6,n.innerHTML.length-1)),e.innerHTML=n.innerHTML,n.innerHTML="",n.appendChild(e),this.cursor.set(e.innerHTML.length,e)):(e=t.createElement(this.settings.tags.paragraph),e.innerHTML="&nbsp;",n.appendChild(e)))},traverseAll:function(e,t,n){var o,i=e.childNodes,a=i.length,s=0,n=n||1;if(t=t||{},a>0)for(;a>s;s++){switch(o=i[s],o.nodeType){case 1:this.traverseAll(o,t,n+1),void 0!==t.element&&t.element(o,s,n,e);break;case 3:void 0!==t.fragment&&t.fragment(o,s,n,e)}a=i.length,o===e.lastChild&&(s=a)}}},l.Selection=function(){},l.Selection.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},saveSelection:function(){if(e.getSelection){var n=e.getSelection();if(n.rangeCount>0)return n.getRangeAt(0)}else if(t.selection&&t.selection.createRange)return t.selection.createRange();return null},restoreSelection:function(n){if(n)if(e.getSelection){var o=e.getSelection();o.removeAllRanges(),o.addRange(n)}else t.selection&&n.select&&n.select()}},l.Cursor=function(){},l.Cursor.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},set:function(n,o){var i,a=this.html;if(t.createRange){var s=e.getSelection(),r=a.lastChild(),l=a.text(r).length-1,c=o?o:r,d="undefined"!=typeof n&&null!==n?n:l;i=t.createRange(),i.setStart(c,d),i.collapse(!0),s.removeAllRanges(),s.addRange(i)}else i=t.body.createTextRange(),i.moveToElementText(o),i.collapse(!1),i.select()},parent:function(){var n,o=null;return e.getSelection?(n=e.getSelection().getRangeAt(0),o=n.commonAncestorContainer,o=1===o.nodeType?o:o.parentNode):t.selection&&(o=t.selection.createRange().parentElement()),"SPAN"==o.tagName&&(o=o.parentNode),o},caretToBeginning:function(e){this.set(0,e)},caretToEnd:function(e){this.set(this.html.text(e).length,e)}},l.HtmlAssistant=function(){},l.HtmlAssistant.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},encodeHtml:function(e){return t.createElement("a").appendChild(t.createTextNode(e)).parentNode.innerHTML},text:function(e,t){if(e=e||this.settings.element,t)e.textContent&&"undefined"!=typeof e.textContent?e.textContent=t:e.innerText=t;else{if(e.innerText)return n(e.innerText);if(e.textContent)return n(e.textContent);if(e.data)return n(e.data)}return""},changeTag:function(e,n){var o,i,a=t.createElement(n);for(o=e.firstChild;o;)i=o.nextSibling,a.appendChild(o),o=i;return e.parentNode.insertBefore(a,e),e.parentNode.removeChild(e),a},deleteNode:function(e){e.parentNode.removeChild(e)},placeholders:function(){if(e.getComputedStyle){var o=this.settings,i=this.medium.placeholder||(this.medium.placeholder=t.createElement("div")),a=o.element,s=i.style,r=e.getComputedStyle(a,null),c=function(e){return r.getPropertyValue(e)},d=this.utils,u=d.html.text(a),f=this.cursor,p=a.children.length;if(a.placeholder=i,u.length<1&&2>p){if(a.placeHolderActive)return;a.innerHTML.match("<"+o.tags.paragraph)||(a.innerHTML=""),o.placeholder.length>0&&(i.setup||(i.setup=!0,s.background=c("background"),s.backgroundColor=c("background-color"),s.fontSize=c("font-size"),s.color=r.color,s.marginTop=c("margin-top"),s.marginBottom=c("margin-bottom"),s.marginLeft=c("margin-left"),s.marginRight=c("margin-right"),s.paddingTop=c("padding-top"),s.paddingBottom=c("padding-bottom"),s.paddingLeft=c("padding-left"),s.paddingRight=c("padding-right"),s.borderTopWidth=c("border-top-width"),s.borderTopColor=c("border-top-color"),s.borderTopStyle=c("border-top-style"),s.borderBottomWidth=c("border-bottom-width"),s.borderBottomColor=c("border-bottom-color"),s.borderBottomStyle=c("border-bottom-style"),s.borderLeftWidth=c("border-left-width"),s.borderLeftColor=c("border-left-color"),s.borderLeftStyle=c("border-left-style"),s.borderRightWidth=c("border-right-width"),s.borderRightColor=c("border-right-color"),s.borderRightStyle=c("border-right-style"),i.className=o.cssClasses.placeholder+" "+o.cssClasses.placeholder+"-"+o.mode,i.innerHTML="<div>"+o.placeholder+"</div>",a.parentNode.insertBefore(i,a)),a.className+=" "+o.cssClasses.clear,s.display="",s.minHeight=a.clientHeight+"px",s.minWidth=a.clientWidth+"px",o.mode!==l.inlineMode&&(d.setupContents(),0===p&&a.firstChild&&f.set(0,a.firstChild))),a.placeHolderActive=!0}else a.placeHolderActive&&(a.placeHolderActive=!1,s.display="none",a.className=n(a.className.replace(o.cssClasses.clear,"")),d.setupContents())}},clean:function(t){var n,o,i,a=this.settings,s=a.cssClasses.placeholder,r=(a.attributes||{}).remove||[],l=a.tags||{},c=l.outerLevel||null,d=l.innerLevel||null,u={},f={},p=(l.paragraph||"").toUpperCase(),h=this.html;if(t=t||a.element,null!==c)for(i=0;i<c.length;i++)u[c[i].toUpperCase()]=!0;if(null!==d)for(i=0;i<d.length;i++)f[d[i].toUpperCase()]=!0;this.utils.traverseAll(t,{element:function(t,a,l,m){var g=t.nodeName,v=!0;for(i=0;i<r.length;i++)n=r[i],t.hasAttribute(n)&&t.getAttribute(n)!==s&&t.removeAttribute(n);if((null!==c||null!==d)&&(1===l&&void 0!==u[g]?v=!1:l>1&&void 0!==f[g]&&(v=!1),v))if("block"===e.getComputedStyle(t,null).getPropertyValue("display")){if(p.length>0&&p!==g&&h.changeTag(t,p),l>1)for(;m.childNodes.length>a;)m.parentNode.insertBefore(m.lastChild,m.nextSibling)}else switch(g){case"BR":if(t===t.parentNode.lastChild){if(t===t.parentNode.firstChild)break;o=document.createTextNode(""),o.innerHTML="&nbsp",m.insertBefore(o,t);break}default:for(;null!==t.firstChild;)m.insertBefore(t.firstChild,t);h.deleteNode(t)}}})},lastChild:function(){return this.element.lastChild},addTag:function(e,n,o,i){if(!this.settings.beforeAddTag(e,n,o,i)){var a,s=t.createElement(e);return"undefined"!=typeof o&&o===!1&&(s.contentEditable=!1),0==s.innerHTML.length&&(s.innerHTML=" "),i&&i.nextSibling?(i.parentNode.insertBefore(s,i.nextSibling),a=i.nextSibling):(this.settings.element.appendChild(s),a=this.html.lastChild()),n&&(this.cache.focusedElement=a,this.cursor.set(0,a)),s}return null},baseAtCaret:function(){if(!this.medium.isActive())return null;var t=e.getSelection?e.getSelection():document.selection;if(t.rangeCount){var n=t.getRangeAt(0),o=n.endContainer;switch(o.nodeType){case 3:if(o.data&&o.data.length!=n.endOffset)return!1}return o}return null},atCaret:function(){var e=this.baseAtCaret()||{},t=this.element;if(e===!1)return null;for(;e&&e.parentNode!==t;)e=e.parentNode;return e&&1==e.nodeType?e:null}},l.Action=function(){},l.Action.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},listen:function(){var e=this.element,t=this.intercept;this.utils.addEvent(e,"keyup",t.up).addEvent(e,"keydown",t.down).addEvent(e,"focus",t.focus).addEvent(e,"blur",t.blur).addEvent(e,"paste",this.settings.pasteEventHandler)},preserveElementFocus:function(){var n=e.getSelection?e.getSelection().anchorNode:t.activeElement;if(n){var o,i=this.medium.cache,a=this.settings,s=n.parentNode,r=a.element.children,l=s!==i.focusedElement,c=0;for(s===a.element&&(s=n),o=0;o<r.length;o++)if(s===r[o]){c=o;break}l&&(i.focusedElement=s,i.focusedElementIndex=c)}}},l.Cache=function(){this.initialized=!1,this.cmd=!1,this.focusedElement=null},l.Cache.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]}},l.inlineMode="inline",l.partialMode="partial",l.richMode="rich",l.Messages={pastHere:"Paste Here"},l}();"function"==typeof define&&define.amd?define(function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:"undefined"!=typeof this&&(this.Medium=n)}.call(this,window,document),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){"use strict";function t(e){return"string"==typeof e?parseInt(e,10):~~e}var n={wheelSpeed:1,wheelPropagation:!1,swipePropagation:!0,minScrollbarLength:null,maxScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1},o=0,i=function(){var e=o++;return function(t){var n=".perfect-scrollbar-"+e;return"undefined"==typeof t?n:t+n}},a="WebkitAppearance"in document.documentElement.style;e.fn.perfectScrollbar=function(o,s){return this.each(function(){function r(e,n){var o=e+n,i=S-M;B=0>o?0:o>i?i:o;var a=t(B*(O-S)/(S-M));T.scrollTop(a)}function l(e,n){var o=e+n,i=x-L;I=0>o?0:o>i?i:o;var a=t(I*(k-x)/(x-L));T.scrollLeft(a)}function c(e){return R.minScrollbarLength&&(e=Math.max(e,R.minScrollbarLength)),R.maxScrollbarLength&&(e=Math.min(e,R.maxScrollbarLength)),e}function d(){var e={width:D};j?e.left=T.scrollLeft()+x-k:e.left=T.scrollLeft(),Q?e.bottom=U-T.scrollTop():e.top=V+T.scrollTop(),q.css(e);var t={top:T.scrollTop(),height:H};Z?j?t.right=k-T.scrollLeft()-G-$.outerWidth():t.right=G-T.scrollLeft():j?t.left=T.scrollLeft()+2*x-k-J-$.outerWidth():t.left=J+T.scrollLeft(),X.css(t),F.css({left:I,width:L-Y}),$.css({top:B,height:M-ee})}function u(){T.removeClass("ps-active-x"),T.removeClass("ps-active-y"),x=R.includePadding?T.innerWidth():T.width(),S=R.includePadding?T.innerHeight():T.height(),k=T.prop("scrollWidth"),O=T.prop("scrollHeight"),!R.suppressScrollX&&x+R.scrollXMarginOffset<k?(A=!0,D=x-K,L=c(t(D*x/k)),I=t(T.scrollLeft()*(D-L)/(k-x))):(A=!1,L=0,I=0,T.scrollLeft(0)),!R.suppressScrollY&&S+R.scrollYMarginOffset<O?(P=!0,H=S-te,M=c(t(H*S/O)),B=t(T.scrollTop()*(H-M)/(O-S))):(P=!1,M=0,B=0,T.scrollTop(0)),I>=D-L&&(I=D-L),B>=H-M&&(B=H-M),d(),A&&T.addClass("ps-active-x"),P&&T.addClass("ps-active-y")}function f(){var t,n,o=function(e){l(t,e.pageX-n),u(),e.stopPropagation(),e.preventDefault()},i=function(t){q.removeClass("in-scrolling"),e(z).unbind(W("mousemove"),o)};F.bind(W("mousedown"),function(a){n=a.pageX,t=F.position().left,q.addClass("in-scrolling"),e(z).bind(W("mousemove"),o),e(z).one(W("mouseup"),i),a.stopPropagation(),a.preventDefault()}),t=n=null}function p(){var t,n,o=function(e){r(t,e.pageY-n),u(),e.stopPropagation(),e.preventDefault()},i=function(t){X.removeClass("in-scrolling"),e(z).unbind(W("mousemove"),o)};$.bind(W("mousedown"),function(a){n=a.pageY,t=$.position().top,X.addClass("in-scrolling"),e(z).bind(W("mousemove"),o),e(z).one(W("mouseup"),i),a.stopPropagation(),a.preventDefault()}),t=n=null}function h(e,t){var n=T.scrollTop();if(0===e){if(!P)return!1;if(0===n&&t>0||n>=O-S&&0>t)return!R.wheelPropagation}var o=T.scrollLeft();if(0===t){if(!A)return!1;if(0===o&&0>e||o>=k-x&&e>0)return!R.wheelPropagation}return!0}function m(e,t){var n=T.scrollTop(),o=T.scrollLeft(),i=Math.abs(e),a=Math.abs(t);if(a>i){if(0>t&&n===O-S||t>0&&0===n)return!R.swipePropagation}else if(i>a&&(0>e&&o===k-x||e>0&&0===o))return!R.swipePropagation;return!0}function g(){function e(e){var t=e.originalEvent.deltaX,n=-1*e.originalEvent.deltaY;return("undefined"==typeof t||"undefined"==typeof n)&&(t=-1*e.originalEvent.wheelDeltaX/6,n=e.originalEvent.wheelDeltaY/6),e.originalEvent.deltaMode&&1===e.originalEvent.deltaMode&&(t*=10,n*=10),t!==t&&n!==n&&(t=0,n=e.originalEvent.wheelDelta),[t,n]}function t(t){if(a||!(T.find("select:focus").length>0)){var o=e(t),i=o[0],s=o[1];n=!1,R.useBothWheelAxes?P&&!A?(s?T.scrollTop(T.scrollTop()-s*R.wheelSpeed):T.scrollTop(T.scrollTop()+i*R.wheelSpeed),n=!0):A&&!P&&(i?T.scrollLeft(T.scrollLeft()+i*R.wheelSpeed):T.scrollLeft(T.scrollLeft()-s*R.wheelSpeed),n=!0):(T.scrollTop(T.scrollTop()-s*R.wheelSpeed),T.scrollLeft(T.scrollLeft()+i*R.wheelSpeed)),u(),n=n||h(i,s),n&&(t.stopPropagation(),t.preventDefault())}}var n=!1;"undefined"!=typeof window.onwheel?T.bind(W("wheel"),t):"undefined"!=typeof window.onmousewheel&&T.bind(W("mousewheel"),t)}function v(){var t=!1;T.bind(W("mouseenter"),function(e){t=!0}),T.bind(W("mouseleave"),function(e){t=!1});var n=!1;e(z).bind(W("keydown"),function(o){if((!o.isDefaultPrevented||!o.isDefaultPrevented())&&t){for(var i=document.activeElement?document.activeElement:z.activeElement;i.shadowRoot;)i=i.shadowRoot.activeElement;if(!e(i).is(":input,[contenteditable]")){var a=0,s=0;switch(o.which){case 37:a=-30;break;case 38:s=30;break;case 39:a=30;break;case 40:s=-30;break;case 33:s=90;break;case 32:case 34:s=-90;break;case 35:s=o.ctrlKey?-O:-S;break;case 36:s=o.ctrlKey?T.scrollTop():S;break;default:return}T.scrollTop(T.scrollTop()-s),T.scrollLeft(T.scrollLeft()+a),n=h(a,s),n&&o.preventDefault()}}})}function y(){function e(e){e.stopPropagation()}$.bind(W("click"),e),X.bind(W("click"),function(e){var n=t(M/2),o=e.pageY-X.offset().top-n,i=S-M,a=o/i;0>a?a=0:a>1&&(a=1),T.scrollTop((O-S)*a)}),F.bind(W("click"),e),q.bind(W("click"),function(e){var n=t(L/2),o=e.pageX-q.offset().left-n,i=x-L,a=o/i;0>a?a=0:a>1&&(a=1),T.scrollLeft((k-x)*a)})}function b(){function t(){var e=window.getSelection?window.getSelection():document.getSlection?document.getSlection():{rangeCount:0};return 0===e.rangeCount?null:e.getRangeAt(0).commonAncestorContainer}function n(){i||(i=setInterval(function(){return N()?(T.scrollTop(T.scrollTop()+a.top),T.scrollLeft(T.scrollLeft()+a.left),void u()):void clearInterval(i)},50))}function o(){i&&(clearInterval(i),i=null),q.removeClass("in-scrolling"),X.removeClass("in-scrolling")}var i=null,a={top:0,left:0},s=!1;e(z).bind(W("selectionchange"),function(n){e.contains(T[0],t())?s=!0:(s=!1,o())}),e(window).bind(W("mouseup"),function(e){s&&(s=!1,o())}),e(window).bind(W("mousemove"),function(e){if(s){var t={x:e.pageX,y:e.pageY},i=T.offset(),r={left:i.left,right:i.left+T.outerWidth(),top:i.top,bottom:i.top+T.outerHeight()};t.x<r.left+3?(a.left=-5,q.addClass("in-scrolling")):t.x>r.right-3?(a.left=5,q.addClass("in-scrolling")):a.left=0,t.y<r.top+3?(r.top+3-t.y<5?a.top=-5:a.top=-20,X.addClass("in-scrolling")):t.y>r.bottom-3?(t.y-r.bottom+3<5?a.top=5:a.top=20,X.addClass("in-scrolling")):a.top=0,0===a.top&&0===a.left?o():n()}})}function C(t,n){function o(e,t){T.scrollTop(T.scrollTop()-t),T.scrollLeft(T.scrollLeft()-e),u()}function i(e){v=!0}function a(e){v=!1}function s(e){return e.originalEvent.targetTouches?e.originalEvent.targetTouches[0]:e.originalEvent}function r(e){var t=e.originalEvent;return t.targetTouches&&1===t.targetTouches.length?!0:t.pointerType&&"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE?!0:!1}function l(e){if(r(e)){y=!0;var t=s(e);f.pageX=t.pageX,f.pageY=t.pageY,p=(new Date).getTime(),null!==g&&clearInterval(g),e.stopPropagation()}}function c(e){if(!v&&y&&r(e)){var t=s(e),n={pageX:t.pageX,pageY:t.pageY},i=n.pageX-f.pageX,a=n.pageY-f.pageY;o(i,a),f=n;var l=(new Date).getTime(),c=l-p;c>0&&(h.x=i/c,h.y=a/c,p=l),m(i,a)&&(e.stopPropagation(),e.preventDefault())}}function d(e){!v&&y&&(y=!1,clearInterval(g),g=setInterval(function(){return N()?Math.abs(h.x)<.01&&Math.abs(h.y)<.01?void clearInterval(g):(o(30*h.x,30*h.y),h.x*=.8,void(h.y*=.8)):void clearInterval(g)},10))}var f={},p=0,h={},g=null,v=!1,y=!1;t&&(e(window).bind(W("touchstart"),i),e(window).bind(W("touchend"),a),T.bind(W("touchstart"),l),T.bind(W("touchmove"),c),T.bind(W("touchend"),d)),n&&(window.PointerEvent?(e(window).bind(W("pointerdown"),i),e(window).bind(W("pointerup"),a),T.bind(W("pointerdown"),l),T.bind(W("pointermove"),c),T.bind(W("pointerup"),d)):window.MSPointerEvent&&(e(window).bind(W("MSPointerDown"),i),e(window).bind(W("MSPointerUp"),a),T.bind(W("MSPointerDown"),l),T.bind(W("MSPointerMove"),c),T.bind(W("MSPointerUp"),d)))}function w(){T.bind(W("scroll"),function(e){u()})}function _(){T.unbind(W()),e(window).unbind(W()),e(z).unbind(W()),T.data("perfect-scrollbar",null),T.data("perfect-scrollbar-update",null),T.data("perfect-scrollbar-destroy",null),F.remove(),$.remove(),q.remove(),X.remove(),T=q=X=F=$=A=P=x=S=k=O=L=I=U=Q=V=M=B=G=Z=J=j=W=null}function E(){u(),w(),f(),p(),y(),b(),g(),(ne||oe)&&C(ne,oe),R.useKeyboard&&v(),T.data("perfect-scrollbar",T),T.data("perfect-scrollbar-update",u),T.data("perfect-scrollbar-destroy",_)}var R=e.extend(!0,{},n),T=e(this),N=function(){return!!T};if("object"==typeof o?e.extend(!0,R,o):s=o,"update"===s)return T.data("perfect-scrollbar-update")&&T.data("perfect-scrollbar-update")(),T;if("destroy"===s)return T.data("perfect-scrollbar-destroy")&&T.data("perfect-scrollbar-destroy")(),T;if(T.data("perfect-scrollbar"))return T.data("perfect-scrollbar");T.addClass("ps-container");var x,S,k,O,A,L,I,D,P,M,B,H,j="rtl"===T.css("direction"),W=i(),z=this.ownerDocument||document,q=e("<div class='ps-scrollbar-x-rail'>").appendTo(T),F=e("<div class='ps-scrollbar-x'>").appendTo(q),U=t(q.css("bottom")),Q=U===U,V=Q?null:t(q.css("top")),Y=t(q.css("borderLeftWidth"))+t(q.css("borderRightWidth")),K=t(q.css("marginLeft"))+t(q.css("marginRight")),X=e("<div class='ps-scrollbar-y-rail'>").appendTo(T),$=e("<div class='ps-scrollbar-y'>").appendTo(X),G=t(X.css("right")),Z=G===G,J=Z?null:t(X.css("left")),ee=t(X.css("borderTopWidth"))+t(X.css("borderBottomWidth")),te=t(X.css("marginTop"))+t(X.css("marginBottom")),ne="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,oe=null!==window.navigator.msMaxTouchPoints;return E(),T})}}),function(e,t){function n(){function n(t){var n=t||e.event,o=n.keyCode||n.which;if(-1!==[9,13,32,27].indexOf(o)){for(var i=n.target||n.srcElement,a=-1,s=0;s<R.length;s++)if(i===R[s]){a=s;break}9===o?(i=-1===a?_:a===R.length-1?R[0]:R[a+1],D(n),i.focus(),r(i,u.confirmButtonColor)):(i=13===o||32===o?-1===a?_:void 0:27!==o||E.hidden||"none"===E.style.display?void 0:E,void 0!==i&&I(i,n))}}function s(t){var n=t||e.event,o=n.target||n.srcElement,i=n.relatedTarget,a=w(m,"visible");if(a){var s=-1;if(null!==i){for(var r=0;r<R.length;r++)if(i===R[r]){s=r;break}-1===s&&o.focus()}else h=o}}if(void 0===arguments[0])return e.console.error("sweetAlert expects at least 1 attribute!"),!1;var u=a({},y);switch(typeof arguments[0]){case"string":u.title=arguments[0],u.text=arguments[1]||"",u.type=arguments[2]||"";break;case"object":if(void 0===arguments[0].title)return e.console.error('Missing "title" argument!'),!1;u.title=arguments[0].title,u.text=arguments[0].text||y.text,u.type=arguments[0].type||y.type,u.customClass=arguments[0].customClass||u.customClass,u.allowOutsideClick=arguments[0].allowOutsideClick||y.allowOutsideClick,u.showCancelButton=void 0!==arguments[0].showCancelButton?arguments[0].showCancelButton:y.showCancelButton,u.closeOnConfirm=void 0!==arguments[0].closeOnConfirm?arguments[0].closeOnConfirm:y.closeOnConfirm,u.closeOnCancel=void 0!==arguments[0].closeOnCancel?arguments[0].closeOnCancel:y.closeOnCancel,u.timer=arguments[0].timer||y.timer,u.confirmButtonText=y.showCancelButton?"Confirm":y.confirmButtonText,u.confirmButtonText=arguments[0].confirmButtonText||y.confirmButtonText,u.confirmButtonColor=arguments[0].confirmButtonColor||y.confirmButtonColor,u.cancelButtonText=arguments[0].cancelButtonText||y.cancelButtonText,u.imageUrl=arguments[0].imageUrl||y.imageUrl,u.imageSize=arguments[0].imageSize||y.imageSize,u.doneFunction=arguments[1]||null;break;default:return e.console.error('Unexpected type of argument! Expected "string" or "object", got '+typeof arguments[0]),!1}o(u),d(),l();for(var m=b(),g=function(t){var n=t||e.event,o=n.target||n.srcElement,a="confirm"===o.className,s=w(m,"visible"),r=u.doneFunction&&"true"===m.getAttribute("data-has-done-function");switch(n.type){case"mouseover":a&&(o.style.backgroundColor=i(u.confirmButtonColor,-.04));break;case"mouseout":a&&(o.style.backgroundColor=u.confirmButtonColor);break;case"mousedown":a&&(o.style.backgroundColor=i(u.confirmButtonColor,-.14));break;case"mouseup":a&&(o.style.backgroundColor=i(u.confirmButtonColor,-.04));break;case"focus":var l=m.querySelector("button.confirm"),d=m.querySelector("button.cancel");a?d.style.boxShadow="none":l.style.boxShadow="none";break;case"click":if(a&&r&&s)u.doneFunction(!0),u.closeOnConfirm&&c();else if(r&&s){var f=String(u.doneFunction).replace(/\s/g,""),p="function("===f.substring(0,9)&&")"!==f.substring(9,10);p&&u.doneFunction(!1),u.closeOnCancel&&c()}else c()}},v=m.querySelectorAll("button"),C=0;C<v.length;C++)v[C].onclick=g,v[C].onmouseover=g,v[C].onmouseout=g,v[C].onmousedown=g,v[C].onfocus=g;f=t.onclick,t.onclick=function(t){var n=t||e.event,o=n.target||n.srcElement,i=m===o,a=k(m,o),s=w(m,"visible"),r="true"===m.getAttribute("data-allow-ouside-click");!i&&!a&&s&&r&&c()};var _=m.querySelector("button.confirm"),E=m.querySelector("button.cancel"),R=m.querySelectorAll("button:not([type=hidden])");p=e.onkeydown,e.onkeydown=n,_.onblur=s,E.onblur=s,e.onfocus=function(){e.setTimeout(function(){void 0!==h&&(h.focus(),h=void 0)},0)}}function o(t){var n=b(),o=n.querySelector("h2"),i=n.querySelector("p"),a=n.querySelector("button.cancel"),s=n.querySelector("button.confirm");if(o.innerHTML=R(t.title).split("\n").join("<br>"),i.innerHTML=R(t.text||"").split("\n").join("<br>"),t.text&&N(i),t.customClass&&_(n,t.customClass),S(n.querySelectorAll(".icon")),t.type){for(var l=!1,c=0;c<v.length;c++)if(t.type===v[c]){l=!0;break}if(!l)return e.console.error("Unknown alert type: "+t.type),!1;var d=n.querySelector(".icon."+t.type);switch(N(d),t.type){case"success":_(d,"animate"),_(d.querySelector(".tip"),"animateSuccessTip"),_(d.querySelector(".long"),"animateSuccessLong");break;case"error":_(d,"animateErrorIcon"),_(d.querySelector(".x-mark"),"animateXMark");break;case"warning":_(d,"pulseWarning"),_(d.querySelector(".body"),"pulseWarningIns"),_(d.querySelector(".dot"),"pulseWarningIns")}}if(t.imageUrl){var u=n.querySelector(".icon.custom");u.style.backgroundImage="url("+t.imageUrl+")",N(u);var f=80,p=80;if(t.imageSize){var h=t.imageSize.split("x")[0],m=t.imageSize.split("x")[1];h&&m?(f=h,p=m,u.css({width:h+"px",height:m+"px"})):e.console.error("Parameter imageSize expects value with format WIDTHxHEIGHT, got "+t.imageSize)}u.setAttribute("style",u.getAttribute("style")+"width:"+f+"px; height:"+p+"px")}n.setAttribute("data-has-cancel-button",t.showCancelButton),t.showCancelButton?a.style.display="inline-block":S(a),t.cancelButtonText&&(a.innerHTML=R(t.cancelButtonText)),t.confirmButtonText&&(s.innerHTML=R(t.confirmButtonText)),s.style.backgroundColor=t.confirmButtonColor,r(s,t.confirmButtonColor),n.setAttribute("data-allow-ouside-click",t.allowOutsideClick);var g=t.doneFunction?!0:!1;n.setAttribute("data-has-done-function",g),n.setAttribute("data-timer",t.timer)}function i(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var n,o,i="#";for(o=0;3>o;o++)n=parseInt(e.substr(2*o,2),16),n=Math.round(Math.min(Math.max(0,n+n*t),255)).toString(16),
i+=("00"+n).substr(n.length);return i}function a(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function s(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?parseInt(t[1],16)+", "+parseInt(t[2],16)+", "+parseInt(t[3],16):null}function r(e,t){var n=s(t);e.style.boxShadow="0 0 2px rgba("+n+", 0.8), inset 0 0 0 1px rgba(0, 0, 0, 0.05)"}function l(){var e=b();A(C(),10),N(e),_(e,"showSweetAlert"),E(e,"hideSweetAlert"),u=t.activeElement;var n=e.querySelector("button.confirm");n.focus(),setTimeout(function(){_(e,"visible")},500);var o=e.getAttribute("data-timer");"null"!==o&&""!==o&&(e.timeout=setTimeout(function(){c()},o))}function c(){var n=b();L(C(),5),L(n,5),E(n,"showSweetAlert"),_(n,"hideSweetAlert"),E(n,"visible");var o=n.querySelector(".icon.success");E(o,"animate"),E(o.querySelector(".tip"),"animateSuccessTip"),E(o.querySelector(".long"),"animateSuccessLong");var i=n.querySelector(".icon.error");E(i,"animateErrorIcon"),E(i.querySelector(".x-mark"),"animateXMark");var a=n.querySelector(".icon.warning");E(a,"pulseWarning"),E(a.querySelector(".body"),"pulseWarningIns"),E(a.querySelector(".dot"),"pulseWarningIns"),e.onkeydown=p,t.onclick=f,u&&u.focus(),h=void 0,clearTimeout(n.timeout)}function d(){var e=b();e.style.marginTop=O(b())}var u,f,p,h,m=".sweet-alert",g=".sweet-overlay",v=["error","warning","info","success"],y={title:"",text:"",type:null,allowOutsideClick:!1,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",confirmButtonColor:"#AEDEF4",cancelButtonText:"Cancel",imageUrl:null,imageSize:null,timer:null},b=function(){return t.querySelector(m)},C=function(){return t.querySelector(g)},w=function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")},_=function(e,t){w(e,t)||(e.className+=" "+t)},E=function(e,t){var n=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(w(e,t)){for(;n.indexOf(" "+t+" ")>=0;)n=n.replace(" "+t+" "," ");e.className=n.replace(/^\s+|\s+$/g,"")}},R=function(e){var n=t.createElement("div");return n.appendChild(t.createTextNode(e)),n.innerHTML},T=function(e){e.style.opacity="",e.style.display="block"},N=function(e){if(e&&!e.length)return T(e);for(var t=0;t<e.length;++t)T(e[t])},x=function(e){e.style.opacity="",e.style.display="none"},S=function(e){if(e&&!e.length)return x(e);for(var t=0;t<e.length;++t)x(e[t])},k=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1},O=function(e){e.style.left="-9999px",e.style.display="block";var t,n=e.clientHeight;return t="undefined"!=typeof getComputedStyle?parseInt(getComputedStyle(e).getPropertyValue("padding"),10):parseInt(e.currentStyle.padding),e.style.left="",e.style.display="none","-"+parseInt(n/2+t)+"px"},A=function(e,t){if(+e.style.opacity<1){t=t||16,e.style.opacity=0,e.style.display="block";var n=+new Date,o=function(){e.style.opacity=+e.style.opacity+(new Date-n)/100,n=+new Date,+e.style.opacity<1&&setTimeout(o,t)};o()}e.style.display="block"},L=function(e,t){t=t||16,e.style.opacity=1;var n=+new Date,o=function(){e.style.opacity=+e.style.opacity-(new Date-n)/100,n=+new Date,+e.style.opacity>0?setTimeout(o,t):e.style.display="none"};o()},I=function(n){if(MouseEvent){var o=new MouseEvent("click",{view:e,bubbles:!1,cancelable:!0});n.dispatchEvent(o)}else if(t.createEvent){var i=t.createEvent("MouseEvents");i.initEvent("click",!1,!1),n.dispatchEvent(i)}else t.createEventObject?n.fireEvent("onclick"):"function"==typeof n.onclick&&n.onclick()},D=function(t){"function"==typeof t.stopPropagation?(t.stopPropagation(),t.preventDefault()):e.event&&e.event.hasOwnProperty("cancelBubble")&&(e.event.cancelBubble=!0)};e.sweetAlertInitialize=function(){var e='<div class="sweet-overlay" tabIndex="-1"></div><div class="sweet-alert" tabIndex="-1"><div class="icon error"><span class="x-mark"><span class="line left"></span><span class="line right"></span></span></div><div class="icon warning"> <span class="body"></span> <span class="dot"></span> </div> <div class="icon info"></div> <div class="icon success"> <span class="line tip"></span> <span class="line long"></span> <div class="placeholder"></div> <div class="fix"></div> </div> <div class="icon custom"></div> <h2>Title</h2><p>Text</p><button class="cancel" tabIndex="2">Cancel</button><button class="confirm" tabIndex="1">OK</button></div>',n=t.createElement("div");n.innerHTML=e,t.body.appendChild(n)},e.sweetAlert=e.swal=function(){var e=arguments;if(null!==b())n.apply(this,e);else var t=setInterval(function(){null!==b()&&(clearInterval(t),n.apply(this,e))},100)},e.swal.setDefaults=function(e){if(!e)throw new Error("userParams is required");if("object"!=typeof e)throw new Error("userParams has to be a object");a(y,e)},function(){"complete"===t.readyState||"interactive"===t.readyState&&t.body?e.sweetAlertInitialize():t.addEventListener?t.addEventListener("DOMContentLoaded",function(){t.removeEventListener("DOMContentLoaded",arguments.callee,!1),e.sweetAlertInitialize()},!1):t.attachEvent&&t.attachEvent("onreadystatechange",function(){"complete"===t.readyState&&(t.detachEvent("onreadystatechange",arguments.callee),e.sweetAlertInitialize())})}()}(window,document),function(e,t,n,o){function i(t,n){this.options=e.extend(!0,{},a,n),this.input=t,this.$input=e(t),this._defaults=a,this._name="geocomplete",this.init()}var a={bounds:!0,country:null,map:!1,details:!1,detailsAttribute:"name",autoselect:!0,location:!1,mapOptions:{zoom:14,scrollwheel:!1,mapTypeId:"roadmap"},markerOptions:{draggable:!1},maxZoom:16,types:["geocode"],blur:!1},s="street_address route intersection political country administrative_area_level_1 administrative_area_level_2 administrative_area_level_3 colloquial_area locality sublocality neighborhood premise subpremise postal_code natural_feature airport park point_of_interest post_box street_number floor room lat lng viewport location formatted_address location_type bounds".split(" "),r="id place_id url website vicinity reference name rating international_phone_number icon formatted_phone_number".split(" ");e.extend(i.prototype,{init:function(){this.initMap(),this.initMarker(),this.initGeocoder(),this.initDetails(),this.initLocation()},initMap:function(){if(this.options.map){if("function"==typeof this.options.map.setCenter)return void(this.map=this.options.map);this.map=new google.maps.Map(e(this.options.map)[0],this.options.mapOptions),google.maps.event.addListener(this.map,"click",e.proxy(this.mapClicked,this)),google.maps.event.addListener(this.map,"zoom_changed",e.proxy(this.mapZoomed,this))}},initMarker:function(){if(this.map){var t=e.extend(this.options.markerOptions,{map:this.map});t.disabled||(this.marker=new google.maps.Marker(t),google.maps.event.addListener(this.marker,"dragend",e.proxy(this.markerDragged,this)))}},initGeocoder:function(){var t={types:this.options.types,bounds:this.options.bounds===!0?null:this.options.bounds,componentRestrictions:this.options.componentRestrictions};this.options.country&&(t.componentRestrictions={country:this.options.country}),this.autocomplete=new google.maps.places.Autocomplete(this.input,t),this.geocoder=new google.maps.Geocoder,this.map&&this.options.bounds===!0&&this.autocomplete.bindTo("bounds",this.map),google.maps.event.addListener(this.autocomplete,"place_changed",e.proxy(this.placeChanged,this)),this.$input.keypress(function(e){return 13===e.keyCode?!1:void 0}),this.$input.bind("geocode",e.proxy(function(){this.find()},this)),this.options.blur===!0&&this.$input.blur(e.proxy(function(){this.find()},this))},initDetails:function(){function t(e){i[e]=n.find("["+o+"="+e+"]")}if(this.options.details){var n=e(this.options.details),o=this.options.detailsAttribute,i={};e.each(s,function(e,n){t(n),t(n+"_short")}),e.each(r,function(e,n){t(n)}),this.$details=n,this.details=i}},initLocation:function(){var e,t=this.options.location;if(t){if("string"==typeof t)return void this.find(t);t instanceof Array&&(e=new google.maps.LatLng(t[0],t[1])),t instanceof google.maps.LatLng&&(e=t),e&&(this.map&&this.map.setCenter(e),this.marker&&this.marker.setPosition(e))}},find:function(e){this.geocode({address:e||this.$input.val()})},geocode:function(t){this.options.bounds&&!t.bounds&&(this.options.bounds===!0?t.bounds=this.map&&this.map.getBounds():t.bounds=this.options.bounds),this.options.country&&(t.region=this.options.country),this.geocoder.geocode(t,e.proxy(this.handleGeocode,this))},selectFirstResult:function(){var t="";e(".pac-item-selected")[0]&&(t="-selected");var n=e(".pac-container .pac-item"+t+":first span:nth-child(2)").text(),o=e(".pac-container .pac-item"+t+":first span:nth-child(3)").text(),i=n;return o&&(i+=" - "+o),this.$input.val(i),i},handleGeocode:function(e,t){if(t===google.maps.GeocoderStatus.OK){var n=e[0];this.$input.val(n.formatted_address),this.update(n),e.length>1&&this.trigger("geocode:multiple",e)}else this.trigger("geocode:error",t)},trigger:function(e,t){this.$input.trigger(e,[t])},center:function(e){e.viewport?(this.map.fitBounds(e.viewport),this.map.getZoom()>this.options.maxZoom&&this.map.setZoom(this.options.maxZoom)):(this.map.setZoom(this.options.maxZoom),this.map.setCenter(e.location)),this.marker&&(this.marker.setPosition(e.location),this.marker.setAnimation(this.options.markerOptions.animation))},update:function(e){this.map&&this.center(e.geometry),this.$details&&this.fillDetails(e),this.trigger("geocode:result",e)},fillDetails:function(t){var n={},o=t.geometry,i=o.viewport,a=o.bounds;e.each(t.address_components,function(t,o){o.types[0];e.each(o.types,function(e,t){n[t]=o.long_name,n[t+"_short"]=o.short_name})}),e.each(r,function(e,o){n[o]=t[o]}),e.extend(n,{formatted_address:t.formatted_address,location_type:o.location_type||"PLACES",viewport:i,bounds:a,location:o.location,lat:o.location.lat(),lng:o.location.lng()}),e.each(this.details,e.proxy(function(e,t){var o=n[e];this.setDetail(t,o)},this)),this.data=n},setDetail:function(e,t){t===o?t="":"function"==typeof t.toUrlValue&&(t=t.toUrlValue()),e.is(":input")?e.val(t):e.text(t)},markerDragged:function(e){this.trigger("geocode:dragged",e.latLng)},mapClicked:function(e){this.trigger("geocode:click",e.latLng)},mapZoomed:function(e){this.trigger("geocode:zoom",this.map.getZoom())},resetMarker:function(){this.marker.setPosition(this.data.location),this.setDetail(this.details.lat,this.data.location.lat()),this.setDetail(this.details.lng,this.data.location.lng())},placeChanged:function(){var e=this.autocomplete.getPlace();if(e&&e.geometry)this.update(e);else if(this.options.autoselect){var t=this.selectFirstResult();this.find(t)}}}),e.fn.geocomplete=function(t){var n="plugin_geocomplete";if("string"==typeof t){var o=e(this).data(n)||e(this).geocomplete().data(n),a=o[t];return"function"==typeof a?(a.apply(o,Array.prototype.slice.call(arguments,1)),e(this)):(2==arguments.length&&(a=arguments[1]),a)}return this.each(function(){var o=e.data(this,n);o||(o=new i(this,t),e.data(this,n,o))})}}(jQuery,window,document),function(){function e(){}function t(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}var o=e.prototype,i=this,a=i.EventEmitter;o.getListeners=function(e){var t,n,o=this._getEvents();if("object"==typeof e){t={};for(n in o)o.hasOwnProperty(n)&&e.test(n)&&(t[n]=o[n])}else t=o[e]||(o[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},o.addListener=function(e,n){var o,i=this.getListenersAsObject(e),a="object"==typeof n;for(o in i)i.hasOwnProperty(o)&&-1===t(i[o],n)&&i[o].push(a?n:{listener:n,once:!1});return this},o.on=n("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=n("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,n){var o,i,a=this.getListenersAsObject(e);for(i in a)a.hasOwnProperty(i)&&(o=t(a[i],n),-1!==o&&a[i].splice(o,1));return this},o.off=n("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var o,i,a=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(o=n.length;o--;)a.call(this,t,n[o]);else for(o in t)t.hasOwnProperty(o)&&(i=t[o])&&("function"==typeof i?a.call(this,o,i):s.call(this,o,i));return this},o.removeEvent=function(e){var t,n=typeof e,o=this._getEvents();if("string"===n)delete o[e];else if("object"===n)for(t in o)o.hasOwnProperty(t)&&e.test(t)&&delete o[t];else delete this._events;return this},o.removeAllListeners=n("removeEvent"),o.emitEvent=function(e,t){var n,o,i,a,s=this.getListenersAsObject(e);for(i in s)if(s.hasOwnProperty(i))for(o=s[i].length;o--;)n=s[i][o],n.once===!0&&this.removeListener(e,n.listener),a=n.listener.apply(this,t||[]),a===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},o.trigger=n("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},o._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return i.EventEmitter=a,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}.call(this),function(e){function t(t){var n=e.event;return n.target=n.target||n.srcElement||t,n}var n=document.documentElement,o=function(){};n.addEventListener?o=function(e,t,n){e.addEventListener(t,n,!1)}:n.attachEvent&&(o=function(e,n,o){e[n+o]=o.handleEvent?function(){var n=t(e);o.handleEvent.call(o,n)}:function(){var n=t(e);o.call(e,n)},e.attachEvent("on"+n,e[n+o])});var i=function(){};n.removeEventListener?i=function(e,t,n){e.removeEventListener(t,n,!1)}:n.detachEvent&&(i=function(e,t,n){e.detachEvent("on"+t,e[t+n]);try{delete e[t+n]}catch(o){e[t+n]=void 0}});var a={bind:o,unbind:i};"function"==typeof define&&define.amd?define("eventie/eventie",a):e.eventie=a}(this),function(e,t){"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(n,o){return t(e,n,o)}):"object"==typeof exports?module.exports=t(e,require("wolfy87-eventemitter"),require("eventie")):e.imagesLoaded=t(e,e.EventEmitter,e.eventie)}(window,function(e,t,n){function o(e,t){for(var n in t)e[n]=t[n];return e}function i(e){return"[object Array]"===f.call(e)}function a(e){var t=[];if(i(e))t=e;else if("number"==typeof e.length)for(var n=0,o=e.length;o>n;n++)t.push(e[n]);else t.push(e);return t}function s(e,t,n){if(!(this instanceof s))return new s(e,t);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=a(e),this.options=o({},this.options),"function"==typeof t?n=t:o(this.options,t),n&&this.on("always",n),this.getImages(),c&&(this.jqDeferred=new c.Deferred);var i=this;setTimeout(function(){i.check()})}function r(e){this.img=e}function l(e){this.src=e,p[e]=this}var c=e.jQuery,d=e.console,u="undefined"!=typeof d,f=Object.prototype.toString;s.prototype=new t,s.prototype.options={},s.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;t>e;e++){var n=this.elements[e];"IMG"===n.nodeName&&this.addImage(n);var o=n.nodeType;if(o&&(1===o||9===o||11===o))for(var i=n.querySelectorAll("img"),a=0,s=i.length;s>a;a++){var r=i[a];this.addImage(r)}}},s.prototype.addImage=function(e){var t=new r(e);this.images.push(t)},s.prototype.check=function(){function e(e,i){return t.options.debug&&u&&d.log("confirm",e,i),t.progress(e),n++,n===o&&t.complete(),!0}var t=this,n=0,o=this.images.length;if(this.hasAnyBroken=!1,!o)return void this.complete();for(var i=0;o>i;i++){var a=this.images[i];a.on("confirm",e),a.check()}},s.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;var t=this;setTimeout(function(){t.emit("progress",t,e),t.jqDeferred&&t.jqDeferred.notify&&t.jqDeferred.notify(t,e)})},s.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var t=this;setTimeout(function(){if(t.emit(e,t),t.emit("always",t),t.jqDeferred){var n=t.hasAnyBroken?"reject":"resolve";t.jqDeferred[n](t)}})},c&&(c.fn.imagesLoaded=function(e,t){var n=new s(this,e,t);return n.jqDeferred.promise(c(this))}),r.prototype=new t,r.prototype.check=function(){var e=p[this.img.src]||new l(this.img.src);if(e.isConfirmed)return void this.confirm(e.isLoaded,"cached was confirmed");if(this.img.complete&&void 0!==this.img.naturalWidth)return void this.confirm(0!==this.img.naturalWidth,"naturalWidth");var t=this;e.on("confirm",function(e,n){return t.confirm(e.isLoaded,n),!0}),e.check()},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("confirm",this,t)};var p={};return l.prototype=new t,l.prototype.check=function(){if(!this.isChecked){var e=new Image;n.bind(e,"load",this),n.bind(e,"error",this),e.src=this.src,this.isChecked=!0}},l.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},l.prototype.onload=function(e){this.confirm(!0,"onload"),this.unbindProxyEvents(e)},l.prototype.onerror=function(e){this.confirm(!1,"onerror"),this.unbindProxyEvents(e)},l.prototype.confirm=function(e,t){this.isConfirmed=!0,this.isLoaded=e,this.emit("confirm",this,t)},l.prototype.unbindProxyEvents=function(e){n.unbind(e.target,"load",this),n.unbind(e.target,"error",this)},s}),function(e,t){if(!e)return t;var n=function(){this.el=t,this.items=t,this.sizes=[],this.max=[0,0],this.current=0,this.interval=t,this.opts={speed:500,delay:3e3,complete:t,keys:!t,dots:t,fluid:t};var n=this;this.init=function(t,n){return this.el=t,this.ul=t.children("ul"),this.max=[t.outerWidth(),t.outerHeight()],this.items=this.ul.children("li").each(this.calculate),this.opts=e.extend(this.opts,n),this.setup(),this},this.calculate=function(t){var o=e(this),i=o.outerWidth(),a=o.outerHeight();n.sizes[t]=[i,a],i>n.max[0]&&(n.max[0]=i),a>n.max[1]&&(n.max[1]=a)},this.setup=function(){if(this.el.css({overflow:"hidden",width:n.max[0],height:this.items.first().outerHeight()}),this.ul.css({width:100*this.items.length+"%",position:"relative"}),this.items.css("width",100/this.items.length+"%"),this.opts.delay!==t&&(this.start(),this.el.hover(this.stop,this.start)),this.opts.keys&&e(document).keydown(this.keys),this.opts.dots&&this.dots(),this.opts.fluid){var o=function(){n.el.css("width",Math.min(Math.round(n.el.outerWidth()/n.el.parent().outerWidth()*100),100)+"%")};o(),e(window).resize(o)}this.opts.arrows&&this.el.parent().append('<p class="arrows"><span class="prev">â†</span><span class="next">â†’</span></p>').find(".arrows span").click(function(){e.isFunction(n[this.className])&&n[this.className]()}),e.event.swipe&&this.el.on("swipeleft",n.prev).on("swiperight",n.next)},this.move=function(t,o){this.items.eq(t).length||(t=0),0>t&&(t=this.items.length-1);var i=this.items.eq(t),a={height:i.outerHeight()},s=o?5:this.opts.speed;this.ul.is(":animated")||(n.el.find(".dot:eq("+t+")").addClass("active").siblings().removeClass("active"),this.el.animate(a,s)&&this.ul.animate(e.extend({left:"-"+t+"00%"},a),s,function(i){n.current=t,e.isFunction(n.opts.complete)&&!o&&n.opts.complete(n.el)}))},this.start=function(){n.interval=setInterval(function(){n.move(n.current+1)},n.opts.delay)},this.stop=function(){return n.interval=clearInterval(n.interval),n},this.keys=function(t){var o=t.which,i={37:n.prev,39:n.next,27:n.stop};e.isFunction(i[o])&&i[o]()},this.next=function(){return n.stop().move(n.current+1)},this.prev=function(){return n.stop().move(n.current-1)},this.dots=function(){var t='<ol class="dots">';e.each(this.items,function(e){t+='<li class="dot'+(1>e?" active":"")+'">'+(e+1)+"</li>"}),t+="</ol>",this.el.addClass("has-dots").append(t).find(".dot").click(function(){n.move(e(this).index())})}};e.fn.unslider=function(t){var o=this.length;return this.each(function(i){var a=e(this),s=(new n).init(a,t);a.data("unslider"+(o>1?"-"+(i+1):""),s)})}}(window.jQuery,!1),function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],o=document.createEvent("MouseEvents");o.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(o)}}if(e.support.touch="ontouchend"in document,e.support.touch){var n,o=e.ui.mouse.prototype,i=o._mouseInit,a=o._mouseDestroy;o._touchStart=function(e){var o=this;!n&&o._mouseCapture(e.originalEvent.changedTouches[0])&&(n=!0,o._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},o._touchMove=function(e){n&&(this._touchMoved=!0,t(e,"mousemove"))},o._touchEnd=function(e){n&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),n=!1)},o._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),i.call(t)},o._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),a.call(t)}}}(jQuery),function(e){e.widget("ui.tagit",{options:{allowDuplicates:!1,caseSensitive:!0,fieldName:"tags",placeholderText:null,readOnly:!1,removeConfirmation:!1,tagLimit:null,availableTags:[],autocomplete:{},showAutocompleteOnFocus:!1,allowSpaces:!1,singleField:!1,singleFieldDelimiter:",",singleFieldNode:null,animate:!0,tabIndex:null,beforeTagAdded:null,afterTagAdded:null,beforeTagRemoved:null,afterTagRemoved:null,onTagClicked:null,onTagLimitExceeded:null,onTagAdded:null,onTagRemoved:null,tagSource:null},_create:function(){var t=this;this.element.is("input")?(this.tagList=e("<ul></ul>").insertAfter(this.element),this.options.singleField=!0,this.options.singleFieldNode=this.element,this.element.addClass("tagit-hidden-field")):this.tagList=this.element.find("ul, ol").andSelf().last(),this.tagInput=e('<input type="text" />').addClass("ui-widget-content"),this.options.readOnly&&this.tagInput.attr("disabled","disabled"),this.options.tabIndex&&this.tagInput.attr("tabindex",this.options.tabIndex),this.options.placeholderText&&this.tagInput.attr("placeholder",this.options.placeholderText),this.options.autocomplete.source||(this.options.autocomplete.source=function(t,n){var o=t.term.toLowerCase(),i=e.grep(this.options.availableTags,function(e){return 0===e.toLowerCase().indexOf(o)});this.options.allowDuplicates||(i=this._subtractArray(i,this.assignedTags())),n(i)}),this.options.showAutocompleteOnFocus&&(this.tagInput.focus(function(e,n){t._showAutocomplete()}),"undefined"==typeof this.options.autocomplete.minLength&&(this.options.autocomplete.minLength=0)),e.isFunction(this.options.autocomplete.source)&&(this.options.autocomplete.source=e.proxy(this.options.autocomplete.source,this)),e.isFunction(this.options.tagSource)&&(this.options.tagSource=e.proxy(this.options.tagSource,this)),this.tagList.addClass("tagit").addClass("ui-widget ui-widget-content ui-corner-all").append(e('<li class="tagit-new"></li>').append(this.tagInput)).click(function(n){var o=e(n.target);if(o.hasClass("tagit-label")){var i=o.closest(".tagit-choice");i.hasClass("removed")||t._trigger("onTagClicked",n,{tag:i,tagLabel:t.tagLabel(i)})}else t.tagInput.focus()});var n=!1;if(this.options.singleField)if(this.options.singleFieldNode){var o=e(this.options.singleFieldNode),i=o.val().split(this.options.singleFieldDelimiter);o.val(""),e.each(i,function(e,o){t.createTag(o,null,!0),n=!0})}else this.options.singleFieldNode=e('<input type="hidden" style="display:none;" value="" name="'+this.options.fieldName+'" />'),this.tagList.after(this.options.singleFieldNode);if(n||this.tagList.children("li").each(function(){e(this).hasClass("tagit-new")||(t.createTag(e(this).text(),e(this).attr("class"),!0),e(this).remove())}),this.tagInput.keydown(function(n){if(n.which==e.ui.keyCode.BACKSPACE&&""===t.tagInput.val()){var o=t._lastTag();!t.options.removeConfirmation||o.hasClass("remove")?t.removeTag(o):t.options.removeConfirmation&&o.addClass("remove ui-state-highlight")}else t.options.removeConfirmation&&t._lastTag().removeClass("remove ui-state-highlight");(n.which===e.ui.keyCode.COMMA&&n.shiftKey===!1||n.which===e.ui.keyCode.ENTER||n.which==e.ui.keyCode.TAB&&""!==t.tagInput.val()||n.which==e.ui.keyCode.SPACE&&t.options.allowSpaces!==!0&&('"'!=e.trim(t.tagInput.val()).replace(/^s*/,"").charAt(0)||'"'==e.trim(t.tagInput.val()).charAt(0)&&'"'==e.trim(t.tagInput.val()).charAt(e.trim(t.tagInput.val()).length-1)&&e.trim(t.tagInput.val()).length-1!==0))&&((n.which!==e.ui.keyCode.ENTER||""!==t.tagInput.val())&&n.preventDefault(),t.options.autocomplete.autoFocus&&t.tagInput.data("autocomplete-open")||(t.tagInput.autocomplete("close"),t.createTag(t._cleanedInput())))}).blur(function(e){t.tagInput.data("autocomplete-open")||t.createTag(t._cleanedInput())}),this.options.availableTags||this.options.tagSource||this.options.autocomplete.source){var a={select:function(e,n){return t.createTag(n.item.value),!1}};e.extend(a,this.options.autocomplete),a.source=this.options.tagSource||a.source,this.tagInput.autocomplete(a).bind("autocompleteopen.tagit",function(e,n){t.tagInput.data("autocomplete-open",!0)}).bind("autocompleteclose.tagit",function(e,n){t.tagInput.data("autocomplete-open",!1)}),this.tagInput.autocomplete("widget").addClass("tagit-autocomplete")}},destroy:function(){return e.Widget.prototype.destroy.call(this),this.element.unbind(".tagit"),this.tagList.unbind(".tagit"),this.tagInput.removeData("autocomplete-open"),this.tagList.removeClass(["tagit","ui-widget","ui-widget-content","ui-corner-all","tagit-hidden-field"].join(" ")),this.element.is("input")?(this.element.removeClass("tagit-hidden-field"),this.tagList.remove()):(this.element.children("li").each(function(){e(this).hasClass("tagit-new")?e(this).remove():(e(this).removeClass(["tagit-choice","ui-widget-content","ui-state-default","ui-state-highlight","ui-corner-all","remove","tagit-choice-editable","tagit-choice-read-only"].join(" ")),e(this).text(e(this).children(".tagit-label").text()))}),this.singleFieldNode&&this.singleFieldNode.remove()),this},_cleanedInput:function(){return e.trim(this.tagInput.val().replace(/^"(.*)"$/,"$1"))},_lastTag:function(){return this.tagList.find(".tagit-choice:last:not(.removed)")},_tags:function(){return this.tagList.find(".tagit-choice:not(.removed)")},assignedTags:function(){var t=this,n=[];return this.options.singleField?(n=e(this.options.singleFieldNode).val().split(this.options.singleFieldDelimiter),""===n[0]&&(n=[])):this._tags().each(function(){n.push(t.tagLabel(this))}),n},_updateSingleTagsField:function(t){e(this.options.singleFieldNode).val(t.join(this.options.singleFieldDelimiter)).trigger("change")},_subtractArray:function(t,n){for(var o=[],i=0;i<t.length;i++)-1==e.inArray(t[i],n)&&o.push(t[i]);return o},tagLabel:function(t){return this.options.singleField?e(t).find(".tagit-label:first").text():e(t).find("input:first").val()},_showAutocomplete:function(){this.tagInput.autocomplete("search","")},_findTagByLabel:function(t){var n=this,o=null;return this._tags().each(function(i){return n._formatStr(t)==n._formatStr(n.tagLabel(this))?(o=e(this),!1):void 0}),o},_isNew:function(e){return!this._findTagByLabel(e)},_formatStr:function(t){return this.options.caseSensitive?t:e.trim(t.toLowerCase())},_effectExists:function(t){return Boolean(e.effects&&(e.effects[t]||e.effects.effect&&e.effects.effect[t]))},createTag:function(t,n,o){var i=this;if(t=e.trim(t),this.options.preprocessTag&&(t=this.options.preprocessTag(t)),""===t)return!1;if(!this.options.allowDuplicates&&!this._isNew(t)){var a=this._findTagByLabel(t);return this._trigger("onTagExists",null,{existingTag:a,duringInitialization:o})!==!1&&this._effectExists("highlight")&&a.effect("highlight"),!1}if(this.options.tagLimit&&this._tags().length>=this.options.tagLimit)return this._trigger("onTagLimitExceeded",null,{duringInitialization:o}),!1;var s=e(this.options.onTagClicked?'<a class="tagit-label"></a>':'<span class="tagit-label"></span>').text(t),r=e("<li></li>").addClass("tagit-choice ui-widget-content ui-state-default ui-corner-all").addClass(n).append(s);if(this.options.readOnly)r.addClass("tagit-choice-read-only");else{r.addClass("tagit-choice-editable");var l=e("<span></span>").addClass("ui-icon ui-icon-close"),c=e('<a><span class="text-icon">×</span></a>').addClass("tagit-close").append(l).click(function(e){i.removeTag(r)});r.append(c)}if(!this.options.singleField){var d=s.html();r.append('<input type="hidden" value="'+d+'" name="'+this.options.fieldName+'" class="tagit-hidden-field" />')}if(this._trigger("beforeTagAdded",null,{tag:r,tagLabel:this.tagLabel(r),duringInitialization:o})!==!1){if(this.options.singleField){var u=this.assignedTags();u.push(t),this._updateSingleTagsField(u)}this._trigger("onTagAdded",null,r),this.tagInput.val(""),this.tagInput.parent().before(r),this._trigger("afterTagAdded",null,{tag:r,tagLabel:this.tagLabel(r),duringInitialization:o}),this.options.showAutocompleteOnFocus&&!o&&setTimeout(function(){i._showAutocomplete()},0)}},removeTag:function(t,n){if(n="undefined"==typeof n?this.options.animate:n,t=e(t),this._trigger("onTagRemoved",null,t),this._trigger("beforeTagRemoved",null,{tag:t,tagLabel:this.tagLabel(t)})!==!1){if(this.options.singleField){var o=this.assignedTags(),i=this.tagLabel(t);o=e.grep(o,function(e){return e!=i}),this._updateSingleTagsField(o)}if(n){t.addClass("removed");var a=this._effectExists("blind")?["blind",{direction:"horizontal"},"fast"]:["fast"],s=this;a.push(function(){t.remove(),s._trigger("afterTagRemoved",null,{tag:t,tagLabel:s.tagLabel(t)})}),t.fadeOut("fast").hide.apply(t,a).dequeue()}else t.remove(),this._trigger("afterTagRemoved",null,{tag:t,tagLabel:this.tagLabel(t)})}},removeTagByLabel:function(e,t){var n=this._findTagByLabel(e);if(!n)throw"No such tag exists with the name '"+e+"'";this.removeTag(n,t)},removeAll:function(){var e=this;this._tags().each(function(t,n){e.removeTag(n,!1)})}})}(jQuery),jQuery(document).ready(function(e){function t(e){if(e)if(window.getSelection){var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}else document.selection&&e.select&&e.select()}var n=lasso_editor.editor,o=lasso_editor.strings,i=lasso_editor.settingsLink,a=lasso_editor.article_object,s=lasso_editor.toolbar,r=lasso_editor.toolbarHeadings,l=lasso_editor.component_sidebar,c=(lasso_editor.postid,lasso_editor.component_modal,lasso_editor.components),d=lasso_editor.featImgClass,u=(lasso_editor.featImgNonce,lasso_editor.titleClass),f=lasso_editor.featImgControls,p=lasso_editor.wpImgEdit,h=lasso_editor.handle,m=(lasso_editor.mapFormFooter,lasso_editor.mapLocations),g=lasso_editor.mapZoom,v=lasso_editor.mapStart,y=lasso_editor.objectsNoSave,b=lasso_editor.supportedNoSave;e("#lasso--edit").click(function(C){function w(){e("body").removeClass("lasso-sidebar-open lasso-editing"),e(".lasso--toolbar_wrap, #lasso--sidebar, #lasso--featImgControls, #lasso--wpimg-edit, #lasso--exit").fadeOut().remove(),e("#lasso--edit").css("opacity",1),e(".lasso--controls__right").css("opacity",0),e(a).attr("id",""),e(".lasso--wpimg__wrap").each(function(){e(this).children().unwrap()}),e("#lasso--map-form").each(function(){var t=e(this);t.find(".lasso-component--controls, .lasso--map-form__footer ").remove(),t.children().unwrap()}),e(u).attr("contenteditable",!1),articleMedium.destroy()}if(0==e(a).length&&(a=".entry-content",0==e(a).length))return void swal({title:o.warning,type:"info",text:o.missingClass,showCancelButton:!0,cancelButtonText:o.cancelText,confirmButtonColor:"#007aab",confirmButtonText:o.missingConfirm,closeOnConfirm:!1},function(){
location.replace(i)});C.preventDefault(),e("body").toggleClass("lasso-editing"),e(a).attr("id",n),e(s).hide().appendTo("body").fadeIn(300),e(".lasso--controls__right").css("opacity",1),e("#"+n).attr("contenteditable",!0),e("body").append(l),e(d).length>0&&e(d).append(f),e(u).length>0?e(u).attr("contenteditable",!0):(u=".entry-header",e(u).length>0&&e(u).attr("contenteditable",!0)),e(".scroll-nav__section").each(function(){e(this).children().unwrap()}),e(".lasso--controls__right ").prepend('<a title="Exit Editor" id="lasso--exit" href="#"></a>'),e(".aesop-component").each(function(){if(!e(".lasso-component--toolbar").length>0)if(e(this).hasClass("aesop-map-component")){var t=e(this);t.wrap('<div id="lasso--map-form" class="aesop-component aesop-map-component lasso--map-drag-holder" data-component-type="map" >').before(h)}else e(this).append(h)}),e("[class*='wp-image-']").each(function(){var t=e(this);!e(".lasso--wpimg-edit").length>0&&(t.parent().hasClass("wp-caption")?t.parent().addClass("lasso--wpimg__wrap"):t.wrap('<div data-component-type="wpimg" class="lasso--wpimg__wrap lasso-component">'),t.parent().prepend(p))}),e(".lasso-component:not(.lasso--wpimg__wrap)").each(function(){e(this);!e(".lasso-component--toolbar").length>0&&e(this).append(h)}),e(y).remove(),e(b).remove(),article=document.getElementById(n),articleMedium=new Medium({element:article,mode:Medium.richMode,attributes:null,tags:null,placeholder:lasso_editor.strings.justWrite,pasteAsText:!0,cssClasses:{editor:"lasso-editor",pasteHook:"lasso-editor-paste-hook",placeholder:"lasso-editor-placeholder",clear:"lasso-editor-clear"}}),document.execCommand("defaultParagraphSeparator",!1,"p"),article.highlight=function(){return document.activeElement===article?!1:void articleMedium.select()},document.getElementById("lasso-toolbar--bold").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("b"),!1},document.getElementById("lasso-toolbar--underline").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("u"),!1},document.getElementById("lasso-toolbar--italic").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("i"),!1},r&&(document.getElementById("lasso-toolbar--h2").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("h2"),!1},document.getElementById("lasso-toolbar--h3").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("h3"),!1}),document.getElementById("lasso-toolbar--strike").onmousedown=function(){return article.highlight(),articleMedium.invokeElement("strike"),!1},document.getElementById("lasso-toolbar--link__create").onmousedown=function(){t(window.selRange),articleMedium.insertHtml('<a class="lasso-link" href="'+e("#lasso-toolbar--link__inner").text()+'">'+window.selRange+"</a>");var n=window.selRange.startContainer.parentNode,o=n.localName;if("a"==o){var i=e(window.selRange.startContainer.parentNode);i.replaceWith(i[0].innerHTML)}return window.selRange=null,e("#lasso-toolbar--link").removeClass("link--drop-up"),!1},document.getElementById("lasso-toolbar--html__insert").onmousedown=function(){t(window.selRange);var n,o=window.selRange.startContainer;if(n=o.localName,"p"==n){var i=e(o),a=e("#lasso-toolbar--html__inner").text();a=e(a),a.insertAfter(i),i.remove()}else if(o=o.parentNode,n=o.localName,"p"==n){var i=e(o),a=e("#lasso-toolbar--html__inner").text();a=e(a),a.insertAfter(i)}else articleMedium.insertHtml(e("#lasso-toolbar--html__inner").text());return window.selRange=null,e("#lasso-toolbar--html").removeClass("html--drop-up"),!1},e(document).keyup(function(e){27==e.keyCode&&w()}),e("#lasso--exit").live("click",function(e){e.preventDefault(),w()}),e(document).keydown(function(t){return"115"!=t.which&&"83"!=t.which||!t.ctrlKey&&!t.metaKey?!0:(t.preventDefault(),e(".lasso-editing #lasso--save").trigger("click"),!1)});var _=function(){!e(".aesop-timeline").length>0&&e("body").append('<div class="aesop-timeline"></div>').addClass("has-timeline"),!e(".aesop-timeline .scroll-nav").length>0&&(e(".aesop-entry-content").scrollNav({sections:".aesop-timeline-stop",arrowKeys:!0,insertTarget:".aesop-timeline",insertLocation:"appendTo",showTopLink:!1,showHeadline:!1,scrollOffset:0}),e(".aesop-timeline-stop").each(function(){var t=e(this).attr("data-title");e(this).text(t).append(h)}))},E=function(){e(".aesop-video-component").fitVids()},R=v?v:[29.76,-95.38],T=g?g:12,N=lasso_editor.mapTileProvider,x=function(){function e(e,t){var n=f(e,t);jQuery('input[name="ase-map-component-start-point"]').remove(),jQuery(".lasso--map-form__footer").append('<input type="hidden" name="ase-map-component-start-point" data-ase="map" value="'+n+'">'),jQuery("#lasso-map-address").val(e+", "+t)}function t(e){jQuery('input[name="ase-map-component-zoom"]').remove(),jQuery(".lasso--map-form__footer").append('<input type="hidden" name="ase-map-component-zoom" data-ase="map" value="'+e+'">')}function n(e){d(e.target)}function o(t){var n=t.target.getCenter();e(a(n.lat),a(n.lng))}function i(e){t(e.target.getZoom())}function a(e){return Math.round(100*e)/100}function s(e){var t,o={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[e.latlng.lat,e.latlng.lng]}};L.geoJson(o,{pointToLayer:function(o,i){return t=L.marker(e.latlng,{title:"Resource Location",alt:"Resource Location",riseOnHover:!0,draggable:!0}).bindPopup("			            	<input type='text' name='ase_marker_text[]' value='Location Title'>			            	<a class='marker-update-button dashicons dashicons-yes'/></a>			            	<a class='marker-delete-button dashicons dashicons-trash'/></a>			            	"),t.on("popupopen",r),t.on("dragend",n),t}}).addTo(g),c(t._leaflet_id,u(e.latlng.lat,e.latlng.lng,"Location Title"))}function r(){var e=this;jQuery(".marker-delete-button:visible").click(function(){jQuery('input[data-marker="'+e._leaflet_id+'"]').remove(),g.removeLayer(e)}),jQuery(".marker-update-button:visible").click(function(t){var n=t.target.previousElementSibling.value,o=u(e._latlng.lat,e._latlng.lng,n);jQuery('input[data-marker="'+e._leaflet_id+'"]').val(o),e.options.title=n,e.closePopup(),e.bindPopup("				            	<input type='text' name='ase_marker_text[]' value='"+n+"'>				            	<a class='marker-update-button dashicons dashicons-yes'/></a>				            	<a class='marker-delete-button dashicons dashicons-trash'/></a>				            	")})}function l(e,t){return marker=L.marker(e,{title:t,alt:t,riseOnHover:!0,draggable:!0}).bindPopup("	            	<input type='text' name='ase_marker_text[]' value='"+t+"'>	            	<a class='marker-update-button dashicons dashicons-yes'/></a>	            	<a class='marker-delete-button dashicons dashicons-trash'/></a>	            	"),marker.on("popupopen",r),marker.on("dragend",n),marker}function c(e,t){jQuery(".lasso--map-form__footer").append('<input type="hidden" name="ase-map-component-locations[]" data-ase="map" data-marker="'+e+'" value="'+t+'">')}function d(e){var t=u(e._latlng.lat,e._latlng.lng,e.options.title);jQuery('input[data-marker="'+e._leaflet_id+'"]').val(t)}function u(e,t,n){return encodeURIComponent(JSON.stringify({lat:e,lng:t,title:n}))}function f(e,t){return encodeURIComponent(JSON.stringify({lat:e,lng:t}))}var p=R.lat?R.lat:29.76,h=R.lng?R.lng:-95.38,g=L.map("aesop-map-component",{scrollWheelZoom:!1,zoom:T,center:[p,h]});e(R[0],R[1]),jQuery("#lasso-map-address").geocomplete().bind("geocode:result",function(t,n){var o=n.geometry.location.k,i=n.geometry.location.B;g.panTo(new L.LatLng(o,i)),e(o,i)}),L.tileLayer(N,{maxZoom:T}).addTo(g),m.forEach(function(e){l([e.lat,e.lng],e.title).addTo(g),c(marker._leaflet_id,u(e.lat,e.lng,e.title))}),g.on("click",s),g.on("dragend",o),g.on("zoomend",i)};e("#"+n).sortable({opacity:.65,placeholder:"lasso-drop-zone",handle:".lasso-drag",cursor:"move",tolerance:"pointer",refreshPositions:!0,helper:function(t,n){var o=n.context,i=e(o).attr("data-component-type");return e('<div class="lasso-drag-holder lasso-toolbar--component__'+i+'"></div>')},beforeStop:function(e,t){draggedItem=t.item},receive:function(){e("#lasso-toolbar--components").removeClass("toolbar--drop-up");var t=draggedItem.context,n=e(t).attr("data-type");"draggable"==origin&&("wpimg"==n?e(t).replaceWith(e(c[n].content).prepend(p)):e(t).replaceWith(e(c[n].content).prepend(h).attr({"data-component-type":n})),"map"==n&&x(),"timeline_stop"==n&&_(),"video"==n&&E())}}),e("#lasso-toolbar--components__list li").draggable({axis:"y",helper:"clone",cursor:"move",connectToSortable:"#"+n,start:function(t){origin="draggable";var n=t.currentTarget,o=e(n).attr("data-type");e(this).addClass(o)}})})}),function(e){e(document).ready(function(){var t=function(){e("body").removeClass("lasso-modal-open"),e("#lasso--post-settings__modal, #lasso--modal__overlay").remove()};e("#lasso--post-settings").live("click",function(t){t.preventDefault(),e("body").toggleClass("lasso-modal-open"),e("body").append(lasso_editor.component_modal);var n=function(e){var t;return 100==e?t="draft":200==e?t="publish":"draft"==e?t=100:"publish"==e&&(t=200),t};e("#lasso--slider").slider({value:n(lasso_editor.post_status),min:100,max:200,step:100,animate:"fast",slide:function(t,o){e('input[name="status"]').val(n(o.value)),e(".lasso--postsettings__footer").slideDown(),100==o.value?e(".story-status").removeClass("story-status-publish").addClass("story-status-draft"):200==o.value&&e(".story-status").removeClass("story-status-draft").addClass("story-status-publish")}}),e('input[name="status"]').val(n(e("#lasso--slider").slider("value"))),e(".lasso--modal__trigger-footer").on("keyup",function(){e(".lasso--postsettings__footer").slideDown()});var o=e("#lasso--cat-select"),i=e("#lasso--tag-select");o.tagit({placeholderText:"search categories...",availableTags:lasso_editor.postCategories}),o.on("change",function(t){e(".lasso--postsettings__footer").slideDown()}),i.tagit({placeholderText:"search tags...",availableTags:lasso_editor.postTags}),i.on("change",function(t){e(".lasso--postsettings__footer").slideDown()}),modalResizer()}),e("#lasso--modal__close, #lasso--modal__overlay, .lasso--postsettings-cancel").live("click",function(e){e.preventDefault(),t()}),e(document).keyup(function(e){27==e.keyCode&&t()});e("#lasso--postsettings__form").live("submit",function(t){t.preventDefault();var n=e(this);e(this).find('input[type="submit"]').val(lasso_editor.strings.saving);var o=n.serialize();e.post(lasso_editor.ajaxurl,o,function(t){console.log(t),1==t.success?(e('input[type="submit"]').addClass("saved"),e('input[type="submit"]').val(lasso_editor.strings.saved),location.reload(),window.location.replace(lasso_editor.permalink)):(alert("error"),console.log(t))})}),e(document).on("click",".lasso--modal__tabs li",function(t){t.preventDefault();var n=e(this),o=n.data("addon-name"),i="not-visible",a="visible";e(".lasso--modal__tabs li").removeClass("active-tab"),n.addClass("active-tab"),e(".lasso--modal__content").removeClass(a).addClass(i),n.closest(".lasso--modal__inner").find('div[data-addon-content="'+o+'"]').removeClass(i).addClass(a),modalResizer()})})}(jQuery),function(e){e(document).ready(function(){var t=function(){e("body").removeClass("lasso-sidebar-open")};e("body").on("click","#"+lasso_editor.editor,function(){t()});var n,o=function(){var t=e("#lasso--component__settings");t.height(e(window).height()),e(window).resize(function(){t.height(e(window).height())})};e(document).on("click","#lasso-component--settings__trigger",function(){var t=e("#lasso--component__settings");e(this);if(n=e(this).parent().parent().hasClass("aesop-map-component")?e(this).parent().parent().find(".aesop-component"):e(this).closest(".aesop-component"),window.component=n,c=n.data(),e("body").toggleClass("lasso-sidebar-open"),t.find('input[name="unique"]').val(c.unique),o(),t.html(lasso_editor.component_options[c.componentType]),t.find(".component_type").val(c.componentType),e(".lasso-buttoninsert-wrap").fadeIn(600),t.perfectScrollbar("destroy"),t.perfectScrollbar(),t.find(".lasso-option").each(function(){var t=e(this).data("option"),n=e(this).find(".lasso-generator-attr");if("gallery-type"==t){var o=function(t){"grid"==t?(e(".ase-gallery-opts--thumb").fadeOut(),e(".ase-gallery-opts--photoset").fadeOut(),e(".ase-gallery-opts--grid").fadeIn()):e(".ase-gallery-opts--grid").fadeOut(),"thumbnail"==t?(e(".ase-gallery-opts--grid").fadeOut(),e(".ase-gallery-opts--photoset").fadeOut(),e(".ase-gallery-opts--thumb").fadeIn()):e(".ase-gallery-opts--thumb").fadeOut(),"photoset"==t?(e(".ase-gallery-opts--grid").fadeOut(),e(".ase-gallery-opts--thumb").fadeOut(),e(".ase-gallery-opts--photoset").fadeIn()):e(".ase-gallery-opts--photoset").fadeOut()};e(n).each(function(){e(this).val()==c.galleryType&&(e(this).parent().addClass("selected"),e(this).prop("checked",!0),o(e(this).val()),e("#ase_gallery_type").val(e(this).val()))})}else e(n[0]).val(c[t])}),n.hasClass("aesop-content-component"))var i=n.find(".aesop-content-comp-wrap").attr("id"),a=e("#"+i);else var a=e("#"+n.attr("id"));if(e("html, body").animate({scrollTop:a.length?a.offset().top-50:!1},400),e(this).parent().parent().hasClass("empty-gallery")&&t.addClass("gallery-no-images"),e(this).parent().parent().hasClass("aesop-gallery-component")){var s=(e(this),lasso_editor.ajaxurl),r=(e("#lasso--component-settings-form.gallery"),lasso_editor.getGallImgNonce),l=c.id,c={action:"process_gallery_get-images",post_id:l,nonce:r};e.post(s,c,function(t){e("#lasso--gallery__images").html(t.data.html);var n=e("#ase-gallery-images");n.ready(function(){n.sortable({containment:"parent",cursor:"move",opacity:.8,placeholder:"ase-gallery-drop-zone",forcePlaceholderSize:!0,update:function(){var t=e(this).sortable("toArray");e("#ase_gallery_ids").val(t)},create:function(){var t=e(this).sortable("toArray");e("#ase_gallery_ids").val(t)}})})})}}).on("click","#lasso-upload-img",function(t){t.preventDefault(),className=t.currentTarget.parentElement.className;var o=e('input[name="component_type"]').val();"undefined"!=typeof lasso_file_frame&&lasso_file_frame.close(),lasso_file_frame=wp.media.frames.file_frame=wp.media({title:"Select Image",button:{text:"Insert Image"},multiple:!1}),lasso_file_frame.on("select",function(){var t=lasso_file_frame.state().get("selection").first().toJSON();e(".lasso-generator-attr-media_upload").attr("value",t.url),"parallax"==o?n.find(".aesop-parallax-sc-img").attr("src",t.url):"quote"==o?n.css({"background-image":"url("+t.url+")"}):"image"==o?n.find(".aesop-image-component-image > img").attr("src",t.url):"character"==o?n.find(".aesop-character-avatar").attr("src",t.url):"chapter"==o&&n.find(".aesop-article-chapter").css({"background-image":"url("+t.url+")"})}),lasso_file_frame.open()}),e("#lasso--sidebar__close").live("click",function(n){n.preventDefault(),t(),e("#lasso--component__settings").perfectScrollbar("destroy")})})}(jQuery),function(e){e(document).ready(function(){function t(t,n,o){t.find(".lasso-video-id > #lasso-generator-attr-id").live("change",function(){video_id=e(this).val(),"vimeo"==o?n.find("iframe").attr("src","//player.vimeo.com/video/"+video_id+" "):"youtube"==o&&n.find("iframe").attr("src","//www.youtube.com/embed/"+video_id+"?rel=0&wmode=transparent")})}e(document).on("click","#lasso-component--settings__trigger",function(){var n=e("#lasso--component__settings");n.find("#lasso-generator-attr-background").live("change",function(){component.css({"background-color":e(this).val()})}),n.find("#lasso-generator-attr-text").live("change",function(){component.css({color:e(this).val()})}),n.find("#lasso-generator-attr-quote").on("keyup",function(){component.find("blockquote span").text(e(this).val())}),n.find("#lasso-generator-attr-cite").on("keyup",function(){var t=component.find("blockquote cite");0==t.length?component.find("blockquote").append('<cite class="aesop-quote-component-cite">'+e(this).val()+"</cite>"):component.find("blockquote cite").text(e(this).val())}),n.find(".lasso-quote-width > #lasso-generator-attr-width").on("keyup",function(){component.css("width",e(this).val())}),n.find(".lasso-quote-type #lasso-generator-attr-type").on("change",function(){var t=e(this).val();"pull"==t&&component.css("background-color","transparent"),component.removeClass("aesop-quote-type-block aesop-quote-type-pull"),component.addClass("aesop-quote-type-"+e(this).val()+" ")}),n.find(".lasso-quote-align #lasso-generator-attr-align").on("change",function(){var t=e(this).val();"left"==t?(component.removeClass("aesop-component-align-right aesop-component-align-center"),component.find("blockquote").removeClass("aesop-component-align-right aesop-component-align-center")):"right"==t?(component.removeClass("aesop-component-align-left aesop-component-align-center"),component.find("blockquote").removeClass("aesop-component-align-left aesop-component-align-center")):"center"==t&&(component.removeClass("aesop-component-align-left aesop-component-align-right"),component.find("blockquote").removeClass("aesop-component-align-left aesop-component-align-right")),component.addClass("aesop-component-align-"+e(this).val()+" "),component.find("blockquote").addClass("aesop-component-align-"+e(this).val()+" ")}),n.find(".lasso-parallax-caption > #lasso-generator-attr-caption").on("keyup",function(){var t=component.find(".aesop-parallax-sc-caption-wrap");0==t.length?component.find("img").after('<figcaption class="aesop-parallax-sc-caption-wrap bottom-left">'+e(this).val()+"</figcaption>"):component.find(".aesop-parallax-sc-caption-wrap").text(e(this).val())}),n.find(".lasso-parallax-captionposition > #lasso-generator-attr-captionposition").on("change",function(){var t=e(this).val();"bottom-left"==t?component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-right top-left top-right"):"bottom-right"==t?component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-left top-left top-right"):"top-left"==t?component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-right top-right bottom-left"):"top-right"==t&&component.find(".aesop-parallax-sc-caption-wrap").removeClass("bottom-right bottom-left top-left"),component.find(".aesop-parallax-sc-caption-wrap").addClass(t)}),n.find(".lasso-image-caption > #lasso-generator-attr-caption").on("keyup",function(){var t=component.find(".aesop-image-component-caption");0==t.length?component.find("img").after('<p class="aesop-image-component-caption">'+e(this).val()+"</p>"):component.find(".aesop-image-component-caption").text(e(this).val())}),n.find(".lasso-image-imgwidth > #lasso-generator-attr-imgwidth").on("keyup",function(){component.find(".aesop-image-component-image").css("max-width",e(this).val())}),n.find(".lasso-image-align > #lasso-generator-attr-align").on("change",function(){var t=e(this).val();"left"==t?component.find(".aesop-image-component-image").removeClass("aesop-component-align-right aesop-component-align-center"):"right"==t?component.find(".aesop-image-component-image").removeClass("aesop-component-align-left aesop-component-align-center"):"center"==t&&component.find(".aesop-image-component-image").removeClass("aesop-component-align-left aesop-component-align-right"),component.find(".aesop-image-component-image").addClass("aesop-component-align-"+e(this).val()+" ")}),n.find(".lasso-image-captionposition > #lasso-generator-attr-captionposition").on("change",function(){var t=e(this).val();"left"==t?component.find(".aesop-image-component-image").removeClass("aesop-image-component-caption-right aesop-image-component-caption-center"):"right"==t?component.find(".aesop-image-component-image").removeClass("aesop-image-component-caption-left aesop-image-component-caption-center"):"center"==t&&component.find(".aesop-image-component-image").removeClass("aesop-image-component-caption-left aesop-image-component-caption-right"),component.find(".lasso-image-component-image").addClass("lasso-image-component-caption-"+t+" ")}),n.find(".lasso-image-offset > #lasso-generator-attr-offset").on("keyup",function(){e(this).val();component.find(".aesop-image-component-image").hasClass("aesop-component-align-left")?component.find(".aesop-image-component-image").css("margin-left",e(this).val()):component.find(".aesop-image-component-image").css("margin-right",e(this).val())}),n.find(".lasso-character-name > #lasso-generator-attr-name").on("keyup",function(){component.find(".aesop-character-title").text(e(this).val())}),n.find(".lasso-character-caption > #lasso-generator-attr-caption").on("keyup",function(){component.find(".aesop-character-cap").text(e(this).val())}),n.find(".lasso-character-align > #lasso-generator-attr-align").on("change",function(){var t=e(this).val();"left"==t?component.removeClass("aesop-component-align-right aesop-component-align-center"):"center"==t&&component.removeClass("aesop-component-align-left aesop-component-align-right"),component.addClass("aesop-component-align-"+e(this).val()+" ")}),n.find(".lasso-chapter-title > #lasso-generator-attr-title").on("keyup",function(){component.find(".aesop-cover-title span").text(e(this).val())}),n.find(".lasso-chapter-subtitle > #lasso-generator-attr-subtitle").on("keyup",function(){component.find(".aesop-cover-title small").text(e(this).val())}),n.find(".lasso-video-src > #lasso-generator-attr-src").live("change blur",function(){val=e(this).val(),"vimeo"==val?(component.find("iframe").attr("src","//player.vimeo.com/video/"+val+" "),t(n,component,"vimeo")):"youtube"==val&&(component.find("iframe").attr("src","//www.youtube.com/embed/"+val+"?rel=0&wmode=transparent"),t(n,component,"youtube"))}),n.find(".lasso-video-width > #lasso-generator-attr-width").on("keyup",function(){component.find(".aesop-video-container").css("max-width",e(this).val())}),n.find(".lasso-content-background > #lasso-generator-attr-background").live("change",function(){component.find(".aesop-content-comp-wrap").css({"background-color":e(this).val()})}),n.find(".lasso-content-color > #lasso-generator-attr-color").live("change",function(){component.find(".aesop-content-comp-wrap").css({color:e(this).val()})}),n.find(".lasso-content-height > #lasso-generator-attr-height").live("keyup",function(){val=e(this).val(),component.find(".aesop-content-comp-wrap").css({"min-height":e(this).val()})}),n.find(".lasso-content-columns > #lasso-generator-attr-columns").live("change",function(){val=e(this).val(),"1"==val?component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-2 aesop-content-comp-columns-3 aesop-content-comp-columns-4").addClass("aesop-content-comp-columns-1"):"2"==val?component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-1 aesop-content-comp-columns-3 aesop-content-comp-columns-4").addClass("aesop-content-comp-columns-2"):"3"==val?component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-1 aesop-content-comp-columns-2 aesop-content-comp-columns-4").addClass("aesop-content-comp-columns-3"):"4"==val&&component.find(".aesop-content-comp-wrap").removeClass("aesop-content-comp-columns-1 aesop-content-comp-columns-2 aesop-content-comp-columns-3").addClass("aesop-content-comp-columns-4")})})})}(jQuery),jQuery(function(e){function t(){if(window.getSelection){if(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount)return sel.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null}function n(e){e&&(window.getSelection?(sel=window.getSelection(),sel.removeAllRanges(),sel.addRange(e)):document.selection&&e.select&&e.select())}var o=function(){return 600<=e(window).width()?!0:!1},i=function(){return o()?"up":"down"};e(document).on("click","#lasso-toolbar--components",function(t){e(this).toggleClass("toolbar--drop-"+i()),e("#lasso-toolbar--html").removeClass("html--drop-"+i()),e("#lasso-toolbar--link").removeClass("link--drop-"+i());var n=e(this).find("ul"),a=e(n).height(),s=15;1==o()&&e(n).css({dropUp:a,top:-(a+s)})}),e("#lasso-toolbar--html").live("mousedown",function(){if(!e(this).hasClass("html--drop-"+i())){var n=document.getElementById(lasso_editor.editor);window.selRange=t(),("undefined"==typeof window.selRange||null==window.selRange)&&(n.highlight(),window.selRange=t())}}),e("#lasso-toolbar--html__inner").live("focusout",function(){n(window.selRange)}),e("#lasso-toolbar--html__inner").live("focus",function(){0!=e(t().commonAncestorContainer).parents("#lasso--content").length&&(window.selRange=t())}),e(document).on("click","#lasso-toolbar--html",function(t){e(this).toggleClass("html--drop-"+i()),e("#lasso-toolbar--components").removeClass("toolbar--drop-"+i()),e("#lasso-toolbar--link").removeClass("link--drop-"+i()),e("#lasso-toolbar--html__wrap").live("click",function(){return!1}),e(this).find("#lasso-toolbar--html__inner").focus()}),e(".lasso-toolbar--html__cancel").live("click",function(){e(this).closest("li").removeClass("html--drop-"+i())});var a=function(t){return e("#lasso-toolbar--html__inner").text(t)};e("#lasso-html--h2").live("click",function(e){e.preventDefault(),a("<h2>H2 Heading</h2>")}),e("#lasso-html--h3").live("click",function(e){e.preventDefault(),a("<h3>H3 Heading</h3>")}),e("#lasso-html--ul").live("click",function(e){e.preventDefault(),a("<ul><li>Item</li></ul>")}),e("#lasso-html--ol").live("click",function(e){e.preventDefault(),a("<ol><li>Item</li></ol>")}),e("#lasso-toolbar--link").live("mousedown",function(){if(!e(this).hasClass("link--drop-up")){var n=document.getElementById(lasso_editor.editor);window.selRange=t(),("undefined"==typeof window.selRange||null==window.selRange)&&(n.highlight(),window.selRange=t())}}),e("#lasso-toolbar--link__inner").live("focusout",function(){n(window.selRange)}),e("#lasso-toolbar--link__inner").live("focus",function(){0!=e(t().commonAncestorContainer).parents("#lasso--content").length&&(window.selRange=t())}),e(document).on("click","#lasso-toolbar--link",function(t){e(this).toggleClass("link--drop-"+i()),e("#lasso-toolbar--components").removeClass("toolbar--drop-"+i()),e("#lasso-toolbar--html").removeClass("html--drop-"+i()),e("#lasso-toolbar--link__wrap").live("click",function(){return!1}),e(this).find("#lasso-toolbar--link__inner").focus()}),e(".lasso-editing .lasso-link").live("click",function(t){t.preventDefault(),e("#lasso-toolbar--link__wrap").live("click",function(){return!1});var n=e(this).attr("href");e("#lasso-toolbar--link").addClass("link--drop-"+i()),e("#lasso-toolbar--link__inner").text(n)}),e(".lasso-delete").live("click",function(t){t.preventDefault();var n=e(this);swal({title:"Delete this component?",type:"warning",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){n.closest(".aesop-component").remove(),n.closest(".lasso-component").remove()})}),e(".lasso-clone").live("click",function(t){var n=e(this);t.preventDefault(),n.closest(".aesop-component").clone().insertAfter(e(this).parent().parent()).hide().fadeIn(),n.closest(".lasso-component").clone().insertAfter(e(this).parent().parent()).hide().fadeIn()})}),jQuery(document).ready(function(e){var t=lasso_editor.ajaxurl,n=e(".lasso--controls__right a"),o=lasso_editor.editor,i=lasso_editor.postid,a=e("#"+o).html(),s="You have unsaved changes!";noWarningReload=!1,e("#"+o).live("change",function(){var t=e(this),n=t.html();a!==n&&localStorage.setItem("lasso_backup_"+i,n)}),window.onbeforeunload=function(){return localStorage.getItem("lasso_backup_"+i)&&lasso_editor.userCanEdit?s:void 0},e(".lasso--controls__right a:not(#lasso--exit)").live("click",function(i){function a(t,n){for(var o=e(t),i="",a=0;a<o.length;a++){var s=e(o[a]);if(s.hasClass("aesop-component")){var r=s.data(),l="";if(r.hasOwnProperty("componentType")){for(var c in r)r.hasOwnProperty(c)&&"componentType"!=c&&(l+=" "+c+'="'+r[c]+'"');var d="[aesop_"+r.componentType+l+"]",u=s.find(".aesop-component-content-data");0!=u.length&&(d+=u[0].innerHTML+"[/aesop_"+r.componentType+"]"),i+=d}}else i+=3==s.context.nodeType?o[a].data:8==s.context.nodeType?"<!--"+o[a].data+"-->":o[a].outerHTML}return i}function s(){e.post(t,d,function(t){1==t.success?(e(n).removeClass("being-saved").addClass("lasso--saved"),r.hasClass("lasso-publish-post")&&r.remove(),setTimeout(function(){e(n).removeClass("lasso--saved"),r.hasClass("lasso-publish-post")&&location.reload()},1200),localStorage.removeItem("lasso_backup_"+c)):e(n).removeClass("being-saved").addClass("lasso--error")})}i.preventDefault();var r=e(this);e(".lasso--wpimg__wrap").each(function(){e(this).hasClass("wp-caption")||e(this).children().unwrap(),e(".lasso-component--controls").remove()}),e(".lasso-component").each(function(){e(".lasso-component--controls").remove()}),e("#lasso--map-form").each(function(){var t=e(this);t.find(".lasso-component--controls, .lasso--map-form__footer ").remove(),t.children().unwrap()}),e(".scroll-nav__section").each(function(){e(this).children().unwrap()}),e("#lasso--notice").remove();var l=e("#"+o).html(),c=r.closest("#lasso--controls").data("post-id");e(this).addClass("being-saved");var d={action:r.hasClass("lasso-publish-post")?"process_save_publish-content":"process_save_content",author:lasso_editor.author,content:r.hasClass("shortcodify-enabled")?a(l):l,post_id:c,nonce:lasso_editor.nonce};r.hasClass("lasso-publish-post")?swal({title:lasso_editor.strings.publishPost,type:"info",text:!1,showCancelButton:!0,confirmButtonColor:"#5bc0de",confirmButtonText:lasso_editor.strings.publishYes,closeOnConfirm:!0},function(){s()}):s()})}),function(e){"use strict";function t(){var t=a.sortable("toArray");e("#ase_gallery_ids").val(t)}function n(n,o){var i="<li id='"+n+"' class='ase-gallery-image'><i class='dashicons dashicons-no-alt'></i><i title='Edit Image Caption' class='dashicons dashicons-edit'></i><img src='"+o+"'></li>";e("#ase-gallery-images").append(i),a.sortable("refresh"),t()}function o(n,o,i){var s="<li id='"+n+"' class='ase-gallery-image'><i class='dashicons dashicons-no-alt'></i><i title='Edit Image Caption' class='dashicons dashicons-edit'></i><img src='"+o+"'></li>";e(i).replaceWith(s),a.sortable("refresh"),t()}e("#lasso--gallery__create").live("click",function(t){t.preventDefault(),e(this).closest("form").addClass("creating-gallery"),e(".ase-gallery-opts--create-gallery").fadeIn(),e(".ase-gallery-opts--edit-gallery").fadeOut(1),e("#ase-gallery-images li").remove(),e(".ase-gallery-opts--edit-gallery").text(lasso_editor.strings.addNewGallery),e(".ase-gallery-opts--edit-gallery .lasso-option-desc").text("Select new images to create a gallery with.")});var i,a=e("#ase-gallery-images");e(document).on("click","#lasso--gallery__selectImages",function(t){return t.preventDefault(),i?void i.open():(i=wp.media.frames.file_frame=wp.media({title:lasso_editor.strings.chooseImages,button:{text:lasso_editor.strings.addImages},multiple:!0}),i.on("select",function(){var t=i.state().get("selection");if(t){t.each(function(e){var t=e.id,o=e.attributes.sizes.thumbnail.url;n(t,o)});var o=t.map(function(e){var e=e.toJSON();return e.id}).join(",");e("#ase_gallery_ids").val(o),e(".has-galleries > #lasso--gallery__save").fadeIn(),e("#lasso--gallery__selectImages").remove()}}),void i.open())}),e(".lasso-gallery-id #lasso-generator-attr-id").live("change",function(){var t={action:"process_gallery_swap",gallery_id:e(this).val(),nonce:lasso_editor.swapGallNonce};e.post(lasso_editor.ajaxurl,t,function(t){1==t.success&&e(".aesop-gallery-component").replaceWith(t.data.gallery)})}),e(document).on("click",".ase-gallery-image > i.dashicons-no-alt",function(){e(this).parent().remove(),a.sortable("refresh"),t()});var s=!1;e(document).on("click","#ase-gallery-add-image",function(t){t.preventDefault();if(s=e(this),wp.media.frames.ase_frame)return void wp.media.frames.ase_frame.open();wp.media.frames.ase_frame=wp.media({title:lasso_editor.strings.selectGallery,multiple:!0,library:{type:"image"},button:{text:lasso_editor.strings.useSelectedImages}});var o=function(){var e=wp.media.frames.ase_frame.state().get("selection");e&&e.each(function(e){var t=e.id,o=e.attributes.sizes.thumbnail.url;
n(t,o)})};wp.media.frames.ase_frame.on("select",o),wp.media.frames.ase_frame.open()});var r=function(){var t;e(document).on("click",".ase-gallery-image > i.dashicons-edit",function(n){n.preventDefault();if(t=e(this),wp.media.frames.ase_edit_frame)return void wp.media.frames.ase_edit_frame.open();wp.revisions,wp.media.frames.ase_edit_frame=wp.media({title:lasso_editor.strings.editImage,multiple:!1,library:{type:"image"},button:{text:lasso_editor.strings.updateSelectedImg}});var i=function(){var e=wp.media.frames.ase_edit_frame.state().get("selection");e&&e.each(function(e){var n=e.id,i=e.attributes.sizes.thumbnail.url;o(n,i,t.parent())})};wp.media.frames.ase_edit_frame.on("select",i),wp.media.frames.ase_edit_frame.on("open",function(){var e=wp.media.frames.ase_edit_frame.state().get("selection"),n=wp.media.attachment(t.parent().attr("id"));n.fetch(),e.add(n?[n]:[])}),wp.media.frames.ase_edit_frame.open()})};r(),t()}(jQuery),function(e){e(document).ready(function(e){var t=function(t){"grid"==t?(e(".ase-gallery-opts--thumb").fadeOut(),e(".ase-gallery-opts--photoset").fadeOut(),e(".ase-gallery-opts--grid").fadeIn()):e(".ase-gallery-opts--grid").fadeOut(),"thumbnail"==t?(e(".ase-gallery-opts--grid").fadeOut(),e(".ase-gallery-opts--photoset").fadeOut(),e(".ase-gallery-opts--thumb").fadeIn()):e(".ase-gallery-opts--thumb").fadeOut(),"photoset"==t?(e(".ase-gallery-opts--grid").fadeOut(),e(".ase-gallery-opts--thumb").fadeOut(),e(".ase-gallery-opts--photoset").fadeIn()):e(".ase-gallery-opts--photoset").fadeOut()};e(".ase-gallery-type-radio").each(function(){if(e(this).is(":checked")){e(this).parent().addClass("selected");var n=e(this).val();t(n)}}),e(".ase-gallery-layout-label").live("click",function(){e(".ase-gallery-layout-label").removeClass("selected"),e(this).addClass("selected");var n=e(this).find("input").val();t(n),e("#ase_gallery_type").val(n)})})}(jQuery),function(e){e("#lasso--map-form").live("submit",function(t){t.preventDefault();var n=e(this);e(this).find('input[type="submit"]').val("Saving...").addClass("being-saved");var o=n.serialize();e.post(lasso_editor.ajaxurl,o,function(e){1==e.success?(n.find('input[type="submit"]').val("Saved"),n.removeClass("being-saved").addClass("lasso--saved"),setTimeout(function(){n.find('input[type="submit"]').val("Save Locations").removeClass("lasso-saved")},1200)):n.removeClass("being-saved").addClass("lasso--error")})})}(jQuery),function(e){"use strict";e("#lasso--featImgSave a").live("click",function(t){t.preventDefault();var n=e(this),o=e("#lasso--save-status"),i={action:"process_upload-image_upload",postid:lasso_editor.postid,image_id:n.data("featimg-id"),nonce:lasso_editor.featImgNonce};o.removeClass("not-visible").addClass("visible lasso--animate__spin"),e.post(lasso_editor.ajaxurl,i,function(t){t&&(console.log("response"),e("#lasso--featImgSave").css("opacity",0),o.removeClass("lasso--animate__spin lasso-icon-spinner6").addClass("lasso-icon-check"),setTimeout(function(){o.removeClass("lasso--animate__spin lasso-icon-check").addClass("lasso-icon-spinner6 not-visible")},500))})});var t,n;e(document).on("click","#lasso--featImgUpload > a",function(o){o.preventDefault(),n=o.currentTarget.parentElement.className;var i=e("#lasso--featImgSave a");return t?void t.open():(t=wp.media.frames.file_frame=wp.media({title:lasso_editor.strings.chooseImage,button:{text:lasso_editor.strings.updateImage},multiple:!1}),t.on("select",function(){var n=t.state().get("selection").first().toJSON();e("body").addClass("lasso--post-thumb-applied"),e("article").removeClass("no-post-thumbnail").addClass("has-post-thumbnail"),e(lasso_editor.featImgClass).css({"background-image":"url("+n.url+")"}),i.attr("data-featimg-id",n.id).trigger("click"),e(".no-post-cover-note").remove()}),void t.open())}),e(document).on("click","#lasso--featImgDelete > a",function(t){t.preventDefault();var n=e(this),o={action:"process_upload-image_delete",postid:lasso_editor.postid,nonce:lasso_editor.featImgNonce};swal({title:lasso_editor.strings.removeFeatImg,type:"warning",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:lasso_editor.strings.deleteYes,closeOnConfirm:!0},function(){e.post(lasso_editor.ajaxurl,o,function(t){1==t.success&&(e("body").addClass("lasso--post-thumb-removed"),e("article").removeClass("has-post-thumbnail").addClass("no-post-thumbnail"),e("#lasso--featImgDelete").addClass("lasso--featImg--controlHidden"),n.closest("ul").removeClass("lasso--featImg--has-thumb"),e(lasso_editor.featImgClass).css({"background-image":"url()"}))})})});var o;e(document).on("click","#lasso--post-thumb__add",function(t){t.preventDefault();var n=e(this),i=e("#lasso--featImgSave a");return o?void o.open():(o=wp.media.frames.featimg_frame=wp.media({title:lasso_editor.strings.chooseImage,button:{text:lasso_editor.strings.updateImage},multiple:!1}),o.on("select",function(){var t=o.state().get("selection").first().toJSON(),a=n.closest(".lasso--post-thumb").find("img");a.attr("src",t.url),i.attr("data-featimg-id",t.id).trigger("click"),e("#lasso--postsettings__form").removeClass("no-thumbnail").addClass("has-thumbnail"),a.removeAttr("srcset"),noWarningReload=!0}),void o.open())}).on("click","#lasso--post-thumb__delete",function(t){t.preventDefault();var n=e(this),o={action:"process_upload-image_delete",postid:lasso_editor.postid,nonce:lasso_editor.featImgNonce};swal({title:lasso_editor.strings.removeFeatImg,type:"warning",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:lasso_editor.strings.deleteYes,closeOnConfirm:!0},function(){e.post(lasso_editor.ajaxurl,o,function(t){if(1==t.success){var o=n.closest(".lasso--post-thumb").data("default-thumb");n.closest(".lasso--postsettings__left").find("img").attr("src",o),n.closest(".lasso--postsettings__left").find("img").removeAttr("srcset"),e("#lasso--postsettings__form").removeClass("has-thumbnail").addClass("no-thumbnail"),noWarningReload=!0}})})})}(jQuery),function(e){e("#lasso--component-settings-form").live("submit",function(t){t.preventDefault();var n=window.component,o=n.data(),i=e("#lasso-generator-insert"),a=e("#lasso--component-settings-form"),s=e(this);i.val(lasso_editor.strings.saving),s.find(".lasso-generator-attr").each(function(){var t=e(this).closest(".lasso-option").data("option");""!==e(this).val()&&(n.attr("data-"+t,e(this).val()),n.data(t,e(this).val()))});var r=function(e){return delete e.sortableItem,e},l=function(t,n,o){var s=function(e){i.addClass("saved"),1==e?i.val(lasso_editor.strings.galleryCreated):i.val(lasso_editor.strings.saved)};1==t?setTimeout(function(){s()},500):1==o?(a.addClass("hide-all-fields").prepend('<div id="lasso--pagerefresh">Gallery Created! Save your post and refresh the page to access this new gallery.</div>'),setTimeout(function(){s(!0)},500)):s(),setTimeout(function(){e("body").removeClass("lasso-sidebar-open")},n)};if("gallery"==o.componentType){var c={action:a.hasClass("creating-gallery")?"process_gallery_create":"process_gallery_update",postid:o.id,unique:o.unique,fields:r(o),gallery_type:e("#ase_gallery_type").val(),gallery_ids:e("#ase_gallery_ids").val(),nonce:e("#lasso-generator-nonce").val()};e.post(lasso_editor.ajaxurl,c,function(e){"gallery-created"==e.data.message?l(!1,3e3,!0):"gallery-updated"==e.data.message?(l(!1,3e3),a.before(lasso_editor.refreshRequired)):alert("error")})}else l(!0,1200)})}(jQuery),function(e){e(document).ready(function(){var t=function(){e("body").removeClass("lasso-modal-open"),e(".lasso--modal, #lasso--modal__overlay").remove(),noWarningReload&&location.reload()};e("#lasso--post-new").live("click",function(t){t.preventDefault(),e("body").toggleClass("lasso-modal-open"),e("body").append(lasso_editor.newPostModal),e(".lasso--modal__trigger-footer").on("keyup",function(){e(".lasso--postsettings__footer").slideDown()}),modalResizer()}),e("#lasso--modal__close, #lasso--modal__overlay, .lasso--postsettings-cancel").live("click",function(e){e.preventDefault(),t()}),e(document).keyup(function(e){27==e.keyCode&&t()});e("#lasso--postnew__form").live("submit",function(t){t.preventDefault();var n=e(this);e(this).find('input[type="submit"]').val(lasso_editor.strings.adding);var o=n.serialize();e.post(lasso_editor.ajaxurl,o,function(t){1==t.success?(e('input[type="submit"]').addClass("saved"),e('input[type="submit"]').val(lasso_editor.strings.added),window.location.replace(t.data.postlink)):alert("error")})})}),e("#lasso--select-type").live("change",function(){var t=e(this).val();e('input[name="object"]').val(t),e(this).closest(".story-slug-option").find("label span:not(.lasso-util--help)").text(t)})}(jQuery),function(e){e(document).ready(function(){e(lasso_editor.titleClass).on("blur",function(){var t=e(this),n={action:"process_title-update_post",postid:lasso_editor.postid,title:e.trim(t.text()),nonce:lasso_editor.titleNonce};e.post(lasso_editor.ajaxurl,n,function(e){if(1==e.success){var n="lasso-title-saved";t.addClass(n),setTimeout(function(){t.removeClass(n)},500)}})})})}(jQuery),function(e){e(document).ready(function(){var t,n;e(document).on("click","#lasso--wpimg-edit",function(o){o.preventDefault();var i=e(this),a=e(this).parent().next("img").attr("class").match(/\d+/);n=o.currentTarget.parentElement.className,t=wp.media.frames.ase_edit_frame=wp.media({title:lasso_editor.strings.selectImage,button:{text:lasso_editor.strings.insertImage},multiple:!1}),t.on("open",function(){var e=t.state().get("selection"),n=wp.media.attachment(a);n.fetch(),e.add(n?[n]:[])}),t.on("select",function(){var n=t.state().get("selection").first().toJSON(),o=void 0===n.sizes.large?n.sizes.full.url:n.sizes.large.url;e(i).parent().next("img").attr({src:o,alt:n.alt,"class":"aligncenter size-large wp-image-"+n.id})}),t.open()})})}(jQuery),function(e){e(document).on("submit","#lasso--post-form",function(t){t.preventDefault();var n=e(this),o=n.find('input[type="submit"]'),i=lasso_editor.strings,a=n.serialize();o.val(i.saving),e.post(lasso_editor.ajaxurl,a,function(e){1==e.success&&(o.val(i.saved).addClass("saved"),console.log(e),setTimeout(function(){o.removeClass("saved"),o.val(i.save)},1e3))})})}(jQuery),function(e){jQuery(document).ready(function(e){modalResizer=function(){var t=e(".lasso--modal"),n=t.height(),o=e(window).height(),i=e(".lasso--modal").hasClass("lasso--tour__modal")?0:30;t.css({top:(o-n-i)/2})},e(".lasso--modal").imagesLoaded(function(){modalResizer()}),jQuery(window).resize(function(){modalResizer()})})}(jQuery),function(e,t,n,o,i){function a(){e("#lasso--loading").remove()}function s(){e(m).perfectScrollbar({suppressScrollX:!0})}function r(t){"page"==t?(capable=lasso_editor.edit_others_pages,L=capable?l(t,x):l(t,x,lasso_editor.author),k=new wp.api.collections.Pages(L)):(capable=lasso_editor.edit_others_posts,L=capable?l(t,x):l(t,x,lasso_editor.author),k=new wp.api.collections.Posts(L)),k.fetch(L).done(function(){if(e("#lasso--load-more").remove(),k.length>0){var n=k.state.currentPage;n-=1;var i=e('<div data-page-num="'+k.state.currentPage+'" class="lasso--object-batch" id="lasso--object-batch-'+n+'"></div>');k.each(function(e){i.append(p({post:e.attributes,settings:o}))}),e(m).append(i),e(m).append(E),e(".lasso--post-filtering").removeClass("not-visible").addClass("visible"),e("#lasso--load-more").attr("data-post-type",t).removeClass("lasso--btn-loading"),s()}else e(m).append(C),setTimeout(function(){e("#lasso--end-posts").fadeOut("slow")},1e3);a()})}function l(e,t,n){return L={data:{page:t,type:e,filter:{post_status:["publish","draft","pending"],posts_per_page:7,author:n}}}}function c(){e(T).remove()}function d(t){e(m).children().remove(),r(t),e("#lasso--search-field").val("").focusout(),e("#lasso--results-found").parent().css("opacity",0),e(N).remove(),c()}var u,f=e("#lasso-tmpl--post"),p=n.template(f.html()),h=(new wp.api.collections.Posts,new wp.api.collections.Pages,e("#lasso--post-all")),m="#lasso--post-list",g=lasso_editor.strings.loading,v=lasso_editor.strings.loadMore,y=lasso_editor.strings.noPostsFound,b=e("body"),C='<li id="lasso--end-posts">'+y+"</li>",w=lasso_editor.noResultsDiv,_='<div id="lasso--loading" class="lasso--loading"><div class="lasso--loader"></div></div>',E='<a href="#" id="lasso--load-more">'+v+"</a>",R='<i id="lasso--clear-search" class="dashicons dashicons-dismiss"></i>',T="#lasso--clear-search",N="#lasso--helper",x=1,S="post",k=!1,O=null,A=o.root,L={data:{page:x,filter:{post_status:["publish","draft","pending"]}}};e(h).on("click",function(e){e.preventDefault(),b.toggleClass("lasso-modal-open"),b.append(lasso_editor.allPostModal),r("post"),modalResizer()}),e(b).on("click","#lasso--load-more",function(t){t.preventDefault(),type=e(this).attr("data-post-type"),e(this).addClass("lasso--btn-loading").text(g),x++,S=type,r(type)}).on("click",".lasso--show-objects",function(t){t.preventDefault(),e(".lasso--show-objects").removeClass("active"),e(this).addClass("active"),e("#lasso--post-list").empty(),type=e(this).data("post-type"),x=1,O=null,e("#lasso--load-more").attr("data-post-type",type),e(m).prepend(_),r(type)}).on("click","#lasso--post__delete",function(t){t.preventDefault();var n=e(this);swal({title:lasso_editor.strings.deletePost,type:"error",text:!1,showCancelButton:!0,confirmButtonColor:"#d9534f",confirmButtonText:lasso_editor.strings.deleteYes,closeOnConfirm:!0},function(){var t={action:"process_delete_post",postid:n.closest("a").data("postid"),nonce:lasso_editor.deletePost};e.post(lasso_editor.ajaxurl,t,function(e){1==e.success&&n.closest("li").fadeOut().remove()})})}).on("keyup","#lasso--search-field",function(t){clearTimeout(u);var n=t.which,i=this,a=e.trim(e(this).val()),r=a==e(i).val(),l=""!==a,d=e(".active.lasso--show-objects").data("post-type"),f=A+"/"+d+"s?filter[s]="+a+"&filter[posts_per_page]=50",h="#lasso--search-field",g=e("#lasso--results-found"),v=lasso_editor.strings.helperText,y='<span id="lasso--helper">'+v+"</span>";u=setTimeout(function(){return r||l?(2!=a.length||e(N).length||(c(),e(h).after(y)),void((a.length>=3||a.length>=3&&13==n)&&(e(m).prepend(_),e(N).fadeOut().remove(),c(),e.getJSON(f,function(t){e(m).children().remove(),g.parent().css("opacity",1),0==t.length?(g.text("0"),e("#lasso--empty-results").length||e(m).prepend(w),c()):(e(T).length||e(h).after(R),g.text(t.length),e.each(t,function(n){e(m).append(p({post:t[n],settings:o}))}),s())})))):!1},600)}).on("click","#lasso--search__toggle",function(t){t.preventDefault();var n=e("#lasso--search-field");e(".lasso--search").toggleClass("lasso--search__visible"),n.focus(),e(this).parent().hasClass("lasso--search__visible")||""===n.val()||d("post")}).on("click",T,function(e){e.preventDefault(),d("post")})}(jQuery,Backbone,_,WP_API_Settings),function(e){e(document).ready(function(){destroyModal=function(){e("body").removeClass("lasso-modal-open"),e("#lasso--tour__modal,#lasso--tour__modal ~ #lasso--modal__overlay").remove()},e('#lasso--tour__modal input[type="submit"]').live("click",function(t){t.preventDefault();e(this);if(e("#hide_tour").is(":checked")){var n={action:"process_tour_hide",nonce:e(this).data("nonce")};e.post(lasso_editor.ajaxurl,n,function(e){1==e.success&&destroyModal()})}else destroyModal()})})}(jQuery),function(e){e(document).ready(function(){function t(){e("#lasso--loading").remove()}function n(){e("body").data("revision")&&slider.slider("value",e("body").data("revision"))}function o(){e("#lasso--notice").length||e(s.article_object).before('<div id="lasso--notice" class="lasso--notice lasso--notice-warning">'+s.strings.editingBackup+"</div>")}function i(){e("body").removeClass(function(e,t){return(t.match(/(^|\s)lasso--revision-count-\S+/g)||[]).join(" ")})}var a,s=lasso_editor;revisionList=e("#lasso--revision-list");var r=function(){e("body").removeClass("lasso-modal-open"),e("#lasso--revision__modal").remove(),e("#lasso--post-revisions").show()},l=function(t){t in a&&(revision=a[t],e(s.titleClass).html(revision.post_title),e(s.article_object).html(revision.post_content),e("body").attr("data-revision",t))};e("#lasso--post-revisions").on("click",function(o){o.preventDefault(),e(this).hide(),e("body").append(s.revisionModal),innerModal=e("#lasso--revision__modal .lasso--modal__inner"),innerModal.draggable({cursor:"move",opacity:.8}),data={action:"process_revision_get",postid:s.postid,nonce:s.nonce},e.post(s.ajaxurl,data,function(o){if(1==o.success)if(revisionList=e("#lasso--revision-list"),slider=e("#lasso--slider"),lassoHide=e("#lasso--hide"),i(),t(),lassoHide.show(),"object"==typeof o.data&&o.data.length){a=o.data;var r=1==a.length?1:a.length-1;1!==a.length?(e.each(a,function(e,t){revisionList.append('<li class="lasso--jump-revision" data-revision="'+e+'"><span class="lasso-util--help lasso-util--help-top" data-tooltip="'+t.modified_date+'">'+t.modified_time+"</span></li>")}),slider.slider({min:0,max:r,animate:"fast",value:0,zindex:999,slide:function(e,t){l(t.value)}}),e(".lasso--jump-revision").on("click",function(t){t.preventDefault();var n=e(this).data("revision");slider.slider("value",n),l(n)}),revisionList.attr("data-count",r+1)):(lassoHide.hide(),innerModal.append(s.noRevisionsDiv)),e("body").addClass("lasso--revision-count-"+a.length),n(),modalResizer()}else e("#lasso--hide").hide(),innerModal.append(s.noRevisionsDiv),modalResizer();else alert("error")}),modalResizer()}),e(document).on("click","#lasso--select-revision",function(t){t.preventDefault(),r(),e("#lasso--edit").trigger("click"),o()}).on("click","#lasso--close-modal",function(e){e.preventDefault(),r()}),e(document).keyup(function(e){27==e.keyCode&&r()})})}(jQuery);
//# sourceMappingURL=lasso.js.map